(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{1093:function(e,a,t){e.exports=t.p+"assets/img/ui-dashboard.b03d0b28.png"},1094:function(e,a,t){e.exports=t.p+"assets/img/2021-04-21-16-51-23.969dd7ab.png"},1095:function(e,a,t){e.exports=t.p+"assets/img/ui-dashboard-zerostate.f86f1dfc.png"},1096:function(e,a,t){e.exports=t.p+"assets/img/signin.7fa3a8e0.png"},1097:function(e,a,t){e.exports=t.p+"assets/img/overview.0bfd156b.png"},1294:function(e,a,t){"use strict";t.r(a);var s=t(19),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"web界面dashboard"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web界面dashboard"}},[e._v("#")]),e._v(" Web界面Dashboard")]),e._v(" "),s("p",[e._v("Dashboard 是基于网页的 Kubernetes 用户界面。 你可以使用 Dashboard 将容器应用部署到 Kubernetes 集群中，也可以对容器应用排错，还能管理集群资源。 你可以使用 Dashboard 获取运行在集群中的应用的概览信息，也可以创建或者修改 Kubernetes 资源 （如 Deployment，Job，DaemonSet 等等）。 例如，你可以对 Deployment 实现弹性伸缩、发起滚动升级、重启 Pod 或者使用向导创建新的应用。")]),e._v(" "),s("p",[e._v("Dashboard 同时展示了 Kubernetes 集群中的资源状态信息和所有报错信息。")]),e._v(" "),s("p",[s("img",{attrs:{src:t(1093),alt:"Kubernetes Dashboard UI"}})]),e._v(" "),s("p",[s("img",{attrs:{src:t(1094),alt:""}})]),e._v(" "),s("h2",{attrs:{id:"部署-dashboard-ui"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署-dashboard-ui"}},[e._v("#")]),e._v(" 部署 Dashboard UI")]),e._v(" "),s("p",[e._v("默认情况下不会部署 Dashboard。可以通过以下命令部署：")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("\nkubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.2.0/aio/deploy/recommended.yaml\n")])])]),s("h2",{attrs:{id:"访问-dashboard-ui"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#访问-dashboard-ui"}},[e._v("#")]),e._v(" 访问 Dashboard UI")]),e._v(" "),s("p",[e._v("为了保护你的集群数据，默认情况下，Dashboard 会使用最少的 RBAC 配置进行部署。 当前，Dashboard 仅支持使用 Bearer 令牌登录。 要为此样本演示创建令牌，你可以按照 "),s("a",{attrs:{href:"https://github.com/kubernetes/dashboard/wiki/Creating-sample-user",target:"_blank",rel:"noopener noreferrer"}},[e._v("创建示例用户"),s("OutboundLink")],1),e._v(" 上的指南进行操作。")]),e._v(" "),s("blockquote",[s("p",[s("strong",[e._v("警告：")]),e._v(" 在教程中创建的样本用户将具有管理特权，并且仅用于教育目的。")])]),e._v(" "),s("h3",{attrs:{id:"命令行代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#命令行代理"}},[e._v("#")]),e._v(" 命令行代理")]),e._v(" "),s("p",[e._v("你可以使用 kubectl 命令行工具访问 Dashboard，命令如下：")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("\nkubectl proxy\n")])])]),s("p",[e._v("kubectl 会使得 Dashboard 可以通过 http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/ 访问。")]),e._v(" "),s("p",[e._v("UI "),s("em",[e._v("只能")]),e._v(" 通过执行这条命令的机器进行访问。更多选项参见 "),s("code",[e._v("kubectl proxy --help")]),e._v(" 。")]),e._v(" "),s("blockquote",[s("p",[s("strong",[e._v("说明：")]),e._v(" Kubeconfig 身份验证方法不支持外部身份提供程序或基于 x509 证书的身份验证。")])]),e._v(" "),s("h2",{attrs:{id:"欢迎界面"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#欢迎界面"}},[e._v("#")]),e._v(" 欢迎界面")]),e._v(" "),s("p",[e._v("当访问空集群的 Dashboard 时，你会看到欢迎界面。 页面包含一个指向此文档的链接，以及一个用于部署第一个应用程序的按钮。 此外，你可以看到在默认情况下有哪些默认系统应用运行在 "),s("code",[e._v("kube-system")]),e._v(" "),s("a",{attrs:{href:"https://kubernetes.io/zh/docs/tasks/administer-cluster/namespaces/",target:"_blank",rel:"noopener noreferrer"}},[e._v("名字空间"),s("OutboundLink")],1),e._v(" 中，比如 Dashboard 自己。")]),e._v(" "),s("p",[s("img",{attrs:{src:t(1095),alt:"Kubernetes Dashboard 欢迎页面"}})]),e._v(" "),s("h2",{attrs:{id:"创建用户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建用户"}},[e._v("#")]),e._v(" 创建用户")]),e._v(" "),s("p",[e._v("在本指南中，我们将找到如何使用Kubernetes的服务帐户机制创建新用户，授予该用户admin权限以及使用与该用户绑定的承载令牌登录到Dashboard的方法。")]),e._v(" "),s("p",[e._v("**重要信息：**在继续操作之前，请确保您知道自己在做什么。向仪表板的服务帐户授予管理员特权可能会带来安全风险。")]),e._v(" "),s("p",[e._v("对于每个以下片断 "),s("code",[e._v("ServiceAccount")]),e._v(" 和 "),s("code",[e._v("ClusterRoleBinding")]),e._v(" ，你应该将它们复制到像新的清单文件 "),s("code",[e._v("dashboard-adminuser.yaml")]),e._v(" ，并使用 "),s("code",[e._v("kubectl apply -f dashboard-adminuser.yaml")]),e._v(" 创建它们。")]),e._v(" "),s("h2",{attrs:{id:"创建服务帐户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建服务帐户"}},[e._v("#")]),e._v(" 创建服务帐户")]),e._v(" "),s("p",[e._v("我们首先要 "),s("code",[e._v("admin-user")]),e._v(" 在名称空间中创建名称为Service Account的服务 "),s("code",[e._v("kubernetes-dashboard")]),e._v(" 。")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("\ncat <<EOF | kubectl apply -f -\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: admin-user\n  namespace: kubernetes-dashboard\nEOF\n")])])]),s("h2",{attrs:{id:"创建一个clusterrolebinding"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建一个clusterrolebinding"}},[e._v("#")]),e._v(" 创建一个ClusterRoleBinding")]),e._v(" "),s("p",[e._v("在供应使用集束后大多数情况下 "),s("code",[e._v("kops")]),e._v(" ， "),s("code",[e._v("kubeadm")]),e._v(" 或任何其他流行的工具，在 "),s("code",[e._v("ClusterRole")]),e._v(" "),s("code",[e._v("cluster-admin")]),e._v(" 已经存在的群集。我们可以使用它并仅为 "),s("code",[e._v("ClusterRoleBinding")]),e._v(" 我们创建 "),s("code",[e._v("ServiceAccount")]),e._v(" 。如果不存在，则需要首先创建此角色并手动授予所需的特权。")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("\ncat <<EOF | kubectl apply -f -\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: admin-user\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n\n* kind: ServiceAccount\n\n  name: admin-user\n  namespace: kubernetes-dashboard\nEOF\n")])])]),s("h2",{attrs:{id:"获取承载令牌"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取承载令牌"}},[e._v("#")]),e._v(" 获取承载令牌")]),e._v(" "),s("p",[e._v("现在我们需要找到可用于登录的令牌。执行以下命令：")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('\nkubectl -n kubernetes-dashboard get secret $(kubectl -n kubernetes-dashboard get sa/admin-user -o jsonpath="{.secrets[0].name}") -o go-template="{{.data.token | base64decode}}"\n\n')])])]),s("p",[e._v("它应该打印如下内容：")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("\neyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLXY1N253Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIwMzAzMjQzYy00MDQwLTRhNTgtOGE0Ny04NDllZTliYTc5YzEiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZXJuZXRlcy1kYXNoYm9hcmQ6YWRtaW4tdXNlciJ9.Z2JrQlitASVwWbc-s6deLRFVk5DWD3P_vjUFXsqVSY10pbjFLG4njoZwh8p3tLxnX_VBsr7_6bwxhWSYChp9hwxznemD5x5HLtjb16kI9Z7yFWLtohzkTwuFbqmQaMoget_nYcQBUC5fDmBHRfFvNKePh_vSSb2h_aYXa8GV5AcfPQpY7r461itme1EXHQJqv-SN-zUnguDguCTjD80pFZ_CmnSE1z9QdMHPB8hoB4V68gtswR1VLa6mSYdgPwCHauuOobojALSaMc3RH7MmFUumAgguhqAkX3Omqd3rJbYOMRuMjhANqd08piDC3aIabINX6gP5-Tuuw2svnV6NYQ\n")])])]),s("p",[e._v("现在，复制令牌并将其粘贴到 "),s("code",[e._v("Enter token")]),e._v(" 登录屏幕上的字段中。")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/kubernetes/dashboard/blob/master/docs/images/signin.png",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:t(1096),alt:"登录"}}),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("单击 "),s("code",[e._v("Sign in")]),e._v(" 按钮，仅此而已。您现在已以管理员身份登录。")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/kubernetes/dashboard/blob/master/docs/images/overview.png",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:t(1097),alt:"概述"}}),s("OutboundLink")],1)]),e._v(" "),s("h2",{attrs:{id:"清理和下一步"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#清理和下一步"}},[e._v("#")]),e._v(" 清理和下一步")]),e._v(" "),s("p",[e._v("删除管理员 "),s("code",[e._v("ServiceAccount")]),e._v(" 和 "),s("code",[e._v("ClusterRoleBinding")]),e._v(" 。")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("\nkubectl -n kubernetes-dashboard delete serviceaccount admin-user\nkubectl -n kubernetes-dashboard delete clusterrolebinding admin-user\n")])])]),s("h3",{attrs:{id:"更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新"}},[e._v("#")]),e._v(" 更新")]),e._v(" "),s("p",[e._v("安装后，部署不会自动更新。为了对其进行更新，您需要删除部署的Pod，并等待其重新创建。重新娱乐后，它应该使用最新的图像。")]),e._v(" "),s("p",[e._v("删除所有Dashboard Pod（假设Dashboard已部署在kubernetes-dashboard命名空间中）：")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("\nkubectl -n kubernetes-dashboard delete $(kubectl -n kubernetes-dashboard get pod -o name | grep dashboard)\n")])])]),s("p",[e._v("输出类似于以下内容：")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('\npod "dashboard-metrics-scraper-fb986f88d-gnfnk" deleted\npod "kubernetes-dashboard-7d8b9cc8d-npljm" deleted\n')])])])])}),[],!1,null,null,null);a.default=r.exports}}]);