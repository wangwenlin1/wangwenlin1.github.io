(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{1030:function(t,a,s){t.exports=s.p+"assets/img/2021-04-22-19-05-16.cbfade2f.png"},1031:function(t,a,s){t.exports=s.p+"assets/img/2021-04-22-19-09-35.4c463dc8.png"},1032:function(t,a,s){t.exports=s.p+"assets/img/2021-04-22-19-09-48.fc5cc3d4.png"},1272:function(t,a,s){"use strict";s.r(a);var n=s(19),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"核心技术-pvc-和-pv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#核心技术-pvc-和-pv"}},[t._v("#")]),t._v(" 核心技术-PVC 和 PV")]),t._v(" "),n("h2",{attrs:{id:"基本概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基本概念"}},[t._v("#")]),t._v(" 基本概念")]),t._v(" "),n("p",[t._v("管理存储是管理计算的一个明显问题。该 PersistentVolume 子系统为用户和管理员提供了一个 API，用于抽象如何根据消费方式提供存储的详细信息。为此，我们引入了两个新的API 资源：PersistentVolume 和 PersistentVolumeClaim")]),t._v(" "),n("p",[t._v("PersistentVolume（PV）是集群中由管理员配置的一段网络存储。 它是集群中的资源，就像节点是集群资源一样。 PV 是容量插件，如 Volumes，但其生命周期独立于使用 PV 的任何单个 pod。 此 API 对象捕获存储实现的详细信息，包括 NFS，iSCSI 或特定于云提供程序的存储系统。")]),t._v(" "),n("p",[t._v("PersistentVolumeClaim（PVC）是由用户进行存储的请求。 它类似于 pod。 Pod 消耗节点资源，PVC 消耗 PV 资源。Pod 可以请求特定级别的资源（CPU 和内存）。声明可以请求特定的大小和访问模式（例如，可以一次读/写或多次只读）。虽然 PersistentVolumeClaims 允许用户使用抽象存储资源，但是 PersistentVolumes 对于不同的问题，用户通常需要具有不同属性（例如性能）。群集管理员需要能够提供各种PersistentVolumes 不同的方式，而不仅仅是大小和访问模式，而不会让用户了解这些卷的实现方式。对于这些需求，有 StorageClass 资源。")]),t._v(" "),n("p",[t._v("StorageClass 为管理员提供了一种描述他们提供的存储的“类”的方法。 不同的类可能映射到服务质量级别，或备份策略，或者由群集管理员确定的任意策略。 Kubernetes 本身对于什么类别代表是不言而喻的。 这个概念有时在其他存储系统中称为“配置文件”。")]),t._v(" "),n("p",[t._v("PVC 和 PV 是一一对应的。")]),t._v(" "),n("h2",{attrs:{id:"生命周期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生命周期"}},[t._v("#")]),t._v(" 生命周期")]),t._v(" "),n("p",[t._v("PV 是群集中的资源。PVC 是对这些资源的请求，并且还充当对资源的检查。PV 和 PVC 之间的相互作用遵循以下生命周期：")]),t._v(" "),n("p",[t._v("Provisioning ——-> Binding ——–>Using——>Releasing——>Recycling")]),t._v(" "),n("p",[t._v("供应准备 Provisioning---通过集群外的存储系统或者云平台来提供存储持久化支持。")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("静态提供 Static：集群管理员创建多个 PV。 它们携带可供集群用户使用的真实存储的详细信息。 它们存在于 Kubernetes API 中，可用于消费")])]),t._v(" "),n("li",[n("p",[t._v("动态提供 Dynamic：当管理员创建的静态 PV 都不匹配用户的 PersistentVolumeClaim时，集群可能会尝试为 PVC 动态配置卷。 此配置基于 StorageClasses：PVC 必须请求一个类，并且管理员必须已创建并配置该类才能进行动态配置。 要求该类的声明有效地为自己禁用动态配置。")])])]),t._v(" "),n("p",[t._v("绑定 Binding---用户创建 pvc 并指定需要的资源和访问模式。在找到可用 pv 之前，pvc会保持未绑定状态。")]),t._v(" "),n("p",[t._v("使用 Using---用户可在 pod 中像 volume 一样使用 pvc。")]),t._v(" "),n("p",[t._v("释放 Releasing---用户删除 pvc 来回收存储资源，pv 将变成“released”状态。由于还保留着之前的数据，这些数据需要根据不同的策略来处理，否则这些存储资源无法被其他pvc 使用。")]),t._v(" "),n("p",[t._v("回收 Recycling---pv 可以设置三种回收策略：保留（Retain），回收（Recycle）和删除（Delete）。")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("保留策略：允许人工处理保留的数据。")])]),t._v(" "),n("li",[n("p",[t._v("删除策略：将删除 pv 和外部关联的存储资源，需要插件支持。")])]),t._v(" "),n("li",[n("p",[t._v("回收策略：将执行清除操作，之后可以被新的 pvc 使用，需要插件支持")])])]),t._v(" "),n("h2",{attrs:{id:"pv-类型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pv-类型"}},[t._v("#")]),t._v(" PV 类型")]),t._v(" "),n("p",[t._v("GCEPersistentDisk")]),t._v(" "),n("p",[t._v("AWSElasticBlockStore")]),t._v(" "),n("p",[t._v("AzureFile")]),t._v(" "),n("p",[t._v("AzureDisk")]),t._v(" "),n("p",[t._v("FC (Fibre Channel)")]),t._v(" "),n("p",[t._v("Flexvolume")]),t._v(" "),n("p",[t._v("Flocker")]),t._v(" "),n("p",[t._v("NFS")]),t._v(" "),n("p",[t._v("iSCSI")]),t._v(" "),n("p",[t._v("RBD (Ceph Block Device)")]),t._v(" "),n("p",[t._v("CephFS")]),t._v(" "),n("p",[t._v("Cinder (OpenStack block storage)")]),t._v(" "),n("p",[t._v("Glusterfs")]),t._v(" "),n("p",[t._v("VsphereVolume")]),t._v(" "),n("p",[t._v("Quobyte Volumes")]),t._v(" "),n("p",[t._v("HostPath (Single node testing only – local storage is not supported in any")]),t._v(" "),n("p",[t._v("way and WILL NOT WORK in a multi-node cluster)")]),t._v(" "),n("p",[t._v("Portworx Volumes")]),t._v(" "),n("p",[t._v("ScaleIO Volumes")]),t._v(" "),n("p",[t._v("StorageOS")]),t._v(" "),n("h2",{attrs:{id:"pv-卷阶段状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pv-卷阶段状态"}},[t._v("#")]),t._v(" PV 卷阶段状态")]),t._v(" "),n("p",[t._v("Available – 资源尚未被 claim 使用")]),t._v(" "),n("p",[t._v("Bound – 卷已经被绑定到 claim 了")]),t._v(" "),n("p",[t._v("Released – claim 被删除，卷处于释放状态，但未被集群回收。")]),t._v(" "),n("p",[t._v("Failed – 卷自动回收失败")]),t._v(" "),n("h2",{attrs:{id:"演示-创建-pv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#演示-创建-pv"}},[t._v("#")]),t._v(" 演示：创建 PV")]),t._v(" "),n("h3",{attrs:{id:"第一步-编写-yaml-文件-并创建-pv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第一步-编写-yaml-文件-并创建-pv"}},[t._v("#")]),t._v(" 第一步：编写 yaml 文件，并创建 pv")]),t._v(" "),n("p",[t._v("创建 5 个 pv，存储大小各不相同，是否可读也不相同")]),t._v(" "),n("div",{staticClass:"language-yaml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[t._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PersistentVolume\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pv001\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pv001\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nfs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /data/volumes/v1\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nfs\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("accessModes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadWriteMany"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadWriteOnce"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("capacity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 2Gi\n\n\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PersistentVolume\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pv002\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pv002\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nfs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /data/volumes/v2\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nfs\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("accessModes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadWriteOnce"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("capacity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 5Gi\n\n\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PersistentVolume\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pv003\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pv003\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nfs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /data/volumes/v3\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nfs\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("accessModes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadWriteMany"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadWriteOnce"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("capacity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 20Gi\n\n\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PersistentVolume\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pv004\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pv004\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nfs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /data/volumes/v4\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nfs\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("accessModes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadWriteMany"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadWriteOnce"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("capacity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 10Gi\n\n\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PersistentVolume\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pv005\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("labels")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pv005\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nfs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /data/volumes/v5\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nfs\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("accessModes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadWriteMany"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadWriteOnce"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("capacity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 15Gi\n\n")])])]),n("h3",{attrs:{id:"第二步-执行创建命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第二步-执行创建命令"}},[t._v("#")]),t._v(" 第二步：执行创建命令")]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("kubectl apply -f pv-damo.yaml\n")])])]),n("h3",{attrs:{id:"第三步-查询验证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第三步-查询验证"}},[t._v("#")]),t._v(" 第三步：查询验证")]),t._v(" "),n("h2",{attrs:{id:"演示-创建-pvc-绑定-pv"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#演示-创建-pvc-绑定-pv"}},[t._v("#")]),t._v(" 演示：创建 PVC，绑定 PV")]),t._v(" "),n("h3",{attrs:{id:"第一步-编写-yaml-文件-并创建-pvc"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第一步-编写-yaml-文件-并创建-pvc"}},[t._v("#")]),t._v(" 第一步：编写 yaml 文件，并创建 pvc")]),t._v(" "),n("p",[t._v("创建一个 pvc，需要 6G 存储；所以不会匹配 pv001、pv002、pv003")]),t._v(" "),n("div",{staticClass:"language-yaml extra-class"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" PersistentVolumeClaim\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mypvc\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" default\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("accessModes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadWriteMany"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("resources")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("requests")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("storage")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 6Gi\n\n\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\\"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Pod\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vol"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pvc\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" default\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("\\- name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" html\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("persistentVolumeClaim")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("claimName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" mypvc\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("containers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("\\- name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" myapp\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ikubernetes/myapp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("v1\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumeMounts")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("\\- name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" html\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("mountPath")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /usr/share/nginx/html/\n\n")])])]),n("h3",{attrs:{id:"第二步-执行命令创建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第二步-执行命令创建"}},[t._v("#")]),t._v(" 第二步：执行命令创建")]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("kubectl apply -f vol-pvc-demo.yaml\n")])])]),n("h3",{attrs:{id:"第三步-查询验证-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第三步-查询验证-2"}},[t._v("#")]),t._v(" 第三步：查询验证")]),t._v(" "),n("p",[n("img",{attrs:{src:s(1030),alt:""}})]),t._v(" "),n("h2",{attrs:{id:"演示-创建-pvc-绑定-pv-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#演示-创建-pvc-绑定-pv-2"}},[t._v("#")]),t._v(" 演示：创建 PVC，绑定 PV")]),t._v(" "),n("h3",{attrs:{id:"第一步-编写-yaml-文件-并创建-pvc-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第一步-编写-yaml-文件-并创建-pvc-2"}},[t._v("#")]),t._v(" 第一步：编写 yaml 文件，并创建 pvc")]),t._v(" "),n("p",[t._v("创建一个 pvc，需要 6G 存储；所以不会匹配 pv001、pv002、pv003")]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("apiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\nname: mypvc\nnamespace: default\nspec:\naccessModes: "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadWriteMany"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nresources:\nrequests:\nstorage: 6Gi\n---\napiVersion: v1\nkind: Pod\nmetadata:\nname: vol-pvc\nnamespace: default\nspec:\nvolumes:\n\n* name: html\n\npersistentVolumeClaim:\nclaimName: mypvc\ncontainers:\n\n* name: myapp\n\nimage: ikubernetes/myapp:v1\nvolumeMounts:\n\n* name: html\n\nmountPath: /usr/share/nginx/html/\n")])])]),n("h3",{attrs:{id:"第二步-执行命令创建-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第二步-执行命令创建-2"}},[t._v("#")]),t._v(" 第二步：执行命令创建")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("\nkubectl apply -f vol-pvc-demo.yaml\n")])])]),n("h3",{attrs:{id:"第三步-查询验证-3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第三步-查询验证-3"}},[t._v("#")]),t._v(" 第三步：查询验证")]),t._v(" "),n("p",[n("img",{attrs:{src:s(1031),alt:""}}),n("br"),t._v(" "),n("img",{attrs:{src:s(1032),alt:""}})])])}),[],!1,null,null,null);a.default=e.exports}}]);