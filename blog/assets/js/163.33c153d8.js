(window.webpackJsonp=window.webpackJsonp||[]).push([[163],{1249:function(s,t,a){"use strict";a.r(t);var n=a(19),r=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"问题发现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题发现"}},[s._v("#")]),s._v(" 问题发现")]),s._v(" "),a("h3",{attrs:{id:"_1-作业"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-作业"}},[s._v("#")]),s._v(" -1 作业:")]),s._v(" "),a("p",[s._v("完善上课笔记:")]),s._v(" "),a("p",[s._v("结合与自己的工作内容,以及课程内容;写上自己的理解 => 小五")]),s._v(" "),a("p",[s._v("老师笔记会延时发放 3天")]),s._v(" "),a("h3",{attrs:{id:"_0-课程内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0-课程内容"}},[s._v("#")]),s._v(" 0. 课程内容")]),s._v(" "),a("ol",[a("li",[s._v("课程回顾（MySQL结构）")]),s._v(" "),a("li",[s._v("linux->mysql安装")]),s._v(" "),a("li",[s._v("linux命令基础->管道机制")]),s._v(" "),a("li",[s._v("影响mysql性能的要素点")]),s._v(" "),a("li",[s._v("linux查询系统性能的方法")]),s._v(" "),a("li",[s._v("mysql性能检测")]),s._v(" "),a("li",[s._v("第三放工具的测试")])]),s._v(" "),a("h3",{attrs:{id:"_1-课程回顾-mysql结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-课程回顾-mysql结构"}},[s._v("#")]),s._v(" 1. 课程回顾（MySQL结构）")]),s._v(" "),a("h3",{attrs:{id:"_2-linux-mysql安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-linux-mysql安装"}},[s._v("#")]),s._v(" 2. linux->mysql安装")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("-- 下载目录\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /.\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" study\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" study\n\n-- 下载MySQL7的版本\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\n-- 下载MySQL8的版本\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.16-linux-glibc2.12-x86_64.tar.xz\n\n-- 解压\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zvxf mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz\n\n-- /usr/local 目录下创建文件夹存\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/msyql\n-- 移动\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" mysql-5.7.26-linux-glibc2.12-x86_64/* /usr/lcoal/mysql\n\n-- 添加mysql组和mysql 用户：\n-- 添加mysql组：\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" mysql\n\n-- 添加mysql用户：\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" -r -g mysql mysql\n\n-- 配置MySQL\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/mysql\n\n-- 主：从5.7.18开始不在二进制包中提供my-default.cnf文件\n-- 进入MySQL的bin目录\n-- 查看MySQL对于配置文件的查找路径，越左优先查找\n/bin/mysql --help "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Default options'")]),s._v(" -A "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n-- 创建配置文件\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" /usr/local/mysql/etc/my.cnf\n")])])]),a("p",[s._v("添加内容")]),s._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nport=3307\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ndefault"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("character"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("set=utf8\nsocket=/var/lib/mysql/mysql.sock\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nskip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("grant"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tables\nport=3307\nsocket=/var/lib/mysql/mysql.sock\nbasedir=/usr/local/mysql\ndatadir=/usr/local/mysql/data\nmax_connections=200\ncharacter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("set"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server=utf8\ndefault"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("storage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("engine=INNODB\nmax_allowed_packet=16M\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("-- 设置开机启动\n-- 复制启动脚本到资源目录\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" ./support-files/mysql.server /etc/rc.d/init.d/mysql\n-- 增加 mysqld 服务控制脚本执行权限\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /etc/rc.d/init.d/mysql\n-- 将 mysqld 服务加入到系统服务\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" --add mysql\n-- 检查mysqld服务是否已经生效\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" --list mysql\n\n-- 启动MySQL\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" mysql start\n\n-- 环境变量配置\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/profile\n")])])]),a("p",[s._v("添加如下内容  大概在52行左右")]),s._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[s._v("PATH = $PATH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/usr/local/mysql/bin\nexport\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("-- 刷新\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile\n-- 检测\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n\n-- 修改登入密码\nmysql\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" usr mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" update user "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("authentication_string")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("PASSWORD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'你的密码'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" where "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" alter user "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" identified by "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" flush privileges"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" quit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n-- 修改/usr/local/mysql/etc/my.cnf 文件\n-- 注释skip-grant-tables\n-- 重启MySQL\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" mysql restart\n\n-- 测试\nmysql -u root -p\n\n-- 配置远程访问\n-- 防火墙端口设置，便于远程访问\nfirewall-cmd --zone"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("/tcp --permanent\nfirewall-cmd --reload\n-- 查看端口\nfirewall-cmd --list-ports\n\n启动防火墙服务：systemctl ummask firewalld\n启动防火墙：systemctl start firewalld\n\n-- 进入MySQL\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" grant all privileges  on *.* to root@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" identified by "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" flush privileges"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n-- 如果没有效果可以尝试重启一下MySQL\n")])])]),a("h3",{attrs:{id:"_2-影响mysql性能的要素点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-影响mysql性能的要素点"}},[s._v("#")]),s._v(" 2. 影响mysql性能的要素点")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("系统(靠钱)CPU内存")])]),s._v(" "),a("li",[a("p",[s._v("I/O,mysql进程状态,mysql服务器周期变化 => mysql版本 以及 电脑处理")])]),s._v(" "),a("li",[a("p",[s._v("业务"),a("br"),s._v("\n数据库设计 => 六大范式 (三大范式) => join")]),s._v(" "),a("p",[s._v("在性能角度来说:不是范式越高越好 适量选择与冗余一些字段")]),s._v(" "),a("p",[s._v("项目中sql语句编写以及索引建立")]),s._v(" "),a("p",[s._v("业务分析 不当 项目预期设计 性能")]),s._v(" "),a("p",[s._v("论坛文章统计 => 实时更新文章总数量")]),s._v(" "),a("p",[s._v("select count(*) from 论坛文章; 100w")]),s._v(" "),a("p",[s._v("大量 2000w 查询时间 12s")]),s._v(" "),a("p",[s._v("物化视图")]),s._v(" "),a("p",[s._v("分析->业务")]),s._v(" "),a("p",[s._v("100w/2")]),s._v(" "),a("p",[s._v("需求变更 => 功能")]),s._v(" "),a("p",[s._v("业务代码")])])]),s._v(" "),a("p",[s._v("mysql优化->思路")]),s._v(" "),a("p",[s._v("数据库-数据表的设计结构->sql语句优化->数据库参数配置(事务日志)->源头(源码角度 c++)(扩展)->硬件(充值)")]),s._v(" "),a("p",[s._v("性能优化:俗气 抠门 ; 合理利用可用的资源")]),s._v(" "),a("h3",{attrs:{id:"_3-怎么去思考性能问题-鱼骨图-思考问题方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-怎么去思考性能问题-鱼骨图-思考问题方法"}},[s._v("#")]),s._v(" 3. 怎么去思考性能问题(鱼骨图 - 思考问题方法)")]),s._v(" "),a("h3",{attrs:{id:"_4-linux-常见的分析系统性能方法工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-linux-常见的分析系统性能方法工具"}},[s._v("#")]),s._v(" 4. linux 常见的分析系统性能方法工具")]),s._v(" "),a("p",[s._v("ps,top,vmstat,sar,free命令 =>  了解 参数")]),s._v(" "),a("h3",{attrs:{id:"_5-mysql性能测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-mysql性能测试"}},[s._v("#")]),s._v(" 5. mysql性能测试")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("status")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" processlist\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" variables\n")])])]),a("p",[s._v("mysqlslap是mysql自带的基准测试工具，优点:查询数据,语法简单,灵活容易使用.该工具可以模拟多个客户端同时并发的向服务器发出查询更新,给出了性能测试数据而且提供了多种引擎的性能比较.msqlslap为mysql性能优化前后提供了直观的验证依据,建议系统运维和DBA人员应该掌握一些常见的压力测试工具,才能准确的掌握线上数据库支撑的用户流量上限及其抗压性等问题。")]),s._v(" "),a("p",[s._v('mysqlslap -h 127.0.0.1 -u root -p -c 100 -i 1 --create-schema tipaskx -q "select count(*) from ask_users" -e innodb --number-of-queries=5000')]),s._v(" "),a("h3",{attrs:{id:"_6-第三方测试的工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-第三方测试的工具"}},[s._v("#")]),s._v(" 6. 第三方测试的工具")]),s._v(" "),a("p",[s._v("ab官网 http://httpd.apache.org/docs/2.0/programs/ab.html")]),s._v(" "),a("p",[s._v("ab命令对发出负载的计算机要求很低，既不会占用很多CPU，也不会占用太多的内存，但却会给目标服务器造成巨大的负载，因此是某些DDOS攻击之必备良药，老少皆宜。自己使用也须谨慎。否则一次上太多的负载，造成目标服务器直接因内存耗光死机，而不得不硬重启，得不偿失。")]),s._v(" "),a("p",[s._v("JMeter是一个java应用程序，可以加载其他应用并测试其性能。它虽然是设计用来测试Web应用的，但也可以用于测试其他诸如FTP服务器，或者通过JDBC进行数据库查询测试。")]),s._v(" "),a("p",[s._v("JMeter比ab要复杂的多。例如他可以通过控制预热时间等参数更加灵活地模拟真实用户的访问。JMeter拥有绘图接口，还可以对测试进行记录，然后离线重演测试结果。")]),s._v(" "),a("h2",{attrs:{id:"注意需要下载java的jdbc-jar包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意需要下载java的jdbc-jar包"}},[s._v("#")]),s._v(" 注意需要下载java的jdbc jar包")])])}),[],!1,null,null,null);t.default=r.exports}}]);