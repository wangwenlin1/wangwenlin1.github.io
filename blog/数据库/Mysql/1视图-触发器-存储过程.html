<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>视图，存储过程，触发器 | 一名GO+PHP工程师</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/blog/assets/css/0.styles.b3aba94c.css" as="style"><link rel="preload" href="/blog/assets/js/app.3a2a0635.js" as="script"><link rel="preload" href="/blog/assets/js/3.21e2e031.js" as="script"><link rel="preload" href="/blog/assets/js/37.6c8b6e4d.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.d053698b.js"><link rel="prefetch" href="/blog/assets/js/100.d5cb88cb.js"><link rel="prefetch" href="/blog/assets/js/101.6bbce255.js"><link rel="prefetch" href="/blog/assets/js/102.968ea43c.js"><link rel="prefetch" href="/blog/assets/js/103.c5c5130e.js"><link rel="prefetch" href="/blog/assets/js/104.161b590d.js"><link rel="prefetch" href="/blog/assets/js/105.eaae1ece.js"><link rel="prefetch" href="/blog/assets/js/106.8bdfd9bf.js"><link rel="prefetch" href="/blog/assets/js/107.c9b230ac.js"><link rel="prefetch" href="/blog/assets/js/108.a5880443.js"><link rel="prefetch" href="/blog/assets/js/109.bab44539.js"><link rel="prefetch" href="/blog/assets/js/11.bc7d0bf1.js"><link rel="prefetch" href="/blog/assets/js/110.7ba602f1.js"><link rel="prefetch" href="/blog/assets/js/111.a11c7d35.js"><link rel="prefetch" href="/blog/assets/js/112.bb76db96.js"><link rel="prefetch" href="/blog/assets/js/113.9b314292.js"><link rel="prefetch" href="/blog/assets/js/114.f28a4d47.js"><link rel="prefetch" href="/blog/assets/js/115.6a21a21a.js"><link rel="prefetch" href="/blog/assets/js/116.1fd8cdf3.js"><link rel="prefetch" href="/blog/assets/js/117.193b54e8.js"><link rel="prefetch" href="/blog/assets/js/118.d91f7ec2.js"><link rel="prefetch" href="/blog/assets/js/119.857d484f.js"><link rel="prefetch" href="/blog/assets/js/12.2003a6c5.js"><link rel="prefetch" href="/blog/assets/js/120.c2fc1bab.js"><link rel="prefetch" href="/blog/assets/js/121.e93dfc27.js"><link rel="prefetch" href="/blog/assets/js/122.0ea0246a.js"><link rel="prefetch" href="/blog/assets/js/123.31436cd9.js"><link rel="prefetch" href="/blog/assets/js/124.6b522c49.js"><link rel="prefetch" href="/blog/assets/js/125.7be39e4f.js"><link rel="prefetch" href="/blog/assets/js/126.8b8a9b2d.js"><link rel="prefetch" href="/blog/assets/js/127.7d06eb7f.js"><link rel="prefetch" href="/blog/assets/js/128.3498b329.js"><link rel="prefetch" href="/blog/assets/js/129.b4fdbe4d.js"><link rel="prefetch" href="/blog/assets/js/13.d2837ebd.js"><link rel="prefetch" href="/blog/assets/js/130.4acdc8e4.js"><link rel="prefetch" href="/blog/assets/js/131.ef9fa33c.js"><link rel="prefetch" href="/blog/assets/js/132.1f9b4bbb.js"><link rel="prefetch" href="/blog/assets/js/133.a417b118.js"><link rel="prefetch" href="/blog/assets/js/134.6a6cf86d.js"><link rel="prefetch" href="/blog/assets/js/135.313b60a3.js"><link rel="prefetch" href="/blog/assets/js/136.2c3aff88.js"><link rel="prefetch" href="/blog/assets/js/137.50106a44.js"><link rel="prefetch" href="/blog/assets/js/138.87124965.js"><link rel="prefetch" href="/blog/assets/js/139.cb5c4cb6.js"><link rel="prefetch" href="/blog/assets/js/14.48fb5c32.js"><link rel="prefetch" href="/blog/assets/js/140.9719663d.js"><link rel="prefetch" href="/blog/assets/js/141.b0090c83.js"><link rel="prefetch" href="/blog/assets/js/142.e385a422.js"><link rel="prefetch" href="/blog/assets/js/143.9d960553.js"><link rel="prefetch" href="/blog/assets/js/144.e3ef5a71.js"><link rel="prefetch" href="/blog/assets/js/145.95b58ec4.js"><link rel="prefetch" href="/blog/assets/js/146.92cd1d56.js"><link rel="prefetch" href="/blog/assets/js/147.1aad7186.js"><link rel="prefetch" href="/blog/assets/js/148.b0a6ba25.js"><link rel="prefetch" href="/blog/assets/js/149.cf51c7a4.js"><link rel="prefetch" href="/blog/assets/js/15.977c5e43.js"><link rel="prefetch" href="/blog/assets/js/150.8961d634.js"><link rel="prefetch" href="/blog/assets/js/151.d4337140.js"><link rel="prefetch" href="/blog/assets/js/152.d4fcbdac.js"><link rel="prefetch" href="/blog/assets/js/153.8f0df288.js"><link rel="prefetch" href="/blog/assets/js/154.3108e3fe.js"><link rel="prefetch" href="/blog/assets/js/155.1c76998b.js"><link rel="prefetch" href="/blog/assets/js/156.14a1e6f8.js"><link rel="prefetch" href="/blog/assets/js/157.2a90db8a.js"><link rel="prefetch" href="/blog/assets/js/158.f649eaa4.js"><link rel="prefetch" href="/blog/assets/js/159.bde474db.js"><link rel="prefetch" href="/blog/assets/js/16.cc3bb18b.js"><link rel="prefetch" href="/blog/assets/js/160.da7deb2a.js"><link rel="prefetch" href="/blog/assets/js/161.5124a074.js"><link rel="prefetch" href="/blog/assets/js/162.7f4358a0.js"><link rel="prefetch" href="/blog/assets/js/163.76da1c99.js"><link rel="prefetch" href="/blog/assets/js/164.ebc9b6a7.js"><link rel="prefetch" href="/blog/assets/js/165.f7cbff8f.js"><link rel="prefetch" href="/blog/assets/js/166.5bcaa3dd.js"><link rel="prefetch" href="/blog/assets/js/167.b4296d08.js"><link rel="prefetch" href="/blog/assets/js/168.27dc81ce.js"><link rel="prefetch" href="/blog/assets/js/169.4614ac4e.js"><link rel="prefetch" href="/blog/assets/js/17.180fd8e8.js"><link rel="prefetch" href="/blog/assets/js/170.e41001f5.js"><link rel="prefetch" href="/blog/assets/js/171.0724bbd4.js"><link rel="prefetch" href="/blog/assets/js/172.2d5b541f.js"><link rel="prefetch" href="/blog/assets/js/173.f03b20a0.js"><link rel="prefetch" href="/blog/assets/js/174.092074fb.js"><link rel="prefetch" href="/blog/assets/js/175.bbae3a5c.js"><link rel="prefetch" href="/blog/assets/js/176.2380b0cf.js"><link rel="prefetch" href="/blog/assets/js/177.67fa30a9.js"><link rel="prefetch" href="/blog/assets/js/178.7f4bf5e6.js"><link rel="prefetch" href="/blog/assets/js/18.fa5bec70.js"><link rel="prefetch" href="/blog/assets/js/19.82d0b6cb.js"><link rel="prefetch" href="/blog/assets/js/2.cf693890.js"><link rel="prefetch" href="/blog/assets/js/20.8d88eb5f.js"><link rel="prefetch" href="/blog/assets/js/21.04aa936c.js"><link rel="prefetch" href="/blog/assets/js/22.6f38dceb.js"><link rel="prefetch" href="/blog/assets/js/23.00b0c454.js"><link rel="prefetch" href="/blog/assets/js/24.4949647c.js"><link rel="prefetch" href="/blog/assets/js/25.f090d9de.js"><link rel="prefetch" href="/blog/assets/js/26.64e9b11e.js"><link rel="prefetch" href="/blog/assets/js/27.f6f1b280.js"><link rel="prefetch" href="/blog/assets/js/28.ba46dc32.js"><link rel="prefetch" href="/blog/assets/js/29.08dd160e.js"><link rel="prefetch" href="/blog/assets/js/30.1f6b9a8b.js"><link rel="prefetch" href="/blog/assets/js/31.edcef4fa.js"><link rel="prefetch" href="/blog/assets/js/32.763b7b98.js"><link rel="prefetch" href="/blog/assets/js/33.10fa82ac.js"><link rel="prefetch" href="/blog/assets/js/34.783e6db1.js"><link rel="prefetch" href="/blog/assets/js/35.86d13f87.js"><link rel="prefetch" href="/blog/assets/js/36.c81ca450.js"><link rel="prefetch" href="/blog/assets/js/38.fed1555d.js"><link rel="prefetch" href="/blog/assets/js/39.d8367356.js"><link rel="prefetch" href="/blog/assets/js/4.33e3eeff.js"><link rel="prefetch" href="/blog/assets/js/40.890bdfe6.js"><link rel="prefetch" href="/blog/assets/js/41.351a2bb7.js"><link rel="prefetch" href="/blog/assets/js/42.7dc0997f.js"><link rel="prefetch" href="/blog/assets/js/43.b1eb7b31.js"><link rel="prefetch" href="/blog/assets/js/44.96773f8a.js"><link rel="prefetch" href="/blog/assets/js/45.14984c3f.js"><link rel="prefetch" href="/blog/assets/js/46.360c94b5.js"><link rel="prefetch" href="/blog/assets/js/47.6ba6e036.js"><link rel="prefetch" href="/blog/assets/js/48.7e30092c.js"><link rel="prefetch" href="/blog/assets/js/49.cffe09bd.js"><link rel="prefetch" href="/blog/assets/js/5.93c02369.js"><link rel="prefetch" href="/blog/assets/js/50.10849ea7.js"><link rel="prefetch" href="/blog/assets/js/51.29fb5c68.js"><link rel="prefetch" href="/blog/assets/js/52.c183fd4d.js"><link rel="prefetch" href="/blog/assets/js/53.2102d53f.js"><link rel="prefetch" href="/blog/assets/js/54.a7def65b.js"><link rel="prefetch" href="/blog/assets/js/55.e1462b05.js"><link rel="prefetch" href="/blog/assets/js/56.d35a7dec.js"><link rel="prefetch" href="/blog/assets/js/57.f908b76a.js"><link rel="prefetch" href="/blog/assets/js/58.8c699c1a.js"><link rel="prefetch" href="/blog/assets/js/59.013048e6.js"><link rel="prefetch" href="/blog/assets/js/6.bf46d9ef.js"><link rel="prefetch" href="/blog/assets/js/60.96011719.js"><link rel="prefetch" href="/blog/assets/js/61.c57dc954.js"><link rel="prefetch" href="/blog/assets/js/62.24bf6999.js"><link rel="prefetch" href="/blog/assets/js/63.2f87f55d.js"><link rel="prefetch" href="/blog/assets/js/64.68cd3b45.js"><link rel="prefetch" href="/blog/assets/js/65.d1a0e0c0.js"><link rel="prefetch" href="/blog/assets/js/66.d694b5d5.js"><link rel="prefetch" href="/blog/assets/js/67.1d93ad03.js"><link rel="prefetch" href="/blog/assets/js/68.7a922734.js"><link rel="prefetch" href="/blog/assets/js/69.e8dc5f21.js"><link rel="prefetch" href="/blog/assets/js/7.965a7048.js"><link rel="prefetch" href="/blog/assets/js/70.0ab39b68.js"><link rel="prefetch" href="/blog/assets/js/71.32fb9ba8.js"><link rel="prefetch" href="/blog/assets/js/72.d7621fb4.js"><link rel="prefetch" href="/blog/assets/js/73.f0b18643.js"><link rel="prefetch" href="/blog/assets/js/74.f4b27305.js"><link rel="prefetch" href="/blog/assets/js/75.d52134dd.js"><link rel="prefetch" href="/blog/assets/js/76.af8a1eb5.js"><link rel="prefetch" href="/blog/assets/js/77.be15b0d2.js"><link rel="prefetch" href="/blog/assets/js/78.d456dcce.js"><link rel="prefetch" href="/blog/assets/js/79.12735350.js"><link rel="prefetch" href="/blog/assets/js/8.78eeb959.js"><link rel="prefetch" href="/blog/assets/js/80.2120e0e9.js"><link rel="prefetch" href="/blog/assets/js/81.04f50a1e.js"><link rel="prefetch" href="/blog/assets/js/82.db879ca5.js"><link rel="prefetch" href="/blog/assets/js/83.e89b8863.js"><link rel="prefetch" href="/blog/assets/js/84.07410b58.js"><link rel="prefetch" href="/blog/assets/js/85.d3e35fad.js"><link rel="prefetch" href="/blog/assets/js/86.f855e246.js"><link rel="prefetch" href="/blog/assets/js/87.bf22bce7.js"><link rel="prefetch" href="/blog/assets/js/88.6ed1a43d.js"><link rel="prefetch" href="/blog/assets/js/89.50e298db.js"><link rel="prefetch" href="/blog/assets/js/9.009d1183.js"><link rel="prefetch" href="/blog/assets/js/90.391f76ed.js"><link rel="prefetch" href="/blog/assets/js/91.d1662d38.js"><link rel="prefetch" href="/blog/assets/js/92.a65aa479.js"><link rel="prefetch" href="/blog/assets/js/93.bc850b53.js"><link rel="prefetch" href="/blog/assets/js/94.7dc858d7.js"><link rel="prefetch" href="/blog/assets/js/95.fce3d2c0.js"><link rel="prefetch" href="/blog/assets/js/96.7e3abf55.js"><link rel="prefetch" href="/blog/assets/js/97.64d3b035.js"><link rel="prefetch" href="/blog/assets/js/98.fdb7d67a.js"><link rel="prefetch" href="/blog/assets/js/99.9a416d3b.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b3aba94c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">一名GO+PHP工程师</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://gitee.com/ColinWWL/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://gitee.com/ColinWWL/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/blog/数据库/Mysql/1视图-触发器-存储过程" class="sidebar-heading clickable open active"><span>Mysql</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/数据库/Mysql/1视图-触发器-存储过程.html" class="active sidebar-link">视图，存储过程，触发器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/数据库/Mysql/1视图-触发器-存储过程.html#_1-视图" class="sidebar-link">1. 视图</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mysql/1视图-触发器-存储过程.html#_2-触发器" class="sidebar-link">2. 触发器</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mysql/1视图-触发器-存储过程.html#_3-存储过程" class="sidebar-link">3. 存储过程</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mysql/1视图-触发器-存储过程.html#_3-物化视图" class="sidebar-link">3. 物化视图</a></li></ul></li><li><a href="/blog/数据库/Mysql/2物化视图-事务.html" class="sidebar-link">物化视图-事务</a></li><li><a href="/blog/数据库/Mysql/3事务日志与锁初体验.html" class="sidebar-link">事务与锁</a></li><li><a href="/blog/数据库/Mysql/4事务隔离与锁的关系.html" class="sidebar-link">事务隔离与锁的关系</a></li><li><a href="/blog/数据库/Mysql/5锁机制与数据库结构.html" class="sidebar-link">锁机制与数据库结构</a></li><li><a href="/blog/数据库/Mysql/6数据库文件.html" class="sidebar-link">数据库结构</a></li><li><a href="/blog/数据库/Mysql/7结构与存储引擎.html" class="sidebar-link">数据库结构详解</a></li><li><a href="/blog/数据库/Mysql/8发现问题.html" class="sidebar-link">问题发现</a></li><li><a href="/blog/数据库/Mysql/9数据库的基础设计.html" class="sidebar-link">数据库基础设计与表设计</a></li><li><a href="/blog/数据库/Mysql/10数据库字段选择与sql执行.html" class="sidebar-link">数据表字段选择与SQL执行流程</a></li><li><a href="/blog/数据库/Mysql/11sql分析.html" class="sidebar-link">sql分析</a></li><li><a href="/blog/数据库/Mysql/12explain实例与IO操作.html" class="sidebar-link">explain实例与IO操作</a></li><li><a href="/blog/数据库/Mysql/13SQL执行IO操作及索引基础.html" class="sidebar-link">SQL执行IO操作及索引基础</a></li><li><a href="/blog/数据库/Mysql/14索引基础.html" class="sidebar-link">索引基础</a></li><li><a href="/blog/数据库/Mysql/15SQL优化实例.html" class="sidebar-link">SQL优化案例实践</a></li><li><a href="/blog/数据库/Mysql/16join初步.html" class="sidebar-link">join 初步</a></li><li><a href="/blog/数据库/Mysql/17join优化思路.html" class="sidebar-link">join优化以及条件解析</a></li><li><a href="/blog/数据库/Mysql/20索引总结iCP与where提取.html" class="sidebar-link">索引总结iCP与where提取</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="视图-存储过程-触发器"><a href="#视图-存储过程-触发器" class="header-anchor">#</a> 视图，存储过程，触发器</h1> <h4 id="面试题"><a href="#面试题" class="header-anchor">#</a> 面试题</h4> <p>面试你所要知道的: MySQL存储过程 https://blog.csdn.net/u012190514/article/details/80282161</p> <h4 id="序言"><a href="#序言" class="header-anchor">#</a> 序言</h4> <p>mysql 的CURD的基础内容在这里就跳过，关于select，update，delete，insert的基础使用以及select的复杂查询在本节中将会跳过</p> <h4 id="课程内容"><a href="#课程内容" class="header-anchor">#</a> 课程内容</h4> <ol><li>视图</li> <li>存储过程</li> <li>触发器</li></ol> <h4 id="数据表"><a href="#数据表" class="header-anchor">#</a> 数据表</h4> <p>结构</p> <p><img src="/blog/assets/img/2021-05-14-16-46-24.d8dae70d.png" alt=""></p> <p>数据<br> <img src="/blog/assets/img/2021-05-14-16-46-31.53ad7d1e.png" alt=""></p> <h2 id="_1-视图"><a href="#_1-视图" class="header-anchor">#</a> 1. 视图</h2> <h4 id="_1-1-概念"><a href="#_1-1-概念" class="header-anchor">#</a> 1.1 概念</h4> <ol><li>视图是 MySQL 在 5.0.1 版本中加入的功能。它可以理解为一个虚表。</li> <li>之所以被称为虚表，是因为它只是存储了一个结构，并不存储真实的数据。它的数据是在查询过程中动态生成的。</li> <li>视图并不是真的优化</li></ol> <h4 id="_1-2-创建视图"><a href="#_1-2-创建视图" class="header-anchor">#</a> 1.2 创建视图</h4> <p>视图 只是存储了一个结构，并不存储真实的数据。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 创建视图</span>
<span class="token keyword">create</span> <span class="token keyword">VIEW</span> user_view <span class="token keyword">as</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>user_name<span class="token punctuation">,</span>email <span class="token keyword">from</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_1-3-查看视图"><a href="#_1-3-查看视图" class="header-anchor">#</a> 1.3 查看视图</h4> <p>和表一样，我们可以用 desc 视图名; 来查看视图的每一列</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">desc</span> user_view<span class="token punctuation">;</span>
<span class="token comment">-- 查看创建的视图语法</span>
<span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">view</span> user_view<span class="token punctuation">;</span>
<span class="token comment">-- 查询视图内容</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_view<span class="token punctuation">;</span>
</code></pre></div><p><img src="data:image/png;base64,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" alt=""></p> <p><strong>&gt;</strong> 注意：视图查询的数据实则来自与源数据中的内容，而它本质是一个存储了一个结构，并不是存储真实的数据。</p> <p><strong>&gt;</strong> 比如：如同PHP中的一个查询方法的封装</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name">db</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string single-quoted-string">'sql: select id,user_name,email from `user`'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h4 id="_1-4-视图优点"><a href="#_1-4-视图优点" class="header-anchor">#</a> 1.4 视图优点</h4> <ol><li><p>第一个显著优点就是它简化了操作。此时我们完全不用关心视图是怎么处理数据的，我们只需要知道如何使用这个结果集即可，视图相当于一个中间层。</p></li> <li><p>第二个显著优点就是它更加安全。比如我们可以让用户有权去访问某个视图，但是不能访问原表，这样就可以起到保护原表中某些数据的作用。</p></li> <li><p>我们之后会接触到管理权限，权限是无法细致到某一个列的，通过视图，则很容易实现。</p></li> <li><p>第三个显著优点就是降低耦合。假如我们以后要修改原表的结构，那么我们可以通过修改视图的定义即可，而不用修改应用程序，对访问者是不会造成影响的，一般来说，这样代价会更小。</p></li></ol> <h4 id="_1-5-视图缺点"><a href="#_1-5-视图缺点" class="header-anchor">#</a> 1.5 视图缺点</h4> <ol start="5"><li>表结构修改则需要手动修改视图</li></ol> <h4 id="_1-6-视图iud"><a href="#_1-6-视图iud" class="header-anchor">#</a> 1.6 视图IUD</h4> <p>表是可以更新数据的，这里的更新，指的是”增删改”, 但是对于视图来说 <em>不一定</em>。</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">update</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token keyword">set</span> email <span class="token operator">=</span> <span class="token number">00</span> <span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_view<span class="token punctuation">;</span>
<span class="token comment">-- 删除视图</span>
<span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> user_view_2<span class="token punctuation">;</span>
</code></pre></div><p><em>以下是视图不可更新的情况</em></p> <ol><li>包含聚合函数、distinct、group by、having、union、union all。</li> <li>常量视图。</li> <li>select 包含子查询。</li> <li>包含连接操作。</li> <li>from 一个不能更新的视图。</li> <li>where 子句的子查询引用了 from 子句中的表。</li></ol> <p>自个测试...</p> <p><em>更新视图的注意点</em><br>
如下数据<br> <img src="/blog/assets/img/2021-05-14-16-46-54.19adc297.png" alt=""></p> <p>创建一个新的视图</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">view</span> user_view_2 <span class="token keyword">as</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>user_name<span class="token punctuation">,</span>password<span class="token punctuation">,</span>email<span class="token punctuation">,</span><span class="token keyword">status</span> <span class="token keyword">from</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token keyword">where</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_view_2<span class="token punctuation">;</span>
</code></pre></div><p>现在如果给这个视图新增数据 status = 1；</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> user_view_2<span class="token punctuation">(</span>id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> password<span class="token punctuation">,</span> email<span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">'221'</span><span class="token punctuation">,</span> <span class="token string">'12'</span><span class="token punctuation">,</span> <span class="token string">'12'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> user_view_2<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span><span class="token punctuation">;</span>
</code></pre></div><p>你会发现我们可以向该视图插入数据，它不满足本视图的要求，但是数据可以插入基表了。在前面也有所讲过该操作有点类似于PHP的代码封装的操作。我们把该视图的操作转化为PHP 方法就是如下</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">function</span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$status</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string double-quoted-string">&quot;sql: select id,user_name,password,email,status from `user` where status = 0&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p>但是有些时候的我们不希望这种情况的发生，如果不满足视图的条件就不插入，就和PHP方法的条件判断一样</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$status</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string single-quoted-string">'insert'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p><em>with check option</em></p> <ol><li><p>对于上面的表 t2，我们想：是否可以创建一个视图，它只允许修改满足本视图要求的数据，而对于不满足本视图要求的数据操作， 统统拒绝呢？</p></li> <li><p>答案是肯定的。那就需要 with check option 了，不过该修饰符还有更加深一步的权限机制。</p></li> <li><p>首先我们还是利用上一步的 t2，我们创建一个视图 v3，它的创建</p></li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code>   <span class="token keyword">DROP</span> <span class="token keyword">VIEW</span> user_view_2<span class="token punctuation">;</span>
   <span class="token keyword">create</span> <span class="token keyword">view</span> user_view_2 <span class="token keyword">as</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span>user_name<span class="token punctuation">,</span>password<span class="token punctuation">,</span>email<span class="token punctuation">,</span><span class="token keyword">status</span> <span class="token keyword">from</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token keyword">where</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token number">0</span>  <span class="token keyword">with</span> <span class="token keyword">check</span> <span class="token keyword">option</span><span class="token punctuation">;</span>
   <span class="token keyword">insert</span> <span class="token keyword">into</span> user_view_2<span class="token punctuation">(</span>id<span class="token punctuation">,</span> user_name<span class="token punctuation">,</span> password<span class="token punctuation">,</span> email<span class="token punctuation">,</span> <span class="token keyword">status</span><span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">,</span> <span class="token string">'221'</span><span class="token punctuation">,</span> <span class="token string">'12'</span><span class="token punctuation">,</span> <span class="token string">'12'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>错误信息<br> <code>[Err] 1369 - CHECK OPTION failed 'community.user_view_2'</code></p> <blockquote><p>这里可以理解为 with check option 的作用就是多了一个 check 的功能，即检查的功能，也就是说插入的数据必须满足该视图的条件，才允许被操作。</p></blockquote> <h4 id="_1-7-视图应用-好处"><a href="#_1-7-视图应用-好处" class="header-anchor">#</a> 1.7 视图应用&amp;好处</h4> <ol><li>提高了重用性，就像一个函数 如果要频繁获取user的name和goods的name。就应该使用以下sql语言。示例：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>
    &amp;nbsp; &amp;nbsp; &amp;nbsp; select a.name as username, b.name as goodsname from user as a, goods as b, ug as c where a.id=c.userid and c.goodsid=b.id;&lt;br&gt;
</code></pre></div><p>但有了视图就不一样了，创建视图other。示例</p> <div class="language- extra-class"><pre class="language-text"><code>
    &amp;nbsp; &amp;nbsp; &amp;nbsp; create view other as select a.name as username, b.name as goodsname from user as a, goods as b, ug as c where a.id=c.userid and c.goodsid=b.id;&lt;br&gt;
</code></pre></div><p>创建好视图后，就可以这样获取user的name和goods的name。示例：</p> <div class="language- extra-class"><pre class="language-text"><code>
    &amp;nbsp; &amp;nbsp; &amp;nbsp; select * from other;&lt;br&gt;
</code></pre></div><p>以上sql语句，就能获取user的name和goods的name了。</p> <ol start="2"><li><p>对数据库重构，却不影响程序的运行假如因为某种需求，需要将user拆房表usera和表userb，该两张表的结构如下</p> <p>测试表:usera有id，name，age字段<br>
测试表:userb有id，name，sex字段</p></li></ol> <p>这时如果php端使用sql语句：select * from user; 那就会提示该表不存在，这时该如何解决呢。解决方案：创建视图。以下sql语句创建视图：</p> <div class="language- extra-class"><pre><code>  create view user as select a.name,a.age,b.sex from usera as a, userb as b where a.name=b.name; 以上假设name都是唯一的。此时php端使用sql语句：select * from user;就不会报错什么的。这就实现了更改数据库结构，不更改脚本程序的功能了。
</code></pre></div><ol start="3"><li><p>提高了安全性能。可以对不同的用户，设定不同的视图。例如：某用户只能获取user表的name和age数据，不能获取sex数据。则可以这样创建视图。示例如下：</p> <p>create view other as select a.name, a.age from user as a;</p></li></ol> <p>这样的话，使用sql语句：select * from other; 最多就只能获取name和age的数据，其他的数据就获取不了了。</p> <ol start="4"><li>让数据更加清晰想要什么样的数据，就创建什么样的视图。经过以上三条作用的解析，这条作用应该很容易理解了吧</li></ol> <h2 id="_2-触发器"><a href="#_2-触发器" class="header-anchor">#</a> 2. 触发器</h2> <ol><li>创建触发器：</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code>触发器  类似于 框架 事件
<span class="token keyword">create</span> <span class="token keyword">trigger</span> <span class="token punctuation">[</span>触发器名称<span class="token punctuation">]</span> <span class="token punctuation">[</span>触发器的执行时间<span class="token punctuation">]</span> <span class="token punctuation">[</span>执行的动作点<span class="token punctuation">]</span> <span class="token keyword">on</span> <span class="token punctuation">[</span>表名<span class="token punctuation">]</span> <span class="token keyword">for each row</span> <span class="token punctuation">[</span>函数 或者动作<span class="token punctuation">]</span>

触发器的执行时间 :before<span class="token punctuation">,</span> <span class="token keyword">after</span>
执行的动作点:<span class="token keyword">insert</span><span class="token punctuation">,</span> <span class="token keyword">update</span><span class="token punctuation">,</span> <span class="token keyword">delete</span>
函数:<span class="token keyword">begin</span> <span class="token keyword">end</span><span class="token punctuation">;</span>
或者动作:<span class="token keyword">update</span> <span class="token punctuation">,</span><span class="token keyword">insert</span>
</code></pre></div><h4 id="_2-1-案例"><a href="#_2-1-案例" class="header-anchor">#</a> 2.1 案例：</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">trigger</span>
    login_trigger_before
before <span class="token keyword">insert</span> <span class="token keyword">on</span>
    login
<span class="token keyword">for each row</span>
<span class="token keyword">begin</span>
    <span class="token keyword">update</span> test_trigger <span class="token keyword">set</span> count <span class="token operator">=</span> count<span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">where</span> id <span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">-- 代码区域</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> login_view <span class="token punctuation">(</span>id<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token string">'uuu'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_3-存储过程"><a href="#_3-存储过程" class="header-anchor">#</a> 3. 存储过程</h2> <p>对数据进行计算，分析汇总的时候，尤其是拿到别的公司数据的时候，进行转换为自己系统需要的数据和格式的时候</p> <h4 id="_3-1-概念"><a href="#_3-1-概念" class="header-anchor">#</a> 3.1 概念</h4> <p>存储过程和函数可以理解为一段 SQL 语句的集合，它们被事先编译好并且存储在数据库中。在 Pascal 语言中，是有”过程”和”函数”的区分的，过程可以理解为没有返回值的函数。不过在 C 家族语言中，则没有过程这个概念， 统一为函数。</p> <p>创建一个存储过程的语法为：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">procedure</span> 存储过程名<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    存储过程体
<span class="token keyword">end</span>

<span class="token keyword">call</span> 存储过程名<span class="token punctuation">(</span>参数列表<span class="token punctuation">)</span>
</code></pre></div><p>如下简单存储过程</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> user_procedure<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">PROCEDURE</span> user_procedure<span class="token punctuation">(</span><span class="token operator">in</span> x <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token comment">-- in 表示输入</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token keyword">where</span> id <span class="token operator">=</span> x<span class="token punctuation">;</span>
<span class="token keyword">END</span>
<span class="token comment">-- 执行</span>
<span class="token keyword">call</span> user_procedure<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><em>参数类型</em></p> <ol><li><p>从上面的过程中我们了解到存储过程有参数类型这种说法，它的类型可以取值有三个：in、out、inout。</p></li> <li><p>其中它们的意义如下：</p></li></ol> <p>(1) in 表示只是用来输入。</p> <p>(2) out 表示只是用来输出。</p> <p>(3) inout 可以用来输入，也可以用作输出。</p> <div class="language-sql extra-class"><pre class="language-sql"><code>   <span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> user_procedure_out<span class="token punctuation">;</span>
   <span class="token keyword">create</span> <span class="token keyword">PROCEDURE</span> user_procedure_out<span class="token punctuation">(</span><span class="token operator">in</span> x <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">out</span> y <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token keyword">BEGIN</span>
    <span class="token keyword">select</span> user_name <span class="token keyword">into</span> y <span class="token keyword">from</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token keyword">where</span> id <span class="token operator">=</span> x<span class="token punctuation">;</span>
   <span class="token keyword">END</span>
   <span class="token comment">-- 执行</span>
   <span class="token keyword">call</span> user_procedure_out<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">@a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">select</span> <span class="token variable">@a</span>
</code></pre></div><h4 id="_3-2-存储过程理解"><a href="#_3-2-存储过程理解" class="header-anchor">#</a> 3.2 存储过程理解</h4> <ol start="3"><li><p>调用存储过程与直接执行 SQL 语句的效果是相同的，但是存储过程的一个好处是处理逻辑都封装在数据库端。</p></li> <li><p>当我们调用存储过程的时候，我们不需要了解其中的处理逻辑，一旦处理逻辑发生变化，只需要修改存储过程即可，对调用它的程 序完全无影响。</p></li> <li><p>调用存储过程和函数可以简化应用开发人员的很多工作，减少数据在数据库和应用服务器之间的传输，可以提高数据处理的效率</p></li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code>   <span class="token keyword">show</span> <span class="token keyword">create</span> <span class="token keyword">PROCEDURE</span> user_procedure_out<span class="token punctuation">;</span>
</code></pre></div><h4 id="_3-3-变量"><a href="#_3-3-变量" class="header-anchor">#</a> 3.3 变量</h4> <ol start="6"><li><p>存储过程中是可以使用变量的，我们可以通过 declare 来定义一个局部变量，该变量的作用域只是 begin....end 块中。</p></li> <li><p>变量的定义必须写在符合语句的开头，并且在任何其他语句的前面。我们可以一次声明多个相同类型的变量，我们还可以使用default 来赋予默认值。</p></li> <li><p>定义一个变量的语法为： declare 变量名 1 [,变量名 2...] 变量类型 [default 默认值]</p></li> <li><p>上面的变量类型就是 MySQL 支持的类型，而变量名的取值规则也是一个老生常谈的话题了，就不赘述了。</p></li> <li><p>变量可以直接赋值，还可以通过查询赋值。</p></li> <li><p>直接赋值就是使用 set 来进行赋值，它的语法为： set 变量名 1 = 表达式 1 [,变量名 2=表达式 2...]</p></li> <li><p>也可以通过查询来将结果赋值给变量，它需要要求查询返回的结果只有一行，语法范例：<code>select 列名列表 into 变量列表 from 表名 其他语句；</code></p></li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> user_procedure_2<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">PROCEDURE</span> user_procedure_2<span class="token punctuation">(</span><span class="token operator">in</span> x <span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">out</span> y <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
    <span class="token keyword">declare</span> s <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token keyword">select</span> user_name <span class="token keyword">into</span> s <span class="token keyword">from</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token keyword">where</span> id <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token keyword">set</span> y <span class="token operator">=</span> s<span class="token punctuation">;</span>
<span class="token keyword">END</span>
<span class="token comment">-- 执行</span>
<span class="token keyword">call</span> user_procedure_2<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">@a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@a</span>
</code></pre></div><h4 id="_3-4-存储过程中的数据类型"><a href="#_3-4-存储过程中的数据类型" class="header-anchor">#</a> 3.4 存储过程中的数据类型</h4> <ol><li>数值类型：Int,float,double,decimal</li> <li>日期类型：timestamp,date,year</li> <li>字符串：char,varchar,text</li></ol> <p>timestamp: 是使用最多的数据类型-》十位数的时间戳 text：一旦用到text类型的时候就可以考虑分表； 如果部分表的话，该字段的查询不会直接放在一起查询，因为多个字段查询中其中如果有text字段的话，就容易遇到慢查询 所以通常的话，如果需要这个值的时候会根据id单独拿这个text字段</p> <h4 id="_3-5-流程控制语句其他语法"><a href="#_3-5-流程控制语句其他语法" class="header-anchor">#</a> 3.5 流程控制语句其他语法</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">if</span> 的语法格式为：
<span class="token keyword">if</span> 条件表达式 <span class="token keyword">then</span> 语句
    <span class="token punctuation">[</span><span class="token keyword">elseif</span> 条件表达式 <span class="token keyword">then</span> 语句<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">[</span><span class="token keyword">else</span> 语句<span class="token punctuation">]</span>
<span class="token keyword">end</span> <span class="token keyword">if</span>

<span class="token keyword">case</span> 的语法格式
首先是第一种写法：
<span class="token keyword">case</span> 表达式
    <span class="token keyword">when</span> 值 <span class="token keyword">then</span> 语句
    <span class="token keyword">when</span> 值 <span class="token keyword">then</span> 语句
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">[</span><span class="token keyword">else</span> 语句<span class="token punctuation">]</span>
<span class="token keyword">end</span> <span class="token keyword">case</span>
然后是第二种写法：
<span class="token keyword">case</span>
    <span class="token keyword">when</span> 表达式 <span class="token keyword">then</span> 语句
    <span class="token keyword">when</span> 表达式 <span class="token keyword">then</span> 语句
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">[</span><span class="token keyword">else</span> 语句<span class="token punctuation">]</span>
<span class="token keyword">end</span> <span class="token keyword">case</span>

<span class="token keyword">loop</span> 循环 语法格式为：
<span class="token punctuation">[</span>标号:<span class="token punctuation">]</span> <span class="token keyword">loop</span>
    循环语句
<span class="token keyword">end</span> <span class="token keyword">loop</span> <span class="token punctuation">[</span>标号<span class="token punctuation">]</span>

<span class="token keyword">while</span>
<span class="token keyword">while</span> a<span class="token operator">&gt;</span><span class="token number">100</span> <span class="token keyword">do</span>
 循环语句
<span class="token keyword">End</span> <span class="token keyword">while</span>

<span class="token keyword">Repeat</span>        <span class="token comment">//游标</span>
  <span class="token keyword">SQL</span>语句<span class="token number">1</span>
  UNTIL 条件表达式
<span class="token keyword">END</span> <span class="token keyword">Repeat</span><span class="token punctuation">;</span>

<span class="token keyword">Loop</span>
  <span class="token keyword">SQL</span>语句
  所有的条件判断和跳出需要自己实现
<span class="token keyword">End</span> <span class="token keyword">loop</span>

<span class="token keyword">leave</span> 语句用来从标注的流程构造中退出，它通常和 <span class="token keyword">begin</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token keyword">end</span> 或循环一起使用
<span class="token keyword">leave</span> 标号<span class="token punctuation">;</span>

声明语句结束符，可以自定义:
<span class="token keyword">DELIMITER</span> <span class="token punctuation">[</span>符合<span class="token punctuation">]</span>
<span class="token keyword">delimiter</span> $$

$$
</code></pre></div><h4 id="_3-6-游标"><a href="#_3-6-游标" class="header-anchor">#</a> 3.6 游标</h4> <ol><li>游标也有的资料上称为光标。</li> <li>我们可以在存储过程中使用游标来对结果集进行循环的处理。</li> <li>游标的使用步骤基本分为：声明、打开、取值、关闭。</li></ol> <p><em>语法：</em></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">DECLARE</span> test_cursor <span class="token keyword">CURSOR</span> <span class="token keyword">FOR</span> 结果集<span class="token punctuation">;</span>    <span class="token comment">//声明游标</span>
<span class="token keyword">OPEN</span> test_cursor<span class="token punctuation">;</span>                        <span class="token comment">//打开游标</span>
<span class="token keyword">CLOSE</span> test_cursor<span class="token punctuation">;</span>                        <span class="token comment">//关闭游标</span>
<span class="token keyword">DECLARE</span> <span class="token keyword">CONTINUE</span> <span class="token keyword">HANDLER</span> <span class="token keyword">FOR</span> <span class="token operator">NOT</span> FOUND    <span class="token comment">//结果集查询不到数据自动跳出</span>
</code></pre></div><p><em>总结：</em></p> <ol><li>游标的声明的语法： declare 游标名称 cursor for 查询语句;</li> <li>打开光标的语法： open 游标名称;</li> <li>获取游标数据： fetch 游标名称 into 变量名 1 [,变量名 2 ....]</li> <li>关闭游标的语法： close 游标名称;</li> <li>游标的基本使用须知：对某个表按照循环的处理，判断循环结束 的条件是捕获 not found 的条件，当 fetch 光标找不到下一条记录的 时候，就会关闭光标然后退出过程。</li> <li>可能有过 Pascal 编程经验的朋友们都会知道，声明的顺序也是很 重要的，在 SQL 中，我们使用 declare 定义的顺序是：变量、条件、 游标、应用程序</li></ol> <p><em>操作</em> 查询出来的数据会放置于临时表中，然后再通过游标去读取数据。</p> <p><em>案例</em></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">delimiter</span> $$
<span class="token keyword">create</span> <span class="token keyword">procedure</span> exchange<span class="token punctuation">(</span><span class="token keyword">out</span> count <span class="token keyword">int</span> <span class="token punctuation">)</span>
<span class="token keyword">begin</span>
    <span class="token keyword">declare</span> supply_id1 <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">declare</span> amount1 <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">-- 游标标识</span>
    <span class="token keyword">declare</span> blag <span class="token keyword">int</span> <span class="token keyword">default</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token comment">-- 游标</span>
    <span class="token keyword">declare</span> order_cursor <span class="token keyword">cursor</span> <span class="token keyword">for</span> <span class="token keyword">select</span> supply_id<span class="token punctuation">,</span>amount <span class="token keyword">from</span> order_group<span class="token punctuation">;</span>
    <span class="token comment">-- not found  这个异常进行处理</span>
    <span class="token keyword">declare</span> <span class="token keyword">continue</span> <span class="token keyword">handler</span> <span class="token keyword">for</span> <span class="token operator">not</span> found <span class="token keyword">set</span> blag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">set</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">-- 打开游标</span>
    <span class="token keyword">open</span> order_cursor<span class="token punctuation">;</span>
    <span class="token comment">-- 遍历</span>
    read_loop: <span class="token keyword">LOOP</span>
        <span class="token keyword">fetch</span> order_cursor <span class="token keyword">into</span> supply_id1<span class="token punctuation">,</span>amount1<span class="token punctuation">;</span>
        <span class="token keyword">if</span> blag <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">then</span>
            <span class="token keyword">leave</span> read_loop<span class="token punctuation">;</span>
        <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> supply_id1 <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">then</span>
            <span class="token keyword">set</span> count <span class="token operator">=</span> count <span class="token operator">+</span> amount1<span class="token punctuation">;</span>
        <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span>
    <span class="token keyword">end</span> <span class="token keyword">loop</span> read_loop<span class="token punctuation">;</span>
<span class="token keyword">end</span><span class="token punctuation">;</span>
$$
<span class="token keyword">delimiter</span> <span class="token punctuation">;</span>
<span class="token keyword">call</span> exchange<span class="token punctuation">(</span><span class="token variable">@count</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token variable">@count</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="存储过程优点"><a href="#存储过程优点" class="header-anchor">#</a> 存储过程优点</h4> <ol><li>第一点优势就是执行速度快。因为我们的每个 SQL 语句都需要经 过编译，然后再运行，但是存储过程都是直接编译好了之后，直接 运行即可。</li> <li>第二点优势就是减少网络流量。我们传输一个存储过程比我们传 输大量的 SQL 语句的开销要小得多。</li> <li>第三点优势就是提高系统安全性。因为存储过程可以使用权限控 制，而且参数化的存储过程可以有效地防止 SQL 注入攻击。保证了 其安全性。</li> <li>第四点优势就是耦合性降低。当我们的表结构发生了调整或变动 之后，我们可以修改相应的存储过程，我们的应用程序在一定程度 上需要改动的地方就较小了。 44 / 123</li> <li>第五点优势就是重用性强。因为我们写好一个存储过程之后，再 次调用它只需要一个名称即可，也就是”一次编写，随处调用”,而且 使用存储过程也可以让程序的模块化加强。</li></ol> <h4 id="_3-7-存储过程的缺点"><a href="#_3-7-存储过程的缺点" class="header-anchor">#</a> 3.7 存储过程的缺点</h4> <ol><li>第一个缺点就是移植性差。因为存储过程是和数据库绑定的，如 果我们要更换数据库之类的操作，可能很多地方需要改动。</li> <li>第二个缺点就是修改不方便。因为对于存储过程而言，我们并不 能特别有效的调试，它的一些 bug 可能发现的更晚一些，增加了应 用的危险性。</li> <li>第三个缺点就是优势不明显和赘余功能。对于小型 web 应用来说， 如果我们使用语句缓存，发现编译 SQL 的开销并不大，但是使用存 储过程却需要检查权限一类的开销，这些赘余功能也会在一定程度 上拖累性能。</li></ol> <h4 id="_3-8-php中的应用"><a href="#_3-8-php中的应用" class="header-anchor">#</a> 3.8 php中的应用</h4> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">require_once</span> <span class="token string single-quoted-string">'db.php'</span><span class="token punctuation">;</span>
<span class="token comment">// $sql = 'create procedure login_procedure_4 (in id int, out ret varchar(10))</span>
<span class="token comment">// begin</span>
<span class="token comment">//     declare y int default 0;</span>
<span class="token comment">//     select shop_name into ret from shop where uid = id;</span>
<span class="token comment">//     set ret = &quot;ttt&quot;;</span>
<span class="token comment">//   if y = 0 then</span>
<span class="token comment">//     set ret = &quot;xxxxx&quot;;</span>
<span class="token comment">//   end if;</span>
<span class="token comment">// end';</span>
<span class="token comment">// $db-&gt;execute($sql);</span>
<span class="token comment">// $sql = 'call login_procedure_3(87, @ret)';</span>
<span class="token comment">// var_dump($db-&gt;call($sql, 'select @ret'));</span>
<span class="token comment">// echo '成功';</span>

<span class="token comment">// 游标</span>
<span class="token comment">// 1. 声明</span>
<span class="token comment">/*
declare xxx

declare 游标名 cursor for 查询语句 [select xx,xx,x,x from table_name];
open 游标名 -- 打开
fetch 游标名 into xxx,

业务处理

close 游标名
 */</span>
 <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'
 create procedure login_procedure_5 (in id int, out ret varchar(10))
 begin
     declare id int default 0;
  -- 游标标识
  declare blag int default 1;
  declare name varchar(10) default 0;
     declare shop_cursor cursor for select shop_name,uid from shop;

  -- 异常处理 :注意游标在读取数据的时候,不断读取
  declare continue handler for not found set blag = 0;

  open shop_cursor; -- 打开

  read_loop:loop
    fetch shop_cursor into name,id;
    if blag = 0 then
      leave read_loop;
    end if;

    if id = 63 then
      set ret = name;
    end if;
  end loop read_loop;
 end'</span><span class="token punctuation">;</span>

 <span class="token comment">// $db-&gt;execute($sql);</span>
 <span class="token variable">$sql1</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'call login_procedure_5(87, @ret)'</span><span class="token punctuation">;</span>
 <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token operator">-&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token variable">$sql1</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'select @ret'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">echo</span> <span class="token string single-quoted-string">'成功'</span><span class="token punctuation">;</span>
 <span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h4 id="_3-9-小结"><a href="#_3-9-小结" class="header-anchor">#</a> 3.9 小结</h4> <ol><li>存储过程和函数的优势是可以将数据的处理放在数据库服务器上 进行，避免将大量的结果集传输给客户端，减少了数据的传输，因 此也减少了宽带和服务器的压力。</li> <li>但是在数据库服务器上进行大量的运算也会占用服务器的 CPU， 造成数据库服务器的压力。</li> <li>一般来说是不建议在存储过程中进行大量的复杂的运算的，它们 不是数据库服务器的强项，我们应该把这些操作让应用服务器去处 理。</li></ol> <h4 id="_3-10-例子"><a href="#_3-10-例子" class="header-anchor">#</a> 3.10 例子</h4> <p><img src="/blog/assets/img/2021-05-14-16-47-35.47b2ec21.png" alt=""></p> <p>可以尝试用存储过程实现一下不用在以数据量<br> <img src="/blog/assets/img/2021-05-14-16-47-42.7051988d.png" alt=""></p> <h2 id="_3-物化视图"><a href="#_3-物化视图" class="header-anchor">#</a> 3. 物化视图</h2> <p>物化视图是相对于视图而言的，但是两者实际上并没有什么关系就如java/javaScript一样</p> <p>首先mysql的视图不是一种物化视图，他相当于一个虚拟表，本身并不存储数据，当sql在操作视图时所有数据都是从其他表中查询出来的。者带来的问题是使用视图并不能将常用数据分离出来，优化查询速度，切操作视图的很多命令和普通标一样，这回导致在业务中无法通过sql区分表和视图，是代码变得复杂。</p> <p>视图是简化设计，清晰编码的东西，他并不是提高性能的，他的存在只会降低性能（如一个视图7个表关联，另一个视图8个表，程序员不知道，觉得很方便，把两个视图关联再做一个视图，那就惨了），他的存在未了在设计上的方便性</p> <p>物化视图可以帮助加快严重依赖某些聚合结果的查询。 如果插入速度不是问题，则此功能可以帮助减少系统上的读取负载。</p> <p>物化视图: 触发器, 存储过程, 变量</p> <p>创建一个实体的表 物化视图 表 记录: 查询的结果,</p> <p>查询 物化视图 表 ==&gt;聚合结果集</p> <p>数据: 实时性一致性 触发器 INSERT UPDATE DELTE 物化视图</p> <p>定时 对存储过程</p> <p>存储过程的应用: OA, ERP 对数据进行计算, 分析汇总,</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">5/21/2021, 1:25:38 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/数据库/Mysql/2物化视图-事务.html">
        物化视图-事务
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.3a2a0635.js" defer></script><script src="/blog/assets/js/3.21e2e031.js" defer></script><script src="/blog/assets/js/37.6c8b6e4d.js" defer></script>
  </body>
</html>
