<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基本操作之CRUD | 一名GO+PHP工程师</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/blog/assets/css/0.styles.b3aba94c.css" as="style"><link rel="preload" href="/blog/assets/js/app.d06cb661.js" as="script"><link rel="preload" href="/blog/assets/js/3.21e2e031.js" as="script"><link rel="preload" href="/blog/assets/js/155.ed89ea70.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.0db5da5f.js"><link rel="prefetch" href="/blog/assets/js/100.0ab1f3ab.js"><link rel="prefetch" href="/blog/assets/js/101.a8ccfd88.js"><link rel="prefetch" href="/blog/assets/js/102.0efc78d7.js"><link rel="prefetch" href="/blog/assets/js/103.adbd37a7.js"><link rel="prefetch" href="/blog/assets/js/104.161b590d.js"><link rel="prefetch" href="/blog/assets/js/105.eaae1ece.js"><link rel="prefetch" href="/blog/assets/js/106.9b961ba0.js"><link rel="prefetch" href="/blog/assets/js/107.df9ba599.js"><link rel="prefetch" href="/blog/assets/js/108.a5880443.js"><link rel="prefetch" href="/blog/assets/js/109.0dca298c.js"><link rel="prefetch" href="/blog/assets/js/11.896719ab.js"><link rel="prefetch" href="/blog/assets/js/110.91c6d5de.js"><link rel="prefetch" href="/blog/assets/js/111.4db6087d.js"><link rel="prefetch" href="/blog/assets/js/112.bb76db96.js"><link rel="prefetch" href="/blog/assets/js/113.9b314292.js"><link rel="prefetch" href="/blog/assets/js/114.b05dc902.js"><link rel="prefetch" href="/blog/assets/js/115.6a21a21a.js"><link rel="prefetch" href="/blog/assets/js/116.1fd8cdf3.js"><link rel="prefetch" href="/blog/assets/js/117.193b54e8.js"><link rel="prefetch" href="/blog/assets/js/118.d91f7ec2.js"><link rel="prefetch" href="/blog/assets/js/119.857d484f.js"><link rel="prefetch" href="/blog/assets/js/12.31b18145.js"><link rel="prefetch" href="/blog/assets/js/120.c2fc1bab.js"><link rel="prefetch" href="/blog/assets/js/121.5bda4d33.js"><link rel="prefetch" href="/blog/assets/js/122.af2613ff.js"><link rel="prefetch" href="/blog/assets/js/123.b7cb0f42.js"><link rel="prefetch" href="/blog/assets/js/124.c284df07.js"><link rel="prefetch" href="/blog/assets/js/125.8bba790f.js"><link rel="prefetch" href="/blog/assets/js/126.93757c80.js"><link rel="prefetch" href="/blog/assets/js/127.7e5150c1.js"><link rel="prefetch" href="/blog/assets/js/128.3498b329.js"><link rel="prefetch" href="/blog/assets/js/129.18a4e993.js"><link rel="prefetch" href="/blog/assets/js/13.b861bbee.js"><link rel="prefetch" href="/blog/assets/js/130.66047656.js"><link rel="prefetch" href="/blog/assets/js/131.0490c1bf.js"><link rel="prefetch" href="/blog/assets/js/132.9fd5bbe5.js"><link rel="prefetch" href="/blog/assets/js/133.d3b9807e.js"><link rel="prefetch" href="/blog/assets/js/134.6a6cf86d.js"><link rel="prefetch" href="/blog/assets/js/135.1132a9d3.js"><link rel="prefetch" href="/blog/assets/js/136.41c7a62b.js"><link rel="prefetch" href="/blog/assets/js/137.50106a44.js"><link rel="prefetch" href="/blog/assets/js/138.87124965.js"><link rel="prefetch" href="/blog/assets/js/139.e5597dd8.js"><link rel="prefetch" href="/blog/assets/js/14.507ab95b.js"><link rel="prefetch" href="/blog/assets/js/140.88de4f35.js"><link rel="prefetch" href="/blog/assets/js/141.85f894e1.js"><link rel="prefetch" href="/blog/assets/js/142.e385a422.js"><link rel="prefetch" href="/blog/assets/js/143.002698c9.js"><link rel="prefetch" href="/blog/assets/js/144.d9a69e4f.js"><link rel="prefetch" href="/blog/assets/js/145.95b58ec4.js"><link rel="prefetch" href="/blog/assets/js/146.0ff38d15.js"><link rel="prefetch" href="/blog/assets/js/147.1aad7186.js"><link rel="prefetch" href="/blog/assets/js/148.f24cd187.js"><link rel="prefetch" href="/blog/assets/js/149.0941e789.js"><link rel="prefetch" href="/blog/assets/js/15.977c5e43.js"><link rel="prefetch" href="/blog/assets/js/150.6514db42.js"><link rel="prefetch" href="/blog/assets/js/151.dcf981a0.js"><link rel="prefetch" href="/blog/assets/js/152.6a733b47.js"><link rel="prefetch" href="/blog/assets/js/153.5c3f3c49.js"><link rel="prefetch" href="/blog/assets/js/154.416cc51a.js"><link rel="prefetch" href="/blog/assets/js/156.e514afd4.js"><link rel="prefetch" href="/blog/assets/js/157.c01cdccb.js"><link rel="prefetch" href="/blog/assets/js/158.71dda3a8.js"><link rel="prefetch" href="/blog/assets/js/159.33fa138a.js"><link rel="prefetch" href="/blog/assets/js/16.6fa11a53.js"><link rel="prefetch" href="/blog/assets/js/160.41012461.js"><link rel="prefetch" href="/blog/assets/js/161.70993729.js"><link rel="prefetch" href="/blog/assets/js/162.a36e72f7.js"><link rel="prefetch" href="/blog/assets/js/163.35e7409e.js"><link rel="prefetch" href="/blog/assets/js/164.14f9bf58.js"><link rel="prefetch" href="/blog/assets/js/165.d4170a5d.js"><link rel="prefetch" href="/blog/assets/js/166.8eb8df1e.js"><link rel="prefetch" href="/blog/assets/js/167.b4296d08.js"><link rel="prefetch" href="/blog/assets/js/168.03f7c431.js"><link rel="prefetch" href="/blog/assets/js/169.2b833606.js"><link rel="prefetch" href="/blog/assets/js/17.02da0577.js"><link rel="prefetch" href="/blog/assets/js/170.b4639eea.js"><link rel="prefetch" href="/blog/assets/js/171.58868926.js"><link rel="prefetch" href="/blog/assets/js/172.253bc96e.js"><link rel="prefetch" href="/blog/assets/js/173.3ad021fe.js"><link rel="prefetch" href="/blog/assets/js/174.849bcbbd.js"><link rel="prefetch" href="/blog/assets/js/175.29aea4e3.js"><link rel="prefetch" href="/blog/assets/js/176.6e26a58e.js"><link rel="prefetch" href="/blog/assets/js/177.fb85b7c2.js"><link rel="prefetch" href="/blog/assets/js/178.7f4bf5e6.js"><link rel="prefetch" href="/blog/assets/js/18.c814f6a6.js"><link rel="prefetch" href="/blog/assets/js/19.931178d2.js"><link rel="prefetch" href="/blog/assets/js/2.aec18661.js"><link rel="prefetch" href="/blog/assets/js/20.94381428.js"><link rel="prefetch" href="/blog/assets/js/21.27a6dcf4.js"><link rel="prefetch" href="/blog/assets/js/22.d9c7ba8d.js"><link rel="prefetch" href="/blog/assets/js/23.00b0c454.js"><link rel="prefetch" href="/blog/assets/js/24.5f5891aa.js"><link rel="prefetch" href="/blog/assets/js/25.87af5ecb.js"><link rel="prefetch" href="/blog/assets/js/26.ba71a98d.js"><link rel="prefetch" href="/blog/assets/js/27.3b1f36b4.js"><link rel="prefetch" href="/blog/assets/js/28.26227207.js"><link rel="prefetch" href="/blog/assets/js/29.98c46495.js"><link rel="prefetch" href="/blog/assets/js/30.47d3f732.js"><link rel="prefetch" href="/blog/assets/js/31.c8b903eb.js"><link rel="prefetch" href="/blog/assets/js/32.763b7b98.js"><link rel="prefetch" href="/blog/assets/js/33.a689a6fc.js"><link rel="prefetch" href="/blog/assets/js/34.1089c1c5.js"><link rel="prefetch" href="/blog/assets/js/35.86d13f87.js"><link rel="prefetch" href="/blog/assets/js/36.77d3c045.js"><link rel="prefetch" href="/blog/assets/js/37.6c8b6e4d.js"><link rel="prefetch" href="/blog/assets/js/38.434945a5.js"><link rel="prefetch" href="/blog/assets/js/39.0324fbbf.js"><link rel="prefetch" href="/blog/assets/js/4.3e9c545c.js"><link rel="prefetch" href="/blog/assets/js/40.f3ba0aed.js"><link rel="prefetch" href="/blog/assets/js/41.27044d8f.js"><link rel="prefetch" href="/blog/assets/js/42.1fd5a43b.js"><link rel="prefetch" href="/blog/assets/js/43.451622f4.js"><link rel="prefetch" href="/blog/assets/js/44.5b40696f.js"><link rel="prefetch" href="/blog/assets/js/45.3dcc7c91.js"><link rel="prefetch" href="/blog/assets/js/46.0bd04509.js"><link rel="prefetch" href="/blog/assets/js/47.59ab9778.js"><link rel="prefetch" href="/blog/assets/js/48.e3917371.js"><link rel="prefetch" href="/blog/assets/js/49.cffe09bd.js"><link rel="prefetch" href="/blog/assets/js/5.548a74f6.js"><link rel="prefetch" href="/blog/assets/js/50.10849ea7.js"><link rel="prefetch" href="/blog/assets/js/51.29fb5c68.js"><link rel="prefetch" href="/blog/assets/js/52.d2042f8d.js"><link rel="prefetch" href="/blog/assets/js/53.8a5c3d60.js"><link rel="prefetch" href="/blog/assets/js/54.0f846846.js"><link rel="prefetch" href="/blog/assets/js/55.f1fdd6ae.js"><link rel="prefetch" href="/blog/assets/js/56.c2bf89f1.js"><link rel="prefetch" href="/blog/assets/js/57.93329ad3.js"><link rel="prefetch" href="/blog/assets/js/58.ddd651ef.js"><link rel="prefetch" href="/blog/assets/js/59.ad2296e2.js"><link rel="prefetch" href="/blog/assets/js/6.c31c16f8.js"><link rel="prefetch" href="/blog/assets/js/60.92d4a127.js"><link rel="prefetch" href="/blog/assets/js/61.2fe87550.js"><link rel="prefetch" href="/blog/assets/js/62.24bf6999.js"><link rel="prefetch" href="/blog/assets/js/63.2f87f55d.js"><link rel="prefetch" href="/blog/assets/js/64.68cd3b45.js"><link rel="prefetch" href="/blog/assets/js/65.b2920db4.js"><link rel="prefetch" href="/blog/assets/js/66.18d74400.js"><link rel="prefetch" href="/blog/assets/js/67.ac26e1fe.js"><link rel="prefetch" href="/blog/assets/js/68.b6f86cb6.js"><link rel="prefetch" href="/blog/assets/js/69.134a204b.js"><link rel="prefetch" href="/blog/assets/js/7.9e783835.js"><link rel="prefetch" href="/blog/assets/js/70.d56e0998.js"><link rel="prefetch" href="/blog/assets/js/71.e8314430.js"><link rel="prefetch" href="/blog/assets/js/72.78fc6941.js"><link rel="prefetch" href="/blog/assets/js/73.2bacb1ea.js"><link rel="prefetch" href="/blog/assets/js/74.3c8755ec.js"><link rel="prefetch" href="/blog/assets/js/75.36ca899a.js"><link rel="prefetch" href="/blog/assets/js/76.a0981293.js"><link rel="prefetch" href="/blog/assets/js/77.de031445.js"><link rel="prefetch" href="/blog/assets/js/78.b41b3078.js"><link rel="prefetch" href="/blog/assets/js/79.f314f893.js"><link rel="prefetch" href="/blog/assets/js/8.5c76926d.js"><link rel="prefetch" href="/blog/assets/js/80.389c0b37.js"><link rel="prefetch" href="/blog/assets/js/81.04f50a1e.js"><link rel="prefetch" href="/blog/assets/js/82.db879ca5.js"><link rel="prefetch" href="/blog/assets/js/83.e89b8863.js"><link rel="prefetch" href="/blog/assets/js/84.07410b58.js"><link rel="prefetch" href="/blog/assets/js/85.d3e35fad.js"><link rel="prefetch" href="/blog/assets/js/86.52351591.js"><link rel="prefetch" href="/blog/assets/js/87.c4ebf9a8.js"><link rel="prefetch" href="/blog/assets/js/88.09fc332a.js"><link rel="prefetch" href="/blog/assets/js/89.8b302469.js"><link rel="prefetch" href="/blog/assets/js/9.a64cd1e6.js"><link rel="prefetch" href="/blog/assets/js/90.391f76ed.js"><link rel="prefetch" href="/blog/assets/js/91.d1662d38.js"><link rel="prefetch" href="/blog/assets/js/92.a65aa479.js"><link rel="prefetch" href="/blog/assets/js/93.bc850b53.js"><link rel="prefetch" href="/blog/assets/js/94.7dc858d7.js"><link rel="prefetch" href="/blog/assets/js/95.6755e920.js"><link rel="prefetch" href="/blog/assets/js/96.7e3abf55.js"><link rel="prefetch" href="/blog/assets/js/97.16a7a60a.js"><link rel="prefetch" href="/blog/assets/js/98.a84fee2e.js"><link rel="prefetch" href="/blog/assets/js/99.c4b1cfd7.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b3aba94c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">一名GO+PHP工程师</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://gitee.com/ColinWWL/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://gitee.com/ColinWWL/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/blog/数据库/Mongodb/1基本操作之CRUD" class="sidebar-heading clickable open active"><span>Mongodb</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html" class="active sidebar-link">基本操作之CRUD</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#创建文档" class="sidebar-link">创建文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#insertone" class="sidebar-link">insertOne</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#insertmany" class="sidebar-link">insertMany</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#insert" class="sidebar-link">insert</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#查询文档" class="sidebar-link">查询文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#读取全部文档" class="sidebar-link">读取全部文档</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#匹配查询" class="sidebar-link">匹配查询</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#复合主键查询" class="sidebar-link">复合主键查询</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#操作符" class="sidebar-link">操作符</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#游标" class="sidebar-link">游标</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#文档投影" class="sidebar-link">文档投影</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#更新操作" class="sidebar-link">更新操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#文档更新操作符" class="sidebar-link">文档更新操作符</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#数组更新操作符" class="sidebar-link">数组更新操作符</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#更新操作符" class="sidebar-link">更新操作符</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#更新文档选项" class="sidebar-link">更新文档选项</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#原子性" class="sidebar-link">原子性</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#删除命令" class="sidebar-link">删除命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#删除文档" class="sidebar-link">删除文档</a></li><li class="sidebar-sub-header"><a href="/blog/数据库/Mongodb/1基本操作之CRUD.html#删除集合" class="sidebar-link">删除集合</a></li></ul></li></ul></li><li><a href="/blog/数据库/Mongodb/2centos7安装mongodb和设置开机自动启动.html" class="sidebar-link">centos7安装mongodb和设置开机自动启动</a></li><li><a href="/blog/数据库/Mongodb/3mongodb添加账号密码.html" class="sidebar-link">添加账号密码</a></li><li><a href="/blog/数据库/Mongodb/4MongoDB之分片集群与复制集.html" class="sidebar-link">分片集群</a></li><li><a href="/blog/数据库/Mongodb/5MongoDB-分片片键.html" class="sidebar-link">分片片键</a></li><li><a href="/blog/数据库/Mongodb/6MongoDB中各种类型的索引.html" class="sidebar-link">MongoDB中各种类型的索引</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="基本操作之crud"><a href="#基本操作之crud" class="header-anchor">#</a> 基本操作之CRUD</h1> <h2 id="创建文档"><a href="#创建文档" class="header-anchor">#</a> 创建文档</h2> <p>命令有三种:</p> <div class="language- extra-class"><pre class="language-text"><code>创建单个文档：db.collection.insertOne()
创建单个或多个文档：db.collection.insert()
创建多个文档：db.collection.insertMany()
</code></pre></div><h3 id="insertone"><a href="#insertone" class="header-anchor">#</a> insertOne</h3> <p>示例：</p> <div class="language- extra-class"><pre class="language-text"><code>db.goods.insertOne({
	name:&quot;哈士奇饼干&quot;,
	price:33,
})
</code></pre></div><p>返回结果：</p> <div class="language- extra-class"><pre class="language-text"><code>{
    &quot;acknowledged&quot;: true,
    &quot;insertedId&quot;: ObjectId(&quot;5e9c52e32a170000ea003e5a&quot;) //5e9c544c2a170000ea003e5b为本次插入数据的主键id
}
</code></pre></div><p>插入复合主键</p> <div class="language- extra-class"><pre class="language-text"><code>db.goods.insertOne({
    _id:{id:123,type:'shop'},
	name:&quot;这个是复合组件&quot;,
	price:20.58,
})
</code></pre></div><h3 id="insertmany"><a href="#insertmany" class="header-anchor">#</a> insertMany</h3> <p>示例：</p> <div class="language- extra-class"><pre class="language-text"><code>db.goods.insertMany([
	{name:&quot;哈士奇饼干1&quot;,price:33,},
	{name:&quot;神奇宝贝一只1&quot;,stock:100,price:20.58,}
])
</code></pre></div><p>返回结果：</p> <div class="language- extra-class"><pre class="language-text"><code>{
    &quot;acknowledged&quot;: true,
    &quot;insertedIds&quot;: [
        ObjectId(&quot;5e9c56b72a170000ea003e5d&quot;),
        ObjectId(&quot;5e9c56b72a170000ea003e5e&quot;)
    ]
}
</code></pre></div><h3 id="insert"><a href="#insert" class="header-anchor">#</a> insert</h3> <p>示例：</p> <div class="language- extra-class"><pre class="language-text"><code>db.goods.insert([
	{name:&quot;哈士奇饼干1&quot;,price:33,},
	{name:&quot;神奇宝贝一只1&quot;,stock:100,price:20.58,}
])
</code></pre></div><p>返回结果：</p> <div class="language- extra-class"><pre class="language-text"><code>BulkWriteResult({
	&quot;nRemoved&quot; : 0,
	&quot;nInserted&quot; : 2, //插入成功的数量
	&quot;nUpserted&quot; : 0,
	&quot;nMatched&quot; : 0,
	&quot;nModified&quot; : 0,
	&quot;writeErrors&quot; : [ ]
})
</code></pre></div><h2 id="查询文档"><a href="#查询文档" class="header-anchor">#</a> 查询文档</h2> <h3 id="读取全部文档"><a href="#读取全部文档" class="header-anchor">#</a> 读取全部文档</h3> <p>既不筛选，也不投射</p> <div class="language- extra-class"><pre class="language-text"><code>db.collection.find();
</code></pre></div><p>示例:</p> <div class="language- extra-class"><pre class="language-text"><code>db.goods.find();
</code></pre></div><p>返回结果:</p> <div class="language- extra-class"><pre class="language-text"><code>// 1
{
    &quot;_id&quot;: ObjectId(&quot;5e9c48b42a170000ea003e45&quot;),
    &quot;name&quot;: &quot;纸巾一包&quot;,
    &quot;price&quot;: 100
}

// 2
{
    &quot;_id&quot;: ObjectId(&quot;5e9c48eb2a170000ea003e48&quot;),
    &quot;name&quot;: &quot;奶茶一杯&quot;,
    &quot;price&quot;: 20.58
}

// 3
{
    &quot;_id&quot;: ObjectId(&quot;5e9c56b72a170000ea003e5d&quot;),
    &quot;name&quot;: &quot;哈士奇饼干1&quot;,
    &quot;price&quot;: 33
}
</code></pre></div><h3 id="匹配查询"><a href="#匹配查询" class="header-anchor">#</a> 匹配查询</h3> <p>示例：</p> <div class="language- extra-class"><pre class="language-text"><code>//查询名字为&quot;纸巾一包&quot;并且价格为100元的数据
db.goods.find({name:&quot;纸巾一包&quot;,price:100})
</code></pre></div><p>返回结果</p> <div class="language- extra-class"><pre class="language-text"><code>{
    &quot;_id&quot;: ObjectId(&quot;5e9c48b42a170000ea003e45&quot;),
    &quot;name&quot;: &quot;纸巾一包&quot;,
    &quot;price&quot;: 100
}
</code></pre></div><h3 id="复合主键查询"><a href="#复合主键查询" class="header-anchor">#</a> 复合主键查询</h3> <div class="language- extra-class"><pre class="language-text"><code>db.goods.find({&quot;_id.type&quot;:&quot;shop&quot;})
</code></pre></div><h3 id="操作符"><a href="#操作符" class="header-anchor">#</a> 操作符</h3> <h4 id="比较操作符"><a href="#比较操作符" class="header-anchor">#</a> 比较操作符</h4> <p>{:{$:}}<br>
$eq 匹配字段值相等的文档 （可以用于string和int类型） =<br>
$ne 匹配字段值不等的文档 !=<br>
$gt 匹配字段值大于查询值的文档 &gt;<br>
$gte 匹配字段值大于或等于查询值的文档 &gt;=<br>
$lt 匹配字段值小于查询值的文档 &lt;<br>
$lte 匹配字段值小于或等于查询值的文档 &lt;=<br>
$in 匹配字段值与任意查询值相等的文档 “in”<br>
$nin 匹配字段值与任意查询值不相等的文档 “not in”</p> <div class="language- extra-class"><pre class="language-text"><code>//匹配查询
db.goods.find({name:{$eq:&quot;纸巾一包&quot;}})
//in查询
db.goods.find({&quot;name&quot;:{$in:[&quot;纸巾一包&quot;,&quot;奶茶一杯&quot;]}})
//读取价格大于32元且小于101元的商品
db.goods.find({price:{$gt:32,$lt:101}})
//复合组件查询
db.goods.find({&quot;_id.type&quot;:{$eq:&quot;shop&quot;}})
db.goods.find({&quot;_id.type&quot;:{$in:[&quot;shop&quot;]}})
</code></pre></div><h4 id="逻辑操作符"><a href="#逻辑操作符" class="header-anchor">#</a> 逻辑操作符</h4> <p>$not 匹配筛选条件不成立的文档<br>
$and 匹配多个筛选条件全部成立的文档<br>
$or 匹配至少一个筛选条件成立的文档<br>
$nor 匹配多个筛选条件全部不成立的文档<br>
逻辑运算符示例：</p> <div class="language- extra-class"><pre class="language-text"><code>//查询价格不小于32元的商品
db.goods.find({price:{$not:{$lt:32}}})
//相当于下面的取反
db.goods.find({price:{$lt:32}})
//获取价格为100，并且名称为&quot;纸巾一包&quot;的商品
db.goods.find({
	$and:[
		{price:{$eq:100}},
		{name:&quot;纸巾一包&quot;}
	]
})
//可以简写如下
db.goods.find({price:{$eq:100},name:&quot;纸巾一包&quot;})
//获取价格不是100，并且名称不为&quot;纸巾一包&quot;的商品
db.goods.find({
	$nor:[
		{price:{$eq:100}},
		{name:&quot;纸巾一包&quot;}
	]
})
注意：nor也会筛选出并不包含查询字段的文档！！比如会把没有price和name字段的文档也查出来！
</code></pre></div><h4 id="字段操作符"><a href="#字段操作符" class="header-anchor">#</a> 字段操作符</h4> <div class="language- extra-class"><pre class="language-text"><code>$exists 匹配包含查询字段的文档  
$type 匹配字段符合查询值的文档
</code></pre></div><p><strong>$type对应的类型和BSON类型序号</strong></p> <div class="language- extra-class"><pre class="language-text"><code>Double	1	 
String	2	 
Object	3	 
Array	4	 
Binary data	5	 
Undefined	6	已废弃。
Object id	7	 
Boolean	8	 
Date	9	 
Null	10	 
Regular Expression	11	 
JavaScript	13	 
Symbol	14	 
JavaScript (with scope)	15	 
32-bit integer	16	 
Timestamp	17	 
64-bit integer	18	 
Min key	255	Query with -1.
Max key	127
</code></pre></div><p>示例</p> <div class="language- extra-class"><pre class="language-text"><code>//查询复合主键中存在type字段的数据
db.goods.find({&quot;_id.type&quot;:{$exists:true}})
//查询存在name字段的数据
db.goods.find({name:{$exists:true}})
//查询类型为普通主键和复合主键的数据
db.goods.find({_id:{$type:[&quot;objectId&quot;,&quot;object&quot;]}})
//查询类型为string的数据
db.goods.find({name:{$type:[&quot;string&quot;]}})
</code></pre></div><h4 id="数组操作符"><a href="#数组操作符" class="header-anchor">#</a> 数组操作符</h4> <div class="language- extra-class"><pre class="language-text"><code>$all 匹配数组字段中包含所有查询值的文档
$elemMatch 匹配数组字段中至少存在一个值满足筛选条件的文档
</code></pre></div><p>示例</p> <div class="language- extra-class"><pre class="language-text"><code>先插入数据
db.goods.insert(
	[
		{
		    name:&quot;皮卡丘一只&quot;,
			price:100,
			contact:[&quot;111111&quot;,&quot;Alabama&quot;,&quot;US&quot;]
		},
		{
		    name:&quot;小火龙一只&quot;,
			price:120,
			contact:[[&quot;222222&quot;,&quot;333333&quot;],&quot;Beijing&quot;,&quot;China&quot;]
		}
	]
)
//查询contact字段中同时包含&quot;China&quot;和&quot;Beijing&quot;字段的文档
db.goods.find({contact:{$all:[&quot;China&quot;,&quot;Beijing&quot;]}})
//查询联系方式中包含&quot;222222&quot;,&quot;333333&quot;的文档，注意，这里的数组如果只有&quot;222222&quot;是查询不到的，这里是数组全等的关系
db.goods.find({contact:{$all:[[&quot;222222&quot;,&quot;333333&quot;]]}})
//查询电话号码范围在大于111110和小于222222之间的数据
db.goods.find({contact:{$elemMatch:{$gt:&quot;111110&quot;,$lt:&quot;222222&quot;}}})
//查询电话号码范围在&quot;大于111110和小于222222之间&quot;并且&quot;大于211111和小于444444之间&quot;的数据
db.goods.find({
	contact:{$all:[
		{$elemMatch:{$gt:&quot;111111&quot;,$lt:&quot;222222&quot;}},
		{$elemMatch:{$gt:&quot;211111&quot;,$lt:&quot;444444&quot;}}
	]}
})
</code></pre></div><h4 id="运算操作符"><a href="#运算操作符" class="header-anchor">#</a> 运算操作符</h4> <div class="language- extra-class"><pre class="language-text"><code>{&lt;field&gt;:{:/pattern/,:'&lt;options&gt;'}}
{&lt;field&gt;:{:/pattern/&lt;options&gt;}}
$regex  
在和$in操作符一起使用时，只能使用/pattern/&lt;options&gt;
//读取name字段以&quot;皮&quot;或&quot;j&quot;开头的文档数据
db.goods.find({name:{$in:[/^皮/,/^j/]}})

//读取name字段包含LIE（不区分大小写）的文档数据
db.goods.find({name:{$regex:/LIE/,$options:'i'}})
</code></pre></div><h3 id="游标"><a href="#游标" class="header-anchor">#</a> 游标</h3> <p>游历完游标中所有文档之后，或者在10分钟之后，游标便会自动关闭<br>
可以使用noCursorTimeout()函数来保持游标一直有效</p> <div class="language- extra-class"><pre class="language-text"><code>var myCursor=db.goods.find().noCursorTimeout()
</code></pre></div><p>在这之后，在不遍历游标的情况下，你需要主动关闭游标</p> <div class="language- extra-class"><pre class="language-text"><code>myCursor.close()
</code></pre></div><h4 id="游标函数"><a href="#游标函数" class="header-anchor">#</a> 游标函数</h4> <div class="language- extra-class"><pre class="language-text"><code>cursor.hasNext() //当还有没遍历完的游标文档时，返回true
cursor.next()  //获取下一次遍历的游标文档
cursor.forEach(&lt;function&gt;) //遍历游标中所有指向的文档
cursor.limit(&lt;number&gt;)  //返回指定条数
cursor.skip(&lt;offest&gt;) //跳过文档中指定数量的文档（传入1表示跳过第一篇文档）
cursor.count(&lt;applySkipLimit&gt;) //默认情况下，&lt;applySkipLimit&gt;为false，即cursor.count()不会考虑cursor.skip()和cursor.limit()的效果
cursor.sort(&lt;document&gt;)  //这里的&lt;document&gt;定义了排序的要求（1从小到大排序，-1从大到小排序）
var myCursor=db.goods.find();
while(myCursor.hasNext()){
	printjson(myCursor.next());
}


var myCursor=db.goods.find();
myCursor.forEach(printjson)
db.goods.find().limit(1)
db.goods.find().skip(1)

db.goods.find().limit(1).count() //返回所有文档总数
db.goods.find().limit(1).count(true) //返回一篇文档
//price字段从大到小排序，并且name字段由小到大排序 （相当于mysql中同时两个排序条件的规则）
db.goods.find().sort({price:-1,name:1})
</code></pre></div><p><strong>注意事项<br>
cursor.skip(),cursor.limit(),cursor.count()<br>
优先级：count()-&gt;skip()-&gt;limit()</strong></p> <div class="language- extra-class"><pre class="language-text"><code>cursor.skip()在cursor.limit()之前执行
db.goods.find().limit(5).skip(3)
结果返回的是5篇文章，从第4篇到第9篇文章
cursor.count()在cursor.skip()和cursor.limit()之前执行
db.goods.find().limit(5).skip(3).sort({price:-1})
</code></pre></div><h3 id="文档投影"><a href="#文档投影" class="header-anchor">#</a> 文档投影</h3> <div class="language- extra-class"><pre class="language-text"><code>db.goods.find(&lt;query&gt;,&lt;projection&gt;)
不使用投影时，db.goods.find()返回符合筛选条件的完整文档
使用投影可以只返回指定的字段
{field:inclusion}
1表示返回部分字段，0表示不返回字段，（1和0不可组合使用，_id字段除外）
//只返回name字段
db.goods.find({},{name:1,_id:0})
//返回除name之外的字段
db.goods.find({},{name:0})
//$slide:2,表示返回前2条，-2表示返回倒数2条，[1,2]表示返回第二条到第三条
db.goods.find({},{name:1,content:{$slide:[1,2]}})
</code></pre></div><p><strong>$elemMatch和$操作符可以返回数组字段中满足筛选条件的第一个元素</strong></p> <div class="language- extra-class"><pre class="language-text"><code>//返回content数组字段中第一个排序大于&quot;Alabama&quot;的数据，（没content字段的文档也会被返回）
db.goods.find({},{name:1,content:{$elemMatch:{$gt:&quot;Alabama&quot;}}})

//返回content数组字段中第一个排序大于&quot;Alabama&quot;的数据
db.goods.find({content:{$gt:&quot;Alabama&quot;}},{name:1,&quot;content.$&quot;:1,})
</code></pre></div><h2 id="更新操作"><a href="#更新操作" class="header-anchor">#</a> 更新操作</h2> <p>注意：<br>
1、<br>
db.goods.update(where查询条件,更新的值,其它条件)<br>
db.goods.update({“uid”:3},{$rename:{“name”:”alias”}},{multi:true})<br>
2、文档更新操作只会更新一篇文档，即使条件符合多篇文档，也只会更新一篇，如果想要更新所有符合条件的文档，需要添加第三个参数**{multi:true}**</p> <h3 id="文档更新操作符"><a href="#文档更新操作符" class="header-anchor">#</a> 文档更新操作符</h3> <div class="language- extra-class"><pre class="language-text"><code>$set 更新或新增字段
$unset 删除字段
$rename 重命名字段 {$rename:{&lt;field1&gt;:&lt;newName1&gt;,&lt;field2&gt;:&lt;newName2&gt;}}
$inc 加减字段值  (字段不存在时，会默认创建且值为加减的值)
$mul 相乘字段值 (字段不存在时，会默认创建且值为0 )
$min 比较减少字段值 (保留最小的值)(字段不存在会自动创建且值为指定的值)(类型不一致按BSON数据类型排序规则比较)
$max 比较增大字段值 (保留最大的值)(字段不存在会自动创建且值为指定的值)(类型不一致按BSON数据类型排序规则比较)
//（$rename）重命名写法
db.goods.update({&quot;uid&quot;:3},{$rename:{&quot;name&quot;:&quot;alias&quot;}})
//（$rename）将数组字段content中的name字段迁移到最外面的name字段
db.goods.update({&quot;uid&quot;:3},{$rename:{&quot;content.name&quot;:&quot;name&quot;}})
//（$rename）将最外面的name字段迁移到数组字段content中的name字段
db.goods.update({&quot;uid&quot;:3},{$rename:{&quot;name&quot;:&quot;content.name&quot;}})
//（$inc）将条件uid=3的文档，price字段加一
db.goods.update({&quot;uid&quot;:3},{$inc:{&quot;price&quot;:1}})
//（$min）源字段大于50时，修改成50
db.goods.update({&quot;uid&quot;:3},{$min:{&quot;price&quot;:50}}) （源price值为30时，不变，保留30）
BSON数据类型排序规则
最小
	Null
	Numbers(ints,longs,doubles,decimals)
    Symbol,String
	Object
	Array
	BinData
	ObjectId
	Boolean
	Date
最大
	Regular Expression
</code></pre></div><h3 id="数组更新操作符"><a href="#数组更新操作符" class="header-anchor">#</a> 数组更新操作符</h3> <div class="language- extra-class"><pre class="language-text"><code>$addToSet 向数组中增添元素
$pop 从数组中移除元素
$pull 从数组中移除指定元素
$pullAll 从数组中有选择性地移除元素
$push 向数组中增添元素
//($addToSet)将content数组字段添加&quot;nihao&quot;,&quot;wohao&quot;两个值
db.goods.update({&quot;uid&quot;:3},{$addToSet:{&quot;content&quot;:{$each:[&quot;nihao&quot;,&quot;wohao&quot;]}}})
//$pull删除content数组中包含&quot;皮&quot;字的字段
db.goods.update({&quot;uid&quot;:3},{$pull:{&quot;content&quot;:{$regex:/皮/}}})
{$pullAll:{&lt;field&gt;:[&lt;vaule1&gt;,&lt;vaule2&gt;]}}
相当于
{$pull:{&lt;field&gt;:{$in:[&lt;vaule1&gt;,&lt;vaule2&gt;]}}}
</code></pre></div><h3 id="更新操作符"><a href="#更新操作符" class="header-anchor">#</a> 更新操作符</h3> <div class="language- extra-class"><pre class="language-text"><code>$ 第一个符合条件的占位符
$[] 数组中的所有元素
</code></pre></div><p><strong>更新数组中的特定元素<br>
$是数组中第一个符合筛选条件的数组元素的占位符，搭配更新操作符使用，可以对满足筛选条件的数组元素进行更新</strong></p> <div class="language- extra-class"><pre class="language-text"><code>db.goods.update({&lt;array&gt;:&lt;query selector&gt;},&lt;update operator&gt;:{&quot;&lt;array&gt;.$&quot;,vaule})
</code></pre></div><p>$[]指代数组字段中的所有元素，搭配更新操作符使用，可以对数组中的所有元素进行更新</p> <div class="language- extra-class"><pre class="language-text"><code>db.goods.update({&lt;array&gt;:&lt;query selector&gt;},&lt;update operator&gt;:{&quot;&lt;array&gt;.$[]&quot;,vaule})
//源数据
{
    &quot;_id&quot;: ObjectId(&quot;5e9f08904757000020000235&quot;),
    &quot;content&quot;: [
        &quot;nihao&quot;,
        &quot;我很好&quot;
    ],
    &quot;uid&quot;: 3,
    &quot;name&quot;: &quot;nihao&quot;,
    &quot;num&quot;: 1,
    &quot;num1&quot;: 0
}
//将content数组中值为&quot;nihao&quot;的替换成&quot;updated&quot;
db.goods.update({
    uid:3,
	content:&quot;nihao&quot;
}, {
    $set: {
        &quot;content.$&quot;:&quot;updated&quot;
    }
})
将content数组中所有字段替换成&quot;updated&quot;
db.goods.update({
    uid:3
}, {
    $set: {
        &quot;content.$[]&quot;:&quot;updated&quot;
    }
})
</code></pre></div><h3 id="更新文档选项"><a href="#更新文档选项" class="header-anchor">#</a> 更新文档选项</h3> <p>{multi:}<br>
更新多个文档<br>
到目前为止，我们在update命令中使用的筛选条件只对应一篇文档<br>
在默认情况下，即使筛选条件对应了多篇文档，update命令仍然只会更新一篇文档</p> <div class="language- extra-class"><pre class="language-text"><code>将所有name值为&quot;nihao&quot;的文档num值改成10
db.goods.update({
    name:&quot;nihao&quot;
}, {$set: {&quot;num&quot;:10}},{multi:true})
</code></pre></div><h3 id="原子性"><a href="#原子性" class="header-anchor">#</a> 原子性</h3> <div class="language- extra-class"><pre class="language-text"><code>在MongoDB中，更新单个的文档操作是原子性的。默认情况下，如果一个update()更新多个文档，那么对每个文档的更新是原子性的，但是对整个update而言则不是原子性的。有可能存在前一个文档更新成功，后面的文档更新失败的情况。由于单个文档的更新是原子性的，如果两个更新同时发生，就会出现阻塞，先到的先执行，所以文档最终结果由靠后的操作决定。
**简单的说就是对同一篇文档进行更新，文档最终结果以最后的更新操作为结果**
</code></pre></div><h2 id="删除命令"><a href="#删除命令" class="header-anchor">#</a> 删除命令</h2> <div class="language- extra-class"><pre class="language-text"><code>db.collection.remove() 删除文档
db.collection.drop() 删除集合
</code></pre></div><p>注：<br>
1、删除文档默认是删除所有符合条件的文档，和update操作不一样，如果需要指定只删除一篇文档，加上第二个参数**（{justOne:true}）**</p> <h3 id="删除文档"><a href="#删除文档" class="header-anchor">#</a> 删除文档</h3> <div class="language- extra-class"><pre class="language-text"><code>db.&lt;collection&gt;.remove(&lt;query&gt;,&lt;options&gt;)
&lt;options&gt;声明了一些删除操作的参数

db.goods.remove()
//删除name值为&quot;nihao&quot;的所有文档
db.goods.remove({name:&quot;nihao&quot;})
//删除name值为&quot;nihao&quot;的一篇文档（{justOne:true}）
db.goods.remove({name:&quot;nihao&quot;},{justOne:true})
//删除集合内的所有文档
db.goods.remove({})
</code></pre></div><h3 id="删除集合"><a href="#删除集合" class="header-anchor">#</a> 删除集合</h3> <div class="language- extra-class"><pre class="language-text"><code>db.&lt;collection&gt;.drop(&lt;writeConcern&gt;,&lt;document&gt;)
db.goods.drop()
</code></pre></div><p>这里的writeConcern文档定义了本次集合删除操作的安全写级别、<br>
drop命令可以删除整个集合，包括集合中的所有文档，以及集合的索引</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">5/21/2021, 1:25:38 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/数据库/Mongodb/2centos7安装mongodb和设置开机自动启动.html">
        centos7安装mongodb和设置开机自动启动
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.d06cb661.js" defer></script><script src="/blog/assets/js/3.21e2e031.js" defer></script><script src="/blog/assets/js/155.ed89ea70.js" defer></script>
  </body>
</html>
