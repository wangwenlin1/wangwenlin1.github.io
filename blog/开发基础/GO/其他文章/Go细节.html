<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Go细节 | 一名GO+PHP工程师</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/blog/assets/css/0.styles.b3aba94c.css" as="style"><link rel="preload" href="/blog/assets/js/app.5a38db11.js" as="script"><link rel="preload" href="/blog/assets/js/3.21e2e031.js" as="script"><link rel="preload" href="/blog/assets/js/106.028ce766.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.cc3bb372.js"><link rel="prefetch" href="/blog/assets/js/100.35b5db36.js"><link rel="prefetch" href="/blog/assets/js/101.a70b97e2.js"><link rel="prefetch" href="/blog/assets/js/102.30af4d63.js"><link rel="prefetch" href="/blog/assets/js/103.c5c5130e.js"><link rel="prefetch" href="/blog/assets/js/104.161b590d.js"><link rel="prefetch" href="/blog/assets/js/105.eaae1ece.js"><link rel="prefetch" href="/blog/assets/js/107.c9b230ac.js"><link rel="prefetch" href="/blog/assets/js/108.a5880443.js"><link rel="prefetch" href="/blog/assets/js/109.bab44539.js"><link rel="prefetch" href="/blog/assets/js/11.ef5dbacc.js"><link rel="prefetch" href="/blog/assets/js/110.7ba602f1.js"><link rel="prefetch" href="/blog/assets/js/111.2b0b0a78.js"><link rel="prefetch" href="/blog/assets/js/112.6b9220f5.js"><link rel="prefetch" href="/blog/assets/js/113.6a2724aa.js"><link rel="prefetch" href="/blog/assets/js/114.ac347ea2.js"><link rel="prefetch" href="/blog/assets/js/115.17c6c526.js"><link rel="prefetch" href="/blog/assets/js/116.1fd8cdf3.js"><link rel="prefetch" href="/blog/assets/js/117.193b54e8.js"><link rel="prefetch" href="/blog/assets/js/118.8a3e18a9.js"><link rel="prefetch" href="/blog/assets/js/119.2a5bb73a.js"><link rel="prefetch" href="/blog/assets/js/12.2003a6c5.js"><link rel="prefetch" href="/blog/assets/js/120.edb5435e.js"><link rel="prefetch" href="/blog/assets/js/121.6e61cfa4.js"><link rel="prefetch" href="/blog/assets/js/122.8ce24886.js"><link rel="prefetch" href="/blog/assets/js/123.beccf42c.js"><link rel="prefetch" href="/blog/assets/js/124.416ddc09.js"><link rel="prefetch" href="/blog/assets/js/125.7be39e4f.js"><link rel="prefetch" href="/blog/assets/js/126.49439b56.js"><link rel="prefetch" href="/blog/assets/js/127.7d06eb7f.js"><link rel="prefetch" href="/blog/assets/js/128.9b247099.js"><link rel="prefetch" href="/blog/assets/js/129.6503c09f.js"><link rel="prefetch" href="/blog/assets/js/13.93951a43.js"><link rel="prefetch" href="/blog/assets/js/130.3fa988b7.js"><link rel="prefetch" href="/blog/assets/js/131.f93ef260.js"><link rel="prefetch" href="/blog/assets/js/132.7dca0041.js"><link rel="prefetch" href="/blog/assets/js/133.286b95ad.js"><link rel="prefetch" href="/blog/assets/js/134.88627057.js"><link rel="prefetch" href="/blog/assets/js/135.a28b714b.js"><link rel="prefetch" href="/blog/assets/js/136.fba0a306.js"><link rel="prefetch" href="/blog/assets/js/137.5540419d.js"><link rel="prefetch" href="/blog/assets/js/138.82fb7775.js"><link rel="prefetch" href="/blog/assets/js/139.787b1320.js"><link rel="prefetch" href="/blog/assets/js/14.379e0027.js"><link rel="prefetch" href="/blog/assets/js/140.b68497e2.js"><link rel="prefetch" href="/blog/assets/js/141.cd76190b.js"><link rel="prefetch" href="/blog/assets/js/142.8e56d4f0.js"><link rel="prefetch" href="/blog/assets/js/143.23971a8d.js"><link rel="prefetch" href="/blog/assets/js/144.8c41b407.js"><link rel="prefetch" href="/blog/assets/js/145.95b58ec4.js"><link rel="prefetch" href="/blog/assets/js/146.18132cf9.js"><link rel="prefetch" href="/blog/assets/js/147.8275026a.js"><link rel="prefetch" href="/blog/assets/js/148.cc2257d6.js"><link rel="prefetch" href="/blog/assets/js/149.a98d647c.js"><link rel="prefetch" href="/blog/assets/js/15.5376294f.js"><link rel="prefetch" href="/blog/assets/js/150.7360f0a5.js"><link rel="prefetch" href="/blog/assets/js/151.0cf39bd7.js"><link rel="prefetch" href="/blog/assets/js/152.6f7d01ad.js"><link rel="prefetch" href="/blog/assets/js/153.f6075040.js"><link rel="prefetch" href="/blog/assets/js/154.12eeb9b2.js"><link rel="prefetch" href="/blog/assets/js/155.65f03a29.js"><link rel="prefetch" href="/blog/assets/js/156.d2f6d50d.js"><link rel="prefetch" href="/blog/assets/js/157.f4384a9b.js"><link rel="prefetch" href="/blog/assets/js/158.34747ec7.js"><link rel="prefetch" href="/blog/assets/js/159.410bff01.js"><link rel="prefetch" href="/blog/assets/js/16.abdf559d.js"><link rel="prefetch" href="/blog/assets/js/160.53124933.js"><link rel="prefetch" href="/blog/assets/js/161.0ab0763e.js"><link rel="prefetch" href="/blog/assets/js/162.39021ec7.js"><link rel="prefetch" href="/blog/assets/js/163.596b82cf.js"><link rel="prefetch" href="/blog/assets/js/164.cbd2db78.js"><link rel="prefetch" href="/blog/assets/js/165.6e6c3d3a.js"><link rel="prefetch" href="/blog/assets/js/166.5bcaa3dd.js"><link rel="prefetch" href="/blog/assets/js/167.b4296d08.js"><link rel="prefetch" href="/blog/assets/js/168.27dc81ce.js"><link rel="prefetch" href="/blog/assets/js/169.661c763c.js"><link rel="prefetch" href="/blog/assets/js/17.8b47c823.js"><link rel="prefetch" href="/blog/assets/js/170.e41001f5.js"><link rel="prefetch" href="/blog/assets/js/171.0724bbd4.js"><link rel="prefetch" href="/blog/assets/js/172.2d5b541f.js"><link rel="prefetch" href="/blog/assets/js/173.41d6e737.js"><link rel="prefetch" href="/blog/assets/js/174.bccb9fa6.js"><link rel="prefetch" href="/blog/assets/js/175.b1a13486.js"><link rel="prefetch" href="/blog/assets/js/176.6e26a58e.js"><link rel="prefetch" href="/blog/assets/js/177.67fa30a9.js"><link rel="prefetch" href="/blog/assets/js/178.7f4bf5e6.js"><link rel="prefetch" href="/blog/assets/js/18.6a619898.js"><link rel="prefetch" href="/blog/assets/js/19.ea80b1e1.js"><link rel="prefetch" href="/blog/assets/js/2.04feeb4a.js"><link rel="prefetch" href="/blog/assets/js/20.77762601.js"><link rel="prefetch" href="/blog/assets/js/21.656ab41e.js"><link rel="prefetch" href="/blog/assets/js/22.5922a16f.js"><link rel="prefetch" href="/blog/assets/js/23.41929ef9.js"><link rel="prefetch" href="/blog/assets/js/24.3b850e15.js"><link rel="prefetch" href="/blog/assets/js/25.aade9e50.js"><link rel="prefetch" href="/blog/assets/js/26.36c6a527.js"><link rel="prefetch" href="/blog/assets/js/27.907a8228.js"><link rel="prefetch" href="/blog/assets/js/28.cc2bee0d.js"><link rel="prefetch" href="/blog/assets/js/29.52c7bfa4.js"><link rel="prefetch" href="/blog/assets/js/30.f034dd77.js"><link rel="prefetch" href="/blog/assets/js/31.edcef4fa.js"><link rel="prefetch" href="/blog/assets/js/32.6735d3e7.js"><link rel="prefetch" href="/blog/assets/js/33.28f8dc69.js"><link rel="prefetch" href="/blog/assets/js/34.8a729d66.js"><link rel="prefetch" href="/blog/assets/js/35.920cdf75.js"><link rel="prefetch" href="/blog/assets/js/36.15f2a36b.js"><link rel="prefetch" href="/blog/assets/js/37.5b03bd21.js"><link rel="prefetch" href="/blog/assets/js/38.fed1555d.js"><link rel="prefetch" href="/blog/assets/js/39.68d965cd.js"><link rel="prefetch" href="/blog/assets/js/4.644e7959.js"><link rel="prefetch" href="/blog/assets/js/40.069924f4.js"><link rel="prefetch" href="/blog/assets/js/41.a44d976c.js"><link rel="prefetch" href="/blog/assets/js/42.47caadd3.js"><link rel="prefetch" href="/blog/assets/js/43.b1eb7b31.js"><link rel="prefetch" href="/blog/assets/js/44.96773f8a.js"><link rel="prefetch" href="/blog/assets/js/45.328fda2a.js"><link rel="prefetch" href="/blog/assets/js/46.24f71020.js"><link rel="prefetch" href="/blog/assets/js/47.96df34c4.js"><link rel="prefetch" href="/blog/assets/js/48.b0bfea08.js"><link rel="prefetch" href="/blog/assets/js/49.3dac2a21.js"><link rel="prefetch" href="/blog/assets/js/5.0760b076.js"><link rel="prefetch" href="/blog/assets/js/50.97f9d2b0.js"><link rel="prefetch" href="/blog/assets/js/51.29fb5c68.js"><link rel="prefetch" href="/blog/assets/js/52.d2042f8d.js"><link rel="prefetch" href="/blog/assets/js/53.02c82b26.js"><link rel="prefetch" href="/blog/assets/js/54.667f483f.js"><link rel="prefetch" href="/blog/assets/js/55.b6b1e0e7.js"><link rel="prefetch" href="/blog/assets/js/56.bd954c20.js"><link rel="prefetch" href="/blog/assets/js/57.45722d8c.js"><link rel="prefetch" href="/blog/assets/js/58.17cd106d.js"><link rel="prefetch" href="/blog/assets/js/59.51661424.js"><link rel="prefetch" href="/blog/assets/js/6.d309aec3.js"><link rel="prefetch" href="/blog/assets/js/60.18a9a452.js"><link rel="prefetch" href="/blog/assets/js/61.819ab903.js"><link rel="prefetch" href="/blog/assets/js/62.24bf6999.js"><link rel="prefetch" href="/blog/assets/js/63.2f87f55d.js"><link rel="prefetch" href="/blog/assets/js/64.68cd3b45.js"><link rel="prefetch" href="/blog/assets/js/65.7fe0d182.js"><link rel="prefetch" href="/blog/assets/js/66.948be4c4.js"><link rel="prefetch" href="/blog/assets/js/67.2522194c.js"><link rel="prefetch" href="/blog/assets/js/68.0a66e8af.js"><link rel="prefetch" href="/blog/assets/js/69.07a744c4.js"><link rel="prefetch" href="/blog/assets/js/7.073a2745.js"><link rel="prefetch" href="/blog/assets/js/70.c0e92ba6.js"><link rel="prefetch" href="/blog/assets/js/71.97a4d551.js"><link rel="prefetch" href="/blog/assets/js/72.78fc6941.js"><link rel="prefetch" href="/blog/assets/js/73.3e3efdc5.js"><link rel="prefetch" href="/blog/assets/js/74.cff95a30.js"><link rel="prefetch" href="/blog/assets/js/75.6c4af1f1.js"><link rel="prefetch" href="/blog/assets/js/76.96c205c1.js"><link rel="prefetch" href="/blog/assets/js/77.31c8dd27.js"><link rel="prefetch" href="/blog/assets/js/78.41729cec.js"><link rel="prefetch" href="/blog/assets/js/79.12735350.js"><link rel="prefetch" href="/blog/assets/js/8.5e05a8d5.js"><link rel="prefetch" href="/blog/assets/js/80.e5005d72.js"><link rel="prefetch" href="/blog/assets/js/81.04f50a1e.js"><link rel="prefetch" href="/blog/assets/js/82.db879ca5.js"><link rel="prefetch" href="/blog/assets/js/83.e89b8863.js"><link rel="prefetch" href="/blog/assets/js/84.07410b58.js"><link rel="prefetch" href="/blog/assets/js/85.d46c8682.js"><link rel="prefetch" href="/blog/assets/js/86.3869d59e.js"><link rel="prefetch" href="/blog/assets/js/87.e7860b15.js"><link rel="prefetch" href="/blog/assets/js/88.2b183553.js"><link rel="prefetch" href="/blog/assets/js/89.36e67a82.js"><link rel="prefetch" href="/blog/assets/js/9.8a6a0670.js"><link rel="prefetch" href="/blog/assets/js/90.acd5023c.js"><link rel="prefetch" href="/blog/assets/js/91.d1662d38.js"><link rel="prefetch" href="/blog/assets/js/92.4093acc4.js"><link rel="prefetch" href="/blog/assets/js/93.f09d7ba1.js"><link rel="prefetch" href="/blog/assets/js/94.1e2891fe.js"><link rel="prefetch" href="/blog/assets/js/95.83afadb6.js"><link rel="prefetch" href="/blog/assets/js/96.85084d66.js"><link rel="prefetch" href="/blog/assets/js/97.16a7a60a.js"><link rel="prefetch" href="/blog/assets/js/98.a84fee2e.js"><link rel="prefetch" href="/blog/assets/js/99.f9452cba.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b3aba94c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">一名GO+PHP工程师</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://gitee.com/ColinWWL/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://gitee.com/ColinWWL/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/Go类型系统/1Go类型系统概述" class="sidebar-heading clickable"><span>Go类型系统</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/Go类型系统/1Go类型系统概述.html" class="sidebar-link">Go类型系统概述</a></li><li><a href="/blog/开发基础/GO/Go类型系统/2指针.html" class="sidebar-link">指针</a></li><li><a href="/blog/开发基础/GO/Go类型系统/3结构体.html" class="sidebar-link">结构体</a></li><li><a href="/blog/开发基础/GO/Go类型系统/4值部.html" class="sidebar-link">值部</a></li><li><a href="/blog/开发基础/GO/Go类型系统/5数组、切片和映射.html" class="sidebar-link">数组、切片和映射</a></li><li><a href="/blog/开发基础/GO/Go类型系统/6通道.html" class="sidebar-link">通道</a></li><li><a href="/blog/开发基础/GO/Go类型系统/7方法.html" class="sidebar-link">方法</a></li><li><a href="/blog/开发基础/GO/Go类型系统/8接口.html" class="sidebar-link">接口</a></li><li><a href="/blog/开发基础/GO/Go类型系统/9类型内嵌.html" class="sidebar-link">类型内嵌</a></li><li><a href="/blog/开发基础/GO/Go类型系统/10非类型安全指针.html" class="sidebar-link">非类型安全指针</a></li><li><a href="/blog/开发基础/GO/Go类型系统/11泛型.html" class="sidebar-link">泛型</a></li><li><a href="/blog/开发基础/GO/Go类型系统/12反射.html" class="sidebar-link">反射</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/Go编程入门/1程序源代码基本元素介绍" class="sidebar-heading clickable"><span>Go编程入门</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/Go编程入门/1程序源代码基本元素介绍.html" class="sidebar-link">程序源代码基本元素介绍</a></li><li><a href="/blog/开发基础/GO/Go编程入门/2关键字和标识符.html" class="sidebar-link">关键字和标识符</a></li><li><a href="/blog/开发基础/GO/Go编程入门/3基本类型和它们的字面量表示.html" class="sidebar-link">基本类型和它们的字面量表示</a></li><li><a href="/blog/开发基础/GO/Go编程入门/4常量和变量.html" class="sidebar-link">常量和变量</a></li><li><a href="/blog/开发基础/GO/Go编程入门/5运算操作符.html" class="sidebar-link">运算操作符</a></li><li><a href="/blog/开发基础/GO/Go编程入门/6函数声明和调用.html" class="sidebar-link">函数声明和调用</a></li><li><a href="/blog/开发基础/GO/Go编程入门/7代码包和包引入.html" class="sidebar-link">代码包和包引入</a></li><li><a href="/blog/开发基础/GO/Go编程入门/8表达式、语句和简单语句.html" class="sidebar-link">表达式、语句和简单语句</a></li><li><a href="/blog/开发基础/GO/Go编程入门/9基本流程控制语法.html" class="sidebar-link">基本流程控制语法</a></li><li><a href="/blog/开发基础/GO/Go编程入门/10协程、延迟函数调用、以及恐慌和恢复.html" class="sidebar-link">协程、延迟函数调用、以及恐慌和恢复</a></li><li><a href="/blog/开发基础/GO/Go编程入门/GO官方链接工具.html" class="sidebar-link">GO官方链接工具</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/其他文章/Go技巧" class="sidebar-heading clickable open"><span>其他文章</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/其他文章/Go技巧.html" class="sidebar-link">Go技巧</a></li><li><a href="/blog/开发基础/GO/其他文章/Go细节.html" class="active sidebar-link">Go细节</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#一个包可以在一个源文件里被引入多次。" class="sidebar-link">一个包可以在一个源文件里被引入多次。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#在-switch-和-select-流程控制代码块中-default-分支可以放在所有的-case-分支之前或者所有的-case-分支之后-也可以放在-case-分支之间。" class="sidebar-link">在 switch 和 select 流程控制代码块中， default 分支可以放在所有的 case 分支之前或者所有的 case 分支之后，也可以放在 case 分支之间。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#switch-流程控制代码块中的数字常量case表达式不能重复-但是布尔常量case表达式可以重复。" class="sidebar-link">switch 流程控制代码块中的数字常量case表达式不能重复，但是布尔常量case表达式可以重复。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#switch-流程控制代码块里的switch表达式总是被估值为类型确定值。" class="sidebar-link">switch 流程控制代码块里的switch表达式总是被估值为类型确定值。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#switch-流程控制代码块中的switch表达式的缺省默认值为类型确定值-true-其类型为预定义类型-bool-。" class="sidebar-link">switch 流程控制代码块中的switch表达式的缺省默认值为类型确定值 true （其类型为预定义类型 bool ）。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#有时候-显式代码块的开括号-可以放在下一行。" class="sidebar-link">有时候，显式代码块的开括号 { 可以放在下一行。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#有些-case-分支代码块必须是显式的。" class="sidebar-link">有些 case 分支代码块必须是显式的。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#嵌套的延迟函数调用可以修改外层函数的返回结果。" class="sidebar-link">嵌套的延迟函数调用可以修改外层函数的返回结果。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#某些-recover-函数调用是空操作。" class="sidebar-link">某些 recover 函数调用是空操作。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#我们可以使用-os-exit-函数调用退出一个程序和使用-runtime-goexit-函数调用退出一个协程。" class="sidebar-link">我们可以使用 os. Exit 函数调用退出一个程序和使用 runtime. Goexit 函数调用退出一个协程。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#递增运算符-和递减运算符-的优先级低于解引用运算符-和取地址运算符-解引用运算符和取地址运算符的优先级低于选择器-中的属性选择操作符。" class="sidebar-link">递增运算符 ++ 和递减运算符 -- 的优先级低于解引用运算符 * 和取地址运算符 &amp; ，解引用运算符和取地址运算符的优先级低于选择器 . 中的属性选择操作符。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#移位运算中的左类型不确定操作数的类型推断规则取决于右操作数是否是常量。" class="sidebar-link">移位运算中的左类型不确定操作数的类型推断规则取决于右操作数是否是常量。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#如果两个指针的类型具有不同的底层类型但是它们的基类型却共享相同的底层类型-则这两个指针值可以间接相互转换为对方的类型。" class="sidebar-link">如果两个指针的类型具有不同的底层类型但是它们的基类型却共享相同的底层类型，则这两个指针值可以间接相互转换为对方的类型。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#两个零尺寸值的地址可能相等-也可能不相等。" class="sidebar-link">两个零尺寸值的地址可能相等，也可能不相等。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#一个指针类型的基类型可以为此指针类型自身。" class="sidebar-link">一个指针类型的基类型可以为此指针类型自身。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#有关选择器缩写形式的细节。" class="sidebar-link">有关选择器缩写形式的细节。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#有时候-嵌套组合字面量可以被简化。" class="sidebar-link">有时候，嵌套组合字面量可以被简化。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#在某些情形下-我们可以将数组指针当作数组来用。" class="sidebar-link">在某些情形下，我们可以将数组指针当作数组来用。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#从nil映射中读取元素不会导致崩溃-读取结果是一个零元素值。" class="sidebar-link">从nil映射中读取元素不会导致崩溃，读取结果是一个零元素值。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#从一个nil映射中删除一个条目不会导致崩溃-这是一个空操作。" class="sidebar-link">从一个nil映射中删除一个条目不会导致崩溃，这是一个空操作。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#append-函数调用的结果可能会与原始切片共享一些元素-也可能不共享任何元素。" class="sidebar-link">append 函数调用的结果可能会与原始切片共享一些元素，也可能不共享任何元素。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#从一个基础切片派生出的子切片的长度可能大于基础切片的长度。" class="sidebar-link">从一个基础切片派生出的子切片的长度可能大于基础切片的长度。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#从一个nil切片中派生子切片是允许的-只要子切片表达式中使用的所有索引都为零-则不会有恐慌产生-结果子切片同样是一个nil切片。" class="sidebar-link">从一个nil切片中派生子切片是允许的，只要子切片表达式中使用的所有索引都为零，则不会有恐慌产生，结果子切片同样是一个nil切片。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#用-range-遍历nil映射或者nil切片是没问题的-这属于空操作。" class="sidebar-link">用 range 遍历nil映射或者nil切片是没问题的，这属于空操作。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#用-range-遍历nil数组指针时-如果忽略或省略第二个迭代变量-则此遍历是没问题的。遍历中的循环步数为相应数组类型的长度。" class="sidebar-link">用 range 遍历nil数组指针时，如果忽略或省略第二个迭代变量，则此遍历是没问题的。遍历中的循环步数为相应数组类型的长度。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#切片的长度和容量可以被单独修改。" class="sidebar-link">切片的长度和容量可以被单独修改。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#切片和数组组合字面量中的索引必须是非负常量。" class="sidebar-link">切片和数组组合字面量中的索引必须是非负常量。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#切片-数组-映射组合字面量的常量索引和键值不能重复。" class="sidebar-link">切片/数组/映射组合字面量的常量索引和键值不能重复。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#不可寻址的数组的元素依旧是不可寻址的-但是不可寻址的切片的元素总是可寻址的。" class="sidebar-link">不可寻址的数组的元素依旧是不可寻址的，但是不可寻址的切片的元素总是可寻址的。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#可以从不可寻址的切片派生子切片-但是不能从不可寻址的数组派生子切片。" class="sidebar-link">可以从不可寻址的切片派生子切片，但是不能从不可寻址的数组派生子切片。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#把以-nan-做为键值的条目放如映射就宛如把条目放入黑洞一样。" class="sidebar-link">把以 NaN 做为键值的条目放如映射就宛如把条目放入黑洞一样。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#字符串转换为byte切片或rune切片后的结果切片的容量可能会大于长度。" class="sidebar-link">字符串转换为byte切片或rune切片后的结果切片的容量可能会大于长度。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#对于切片-s-循环-for-i-range-s-并不等价于循环-for-i-0-i-len-s-i-。" class="sidebar-link">对于切片 s ，循环 for i = range s {...} 并不等价于循环 for i = 0; i &lt; len(s); i++ {...} 。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#一个映射中的条目的遍历次序在两次遍历中可能并不相同。我们可以认为映射中的条目的遍历次序是随机的。" class="sidebar-link">一个映射中的条目的遍历次序在两次遍历中可能并不相同。我们可以认为映射中的条目的遍历次序是随机的。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#在对一个映射进行条目遍历期间-在此映射中创建的新条目可能会在当前遍历中被遍历出来-也可能不会。" class="sidebar-link">在对一个映射进行条目遍历期间，在此映射中创建的新条目可能会在当前遍历中被遍历出来，也可能不会。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#一个多返回值函数调用表达式不能和其它表达式混用在一个赋值语句的右侧或者另一个函数调用的实参列表中。" class="sidebar-link">一个多返回值函数调用表达式不能和其它表达式混用在一个赋值语句的右侧或者另一个函数调用的实参列表中。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#某些函数调用是在在编译时刻被估值的。" class="sidebar-link">某些函数调用是在在编译时刻被估值的。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#每一个方法都对应着一个隐式声明的函数。" class="sidebar-link">每一个方法都对应着一个隐式声明的函数。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#如果两个接口值具有相同的动态类型并且此动态类型不支持比较-则比较这两个接口值将导致一个恐慌。" class="sidebar-link">如果两个接口值具有相同的动态类型并且此动态类型不支持比较，则比较这两个接口值将导致一个恐慌。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#类型断言可以用于将一个接口值转换为另一个接口类型-即使此接口值的类型并未实现另一个接口类型。" class="sidebar-link">类型断言可以用于将一个接口值转换为另一个接口类型，即使此接口值的类型并未实现另一个接口类型。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#一个失败的类型断言的可选的第二个结果是否被舍弃将影响此类型断言的行为。" class="sidebar-link">一个失败的类型断言的可选的第二个结果是否被舍弃将影响此类型断言的行为。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#关于在编译时刻即可确定总是失败的目标类型为接口类型的断言。" class="sidebar-link">关于在编译时刻即可确定总是失败的目标类型为接口类型的断言。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#以相同实参调用两次-errors-new-函数返回的两个-error-值是不相等的。" class="sidebar-link">以相同实参调用两次 errors. New 函数返回的两个 error 值是不相等的。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#单向接收通道无法被关闭。" class="sidebar-link">单向接收通道无法被关闭。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#发送一个值到一个已关闭的通道被视为一个非阻塞操作-该操作会导致恐慌。" class="sidebar-link">发送一个值到一个已关闭的通道被视为一个非阻塞操作，该操作会导致恐慌。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#类型可以在声明函数体内。" class="sidebar-link">类型可以在声明函数体内。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#对于标准编译器-结构体中的某些零尺寸字段的尺寸有可能会被视为一个字节。" class="sidebar-link">对于标准编译器，结构体中的某些零尺寸字段的尺寸有可能会被视为一个字节。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#nan-nan-inf-inf。" class="sidebar-link">NaN != NaN，Inf == Inf。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#不同代码包中的两个非导出方法名和结构体字段名总是被视为不同的名称。" class="sidebar-link">不同代码包中的两个非导出方法名和结构体字段名总是被视为不同的名称。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#在结构体值的比较中-名为空标识符的字段将被忽略。" class="sidebar-link">在结构体值的比较中，名为空标识符的字段将被忽略。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#在某些很少见的场景中-圆括号是必需的。" class="sidebar-link">在某些很少见的场景中，圆括号是必需的。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#栈溢出不可被挽救-它将使程序崩溃。" class="sidebar-link">栈溢出不可被挽救，它将使程序崩溃。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#某些表达式的估值顺序取决于具体编译器实现。" class="sidebar-link">某些表达式的估值顺序取决于具体编译器实现。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#reflect-deepequal-x-y-和-x-y-的结果可能会不同。" class="sidebar-link">reflect. DeepEqual(x, y) 和 x == y 的结果可能会不同。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#reflect-value-bytes-方法返回一个-byte-值-它的元素类型-byte-可能并非属主参数代表的go切片值的元素类型。" class="sidebar-link">reflect. Value. Bytes() 方法返回一个 []byte 值，它的元素类型 byte 可能并非属主参数代表的Go切片值的元素类型。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#我们应该使用-os-isnotexist-err-而不是-err-os-errnotexist-来检查文件是否存在。" class="sidebar-link">我们应该使用 os. IsNotExist(err) 而不是 err == os. ErrNotExist 来检查文件是否存在。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#flag-标准库包对待布尔命令选项不同于数值和字符串选项。" class="sidebar-link">flag 标准库包对待布尔命令选项不同于数值和字符串选项。</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/其他文章/Go细节.html#sp-fp-p-rintf-函数支持位置参数。" class="sidebar-link">[Sp|Fp|P]rintf 函数支持位置参数。</a></li></ul></li><li><a href="/blog/开发基础/GO/其他文章/Go问答.html" class="sidebar-link">Go问答</a></li><li><a href="/blog/开发基础/GO/其他文章/命令-mod.html" class="sidebar-link">命令-mod</a></li><li><a href="/blog/开发基础/GO/其他文章/基础-Golang的time.NewTimer单次定时器使用案例.html" class="sidebar-link">基础-Golang的time. NewTimer单次定时器使用案例</a></li><li><a href="/blog/开发基础/GO/其他文章/基础-Go中的nil.html" class="sidebar-link">Go中的 nil</a></li><li><a href="/blog/开发基础/GO/其他文章/基础-Go代码断行规则.html" class="sidebar-link">Go代码断行规则</a></li><li><a href="/blog/开发基础/GO/其他文章/基础-表达式估值顺序规则.html" class="sidebar-link">表达式估值顺序规则</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/学习资料" class="sidebar-heading clickable"><span>GO</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/学习资料.html" class="sidebar-link">教学书籍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/并发编程/1并发同步概述" class="sidebar-heading clickable"><span>并发编程</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/并发编程/1并发同步概述.html" class="sidebar-link">并发同步概述</a></li><li><a href="/blog/开发基础/GO/并发编程/2通道用例大全.html" class="sidebar-link">通道用例大全</a></li><li><a href="/blog/开发基础/GO/并发编程/3如何优雅地关闭通道.html" class="sidebar-link">如何优雅地关闭通道</a></li><li><a href="/blog/开发基础/GO/并发编程/4其它并发同步技术.html" class="sidebar-link">sync 标准库包中提供的并发同步技术</a></li><li><a href="/blog/开发基础/GO/并发编程/5原子操作 .html" class="sidebar-link">sync/atomic 标准库包中提供的原子操作</a></li><li><a href="/blog/开发基础/GO/并发编程/6Go中的内存顺序保证.html" class="sidebar-link">Go中的内存顺序保证</a></li><li><a href="/blog/开发基础/GO/并发编程/7一些常见并发编程错误.html" class="sidebar-link">一些常见并发编程错误</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/开发环境搭建/Docker和VS Code的Go开发环境" class="sidebar-heading clickable"><span>开发环境搭建</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/开发环境搭建/Docker和VS Code的Go开发环境.html" class="sidebar-link">Docker和VS Code的Go开发环境</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="go细节"><a href="#go细节" class="header-anchor">#</a> Go细节</h1> <h2 id="一个包可以在一个源文件里被引入多次。"><a href="#一个包可以在一个源文件里被引入多次。" class="header-anchor">#</a> 一个包可以在一个源文件里被引入多次。</h2> <p>一个Go源文件可以多次引入同一个包。但是每次的引入名称必须不同。这些相同的包引入引用着同一个包实例。</p> <p>示例：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;io&quot;</span>
<span class="token keyword">import</span> inout <span class="token string">&quot;io&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>inout<span class="token punctuation">.</span>EOF <span class="token operator">==</span> <span class="token operator">&amp;</span>io<span class="token punctuation">.</span>EOF<span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="在-switch-和-select-流程控制代码块中-default-分支可以放在所有的-case-分支之前或者所有的-case-分支之后-也可以放在-case-分支之间。"><a href="#在-switch-和-select-流程控制代码块中-default-分支可以放在所有的-case-分支之前或者所有的-case-分支之后-也可以放在-case-分支之间。" class="header-anchor">#</a> 在 <code>switch</code> 和 <code>select</code> 流程控制代码块中， <code>default</code> 分支可以放在所有的 <code>case</code> 分支之前或者所有的 <code>case</code> 分支之后，也可以放在 <code>case</code> 分支之间。</h2> <p>示例：</p> <div class="language-go extra-class"><pre class="language-go"><code>	<span class="token keyword">switch</span> n <span class="token operator">:=</span> rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> n <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;n == 0&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;n == 1&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;n == 2&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">switch</span> n <span class="token operator">:=</span> rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> n <span class="token punctuation">{</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;n == 2&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;n == 0&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;n == 1&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">switch</span> n <span class="token operator">:=</span> rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> n <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;n == 0&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;n == 2&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;n == 1&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">var</span> x<span class="token punctuation">,</span> y <span class="token keyword">chan</span> <span class="token builtin">int</span>

	<span class="token keyword">select</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token operator">&lt;-</span>x<span class="token punctuation">:</span>
	<span class="token keyword">case</span> y <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token punctuation">:</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">select</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token operator">&lt;-</span>x<span class="token punctuation">:</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
	<span class="token keyword">case</span> y <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token punctuation">:</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">select</span> <span class="token punctuation">{</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
	<span class="token keyword">case</span> <span class="token operator">&lt;-</span>x<span class="token punctuation">:</span>
	<span class="token keyword">case</span> y <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token punctuation">:</span>
	<span class="token punctuation">}</span>
</code></pre></div><h2 id="switch-流程控制代码块中的数字常量case表达式不能重复-但是布尔常量case表达式可以重复。"><a href="#switch-流程控制代码块中的数字常量case表达式不能重复-但是布尔常量case表达式可以重复。" class="header-anchor">#</a> <code>switch</code> 流程控制代码块中的数字常量case表达式不能重复，但是布尔常量case表达式可以重复。</h2> <p>例如，下面的代码在编译时会失败。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">switch</span> <span class="token number">123</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token number">123</span><span class="token punctuation">:</span>
	<span class="token keyword">case</span> <span class="token number">123</span><span class="token punctuation">:</span> <span class="token comment">// error: duplicate case</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>但是下面的代码在编译时是没问题的。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">switch</span> <span class="token boolean">false</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token boolean">false</span><span class="token punctuation">:</span>
	<span class="token keyword">case</span> <span class="token boolean">false</span><span class="token punctuation">:</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>关于原因，请阅读<a href="https://github.com/golang/go/issues/28357" target="_blank" rel="noopener noreferrer">这个issue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。 此行为依赖于编译器。事实上，标准编译器同样不允许重复的字符串case表达式，但是gccgo编译器却允许。</p> <h2 id="switch-流程控制代码块里的switch表达式总是被估值为类型确定值。"><a href="#switch-流程控制代码块里的switch表达式总是被估值为类型确定值。" class="header-anchor">#</a> <code>switch</code> 流程控制代码块里的switch表达式总是被估值为类型确定值。</h2> <p>例如，在下列 <code>switch</code> 代码块中的switch表达式 <code>123</code> 被视为一个 <code>int</code> 值，而不是一个类型不确定的整数。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">switch</span> <span class="token number">123</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token function">int64</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">// error: 类型不匹配</span>
	<span class="token keyword">case</span> <span class="token function">uint32</span><span class="token punctuation">(</span><span class="token number">789</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">// error: 类型不匹配</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="switch-流程控制代码块中的switch表达式的缺省默认值为类型确定值-true-其类型为预定义类型-bool-。"><a href="#switch-流程控制代码块中的switch表达式的缺省默认值为类型确定值-true-其类型为预定义类型-bool-。" class="header-anchor">#</a> <code>switch</code> 流程控制代码块中的switch表达式的缺省默认值为类型确定值 <code>true</code> （其类型为预定义类型 <code>bool</code> ）。</h2> <p>例如，下列程序会打印出 <code>true</code> 。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">switch</span> <span class="token punctuation">{</span> <span class="token comment">// &lt;=&gt; switch true {</span>
	<span class="token keyword">case</span> <span class="token boolean">true</span><span class="token punctuation">:</span>  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token boolean">false</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;false&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="有时候-显式代码块的开括号-可以放在下一行。"><a href="#有时候-显式代码块的开括号-可以放在下一行。" class="header-anchor">#</a> 有时候，显式代码块的开括号 <code>{</code> 可以放在下一行。</h2> <p>例如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span>
Outer<span class="token punctuation">:</span>
	<span class="token keyword">for</span>
	<span class="token punctuation">{</span> <span class="token comment">// 在这里断行是没问题的</span>
		<span class="token keyword">switch</span>
		<span class="token punctuation">{</span> <span class="token comment">// 在这里断行是没问题的</span>
		<span class="token keyword">case</span> i <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">:</span>
			<span class="token keyword">break</span> Outer
		<span class="token keyword">default</span><span class="token punctuation">:</span>
			i<span class="token operator">++</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>下面程序的结果会打印什么？ <code>true</code> 还是 <code>false</code> ？ 答案是 <code>true</code> 。 关于原因请阅读<a href="https://gfw.go101.org/article/line-break-rules.html" target="_blank" rel="noopener noreferrer">Go中的代码断行规则<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>一文。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">False</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">switch</span> <span class="token function">False</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token boolean">true</span><span class="token punctuation">:</span>  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">case</span> <span class="token boolean">false</span><span class="token punctuation">:</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;false&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="有些-case-分支代码块必须是显式的。"><a href="#有些-case-分支代码块必须是显式的。" class="header-anchor">#</a> 有些 <code>case</code> 分支代码块必须是显式的。</h2> <p>例如，下面的程序会在编译时将失败。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">demo</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> m <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>r <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">switch</span> n <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token number">123</span><span class="token punctuation">:</span>
		<span class="token keyword">if</span> m <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
			<span class="token keyword">goto</span> End
		<span class="token punctuation">}</span>
		r<span class="token operator">++</span>

		End<span class="token punctuation">:</span> <span class="token comment">// syntax error: 标签后缺少语句</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
		r <span class="token operator">=</span> <span class="token number">1</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre></div><p>为了编译通过， <code>case</code> 分支代码块必须改成显式的：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">demo</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> m <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>r <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">switch</span> n <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token number">123</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> m <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
			<span class="token keyword">goto</span> End
		<span class="token punctuation">}</span>
		r<span class="token operator">++</span>

		End<span class="token punctuation">:</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
		r <span class="token operator">=</span> <span class="token number">1</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre></div><p>另外，我们可以在标签 <code>End:</code> 之后加一个分号，如下所示：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">demo</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> m <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>r <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">switch</span> n <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token number">123</span><span class="token punctuation">:</span>
		<span class="token keyword">if</span> m <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
			<span class="token keyword">goto</span> End
		<span class="token punctuation">}</span>
		r<span class="token operator">++</span>

		End<span class="token punctuation">:</span><span class="token punctuation">;</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
		r <span class="token operator">=</span> <span class="token number">1</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre></div><p>关于原因，请阅读<a href="https://gfw.go101.org/article/line-break-rules.html" target="_blank" rel="noopener noreferrer">Go的代码断行规则<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>一文。</p> <h2 id="嵌套的延迟函数调用可以修改外层函数的返回结果。"><a href="#嵌套的延迟函数调用可以修改外层函数的返回结果。" class="header-anchor">#</a> 嵌套的延迟函数调用可以修改外层函数的返回结果。</h2> <p>例如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>r <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		r <span class="token operator">=</span> <span class="token number">789</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">return</span> <span class="token number">123</span> <span class="token comment">// &lt;=&gt; r = 123; return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 789</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="某些-recover-函数调用是空操作。"><a href="#某些-recover-函数调用是空操作。" class="header-anchor">#</a> 某些 <code>recover</code> 函数调用是空操作。</h2> <p>我们需要在正确的地方调用 <code>recover</code> 函数。 关于细节，请阅读 <a href="https://gfw.go101.org/article/panic-and-recover-more.html" target="_blank" rel="noopener noreferrer">在正确的位置调用内置函数 <code>recover</code> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>一文。</p> <h2 id="我们可以使用-os-exit-函数调用退出一个程序和使用-runtime-goexit-函数调用退出一个协程。"><a href="#我们可以使用-os-exit-函数调用退出一个程序和使用-runtime-goexit-函数调用退出一个协程。" class="header-anchor">#</a> 我们可以使用 <code>os. Exit</code> 函数调用退出一个程序和使用 <code>runtime. Goexit</code> 函数调用退出一个协程。</h2> <p>我们可以通过调用 <code>os. Exit</code> 函数从任何函数里退出一个程序。 <code>os. Exit</code> 函数调用接受一个 <code>int</code> 代码值做为参数并将此代码返回给操作系统。</p> <p>示例：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// exit-example.go</span>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;os&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;time&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
		os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">select</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>运行：</p> <div class="language- extra-class"><pre class="language-text"><code>
$ go run a.go
exit status 1
$ echo $?
1
</code></pre></div><p>我们可以通过调用 <code>runtime. Goexit</code> 函数退出一个goroutine。 <code>runtime. Goexit</code> 函数没有参数。</p> <p>在下面的示例中，文字 <code>Java</code> 将不会被打印出来。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;runtime&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>c <span class="token operator">&lt;-</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Go&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">)</span>
			runtime<span class="token punctuation">.</span><span class="token function">Goexit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Java&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token operator">&lt;-</span>c
<span class="token punctuation">}</span>
</code></pre></div><h2 id="递增运算符-和递减运算符-的优先级低于解引用运算符-和取地址运算符-解引用运算符和取地址运算符的优先级低于选择器-中的属性选择操作符。"><a href="#递增运算符-和递减运算符-的优先级低于解引用运算符-和取地址运算符-解引用运算符和取地址运算符的优先级低于选择器-中的属性选择操作符。" class="header-anchor">#</a> 递增运算符 <code>++</code> 和递减运算符 <code>--</code> 的优先级低于解引用运算符 <code>*</code> 和取地址运算符 <code>&amp;</code> ，解引用运算符和取地址运算符的优先级低于选择器 <code>.</code> 中的属性选择操作符。</h2> <p>例如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> T <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	x <span class="token builtin">int</span>
	y <span class="token operator">*</span><span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> t T
	p <span class="token operator">:=</span> <span class="token operator">&amp;</span>t<span class="token punctuation">.</span>x <span class="token comment">// &lt;=&gt; p := &amp;(t.x)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%T\n&quot;</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token comment">// *int</span>

	<span class="token operator">*</span>p<span class="token operator">++</span> <span class="token comment">// &lt;=&gt; (*p)++</span>
	<span class="token operator">*</span>p<span class="token operator">--</span> <span class="token comment">// &lt;=&gt; (*p)--</span>

	t<span class="token punctuation">.</span>y <span class="token operator">=</span> p
	a <span class="token operator">:=</span> <span class="token operator">*</span>t<span class="token punctuation">.</span>y <span class="token comment">// &lt;=&gt; *(t.y)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%T\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// int</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="移位运算中的左类型不确定操作数的类型推断规则取决于右操作数是否是常量。"><a href="#移位运算中的左类型不确定操作数的类型推断规则取决于右操作数是否是常量。" class="header-anchor">#</a> 移位运算中的左类型不确定操作数的类型推断规则取决于右操作数是否是常量。</h2> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> M  <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">var</span> <span class="token boolean">_</span> <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">&lt;&lt;</span> M <span class="token comment">// 编译没问题。1.0将被推断为一个int值。</span>

<span class="token keyword">var</span> N <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">var</span> <span class="token boolean">_</span> <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">&lt;&lt;</span> N <span class="token comment">// 编译失败。1.0将被推断为一个float64值。</span>
</code></pre></div><p>关于原因请阅读<a href="https://gfw.go101.org/article/operators.html#bitwise-shift-left-operand-type-deduction" target="_blank" rel="noopener noreferrer">运算操作符<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>一文。</p> <h2 id="如果两个指针的类型具有不同的底层类型但是它们的基类型却共享相同的底层类型-则这两个指针值可以间接相互转换为对方的类型。"><a href="#如果两个指针的类型具有不同的底层类型但是它们的基类型却共享相同的底层类型-则这两个指针值可以间接相互转换为对方的类型。" class="header-anchor">#</a> 如果两个指针的类型具有不同的底层类型但是它们的基类型却共享相同的底层类型，则这两个指针值可以间接相互转换为对方的类型。</h2> <p>例如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">type</span> MyInt <span class="token builtin">int64</span>
<span class="token keyword">type</span> Ta    <span class="token operator">*</span><span class="token builtin">int64</span>
<span class="token keyword">type</span> Tb    <span class="token operator">*</span>MyInt

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a Ta
	<span class="token keyword">var</span> b Tb

	<span class="token comment">//a = Ta(b) // error: 直接转换是不允许的。</span>

	<span class="token comment">// 但是间接转换是允许的。</span>
	y <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token operator">*</span>MyInt<span class="token punctuation">)</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
	x <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">int64</span><span class="token punctuation">)</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
	a <span class="token operator">=</span> x           <span class="token comment">// 等价于下一行</span>
	a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">int64</span><span class="token punctuation">)</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token comment">// 等价于下一行</span>
	a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token builtin">int64</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>MyInt<span class="token punctuation">)</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> a
<span class="token punctuation">}</span>
</code></pre></div><h2 id="两个零尺寸值的地址可能相等-也可能不相等。"><a href="#两个零尺寸值的地址可能相等-也可能不相等。" class="header-anchor">#</a> 两个零尺寸值的地址可能相等，也可能不相等。</h2> <p>两个零尺寸值的地址是否相等时依赖于具体编译器实现以及具体编译器版本。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	b <span class="token operator">:=</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	x <span class="token operator">:=</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	y <span class="token operator">:=</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	m <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	n <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	o <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	p <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>y<span class="token punctuation">,</span> <span class="token operator">&amp;</span>o<span class="token punctuation">,</span> <span class="token operator">&amp;</span>p<span class="token punctuation">)</span>

	<span class="token comment">// 对于标准编译器1.16版本，x、y、o和p将</span>
	<span class="token comment">// 逃逸到堆上，但是a、b、m和n则开辟在栈上。</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a <span class="token operator">==</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span> <span class="token comment">// false</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>x <span class="token operator">==</span> <span class="token operator">&amp;</span>y<span class="token punctuation">)</span> <span class="token comment">// true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a <span class="token operator">==</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span> <span class="token comment">// false</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>m <span class="token operator">==</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span> <span class="token comment">// false</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>o <span class="token operator">==</span> <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token comment">// true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>n <span class="token operator">==</span> <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>上面代码中所示的输出是针对标准编译器1.16版本的。</p> <h2 id="一个指针类型的基类型可以为此指针类型自身。"><a href="#一个指针类型的基类型可以为此指针类型自身。" class="header-anchor">#</a> 一个指针类型的基类型可以为此指针类型自身。</h2> <p>例如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> P <span class="token operator">*</span>P
	<span class="token keyword">var</span> p P
	p <span class="token operator">=</span> <span class="token operator">&amp;</span>p
	p <span class="token operator">=</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>p
<span class="token punctuation">}</span>
</code></pre></div><p>类似的，</p> <ul><li>一个切片类型的元素类型可以是此切片类型自身，</li> <li>一个映射类型的元素类型可以是此映射类型自身，</li> <li>一个通道类型的元素类型可以是此通道类型自身，</li> <li>一个函数类型的输入参数和返回结果值类型可以是此函数类型自身。</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> S <span class="token punctuation">[</span><span class="token punctuation">]</span>S
	<span class="token keyword">type</span> M <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>M
	<span class="token keyword">type</span> C <span class="token keyword">chan</span> C
	<span class="token keyword">type</span> F <span class="token keyword">func</span><span class="token punctuation">(</span>F<span class="token punctuation">)</span> F

	s <span class="token operator">:=</span> S<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token boolean">nil</span><span class="token punctuation">}</span>
	s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> s
	m <span class="token operator">:=</span> M<span class="token punctuation">{</span><span class="token string">&quot;Go&quot;</span><span class="token punctuation">:</span> <span class="token boolean">nil</span><span class="token punctuation">}</span>
	m<span class="token punctuation">[</span><span class="token string">&quot;Go&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> m
	c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span>C<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
	c <span class="token operator">&lt;-</span> c<span class="token punctuation">;</span> c <span class="token operator">&lt;-</span> c<span class="token punctuation">;</span> c <span class="token operator">&lt;-</span> c
	<span class="token keyword">var</span> f F
	f <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>F<span class="token punctuation">)</span>F <span class="token punctuation">{</span><span class="token keyword">return</span> f<span class="token punctuation">}</span>

	<span class="token boolean">_</span> <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token string">&quot;Go&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;Go&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;Go&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;Go&quot;</span><span class="token punctuation">]</span>
	<span class="token operator">&lt;-</span><span class="token operator">&lt;-</span><span class="token operator">&lt;-</span>c
	<span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="有关选择器缩写形式的细节。"><a href="#有关选择器缩写形式的细节。" class="header-anchor">#</a> 有关选择器缩写形式的细节。</h2> <p>无论一个指针值的类型是定义的还是非定义的，如果它的（指针）类型的基类型为一个结构体类型，则我们可以使用此指针值来选择它所引用着的结构体中的字段。 但是，如果此指针的类型为一个定义的类型，则我们不能使用此指针值来选择它所引用着的结构体中的方法。</p> <p>我们总是不能使用二级以上指针来选择结构体字段和方法。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">type</span> T <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	x <span class="token builtin">int</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// T有一个方法m。</span>

<span class="token keyword">type</span> P <span class="token operator">*</span>T  <span class="token comment">// P为一个定义的一级指针。</span>
<span class="token keyword">type</span> PP <span class="token operator">*</span>P <span class="token comment">// PP为一个定义的二级指针。</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> t T
	<span class="token keyword">var</span> tp <span class="token operator">=</span> <span class="token operator">&amp;</span>t
	<span class="token keyword">var</span> tpp <span class="token operator">=</span> <span class="token operator">&amp;</span>tp
	<span class="token keyword">var</span> p P <span class="token operator">=</span> tp
	<span class="token keyword">var</span> pp PP <span class="token operator">=</span> <span class="token operator">&amp;</span>p
	tp<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">12</span>  <span class="token comment">// 没问题</span>
	p<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">34</span>   <span class="token comment">// 没问题</span>
	pp<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">56</span>  <span class="token comment">// error: 类型PP没有名为x的字段或者方法。</span>
	tpp<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">78</span> <span class="token comment">// error: 类型**T没有名为x的字段或者方法。</span>

	tp<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 没问题，因为类型*T也有一个m方法。</span>
	p<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// error: 类型P没有名为m的字段或者方法。</span>
	pp<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// error: 类型PP没有名为m的字段或者方法。</span>
	tpp<span class="token punctuation">.</span><span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// error: 类型**T没有名为m的字段或者方法。</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="有时候-嵌套组合字面量可以被简化。"><a href="#有时候-嵌套组合字面量可以被简化。" class="header-anchor">#</a> 有时候，嵌套组合字面量可以被简化。</h2> <p>关于细节，请阅读<a href="https://gfw.go101.org/article/container.html#composite-literal-simplification" target="_blank" rel="noopener noreferrer">内嵌组合字面量可以被简化<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这一章节。</p> <h2 id="在某些情形下-我们可以将数组指针当作数组来用。"><a href="#在某些情形下-我们可以将数组指针当作数组来用。" class="header-anchor">#</a> 在某些情形下，我们可以将数组指针当作数组来用。</h2> <p>关于细节，请阅读<a href="https://gfw.go101.org/article/container.html#use-pointer-as-array" target="_blank" rel="noopener noreferrer">把数组指针当做数组来使用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这一章节。</p> <h2 id="从nil映射中读取元素不会导致崩溃-读取结果是一个零元素值。"><a href="#从nil映射中读取元素不会导致崩溃-读取结果是一个零元素值。" class="header-anchor">#</a> 从nil映射中读取元素不会导致崩溃，读取结果是一个零元素值。</h2> <p>例如，函数 <code>Foo1</code> 和 <code>Foo2</code> 是等价的，但是函数 <code>Foo2</code> 比函数 <code>Foo1</code> 简洁得多。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">Foo1</span><span class="token punctuation">(</span>m <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> m <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">]</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">Foo2</span><span class="token punctuation">(</span>m <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="从一个nil映射中删除一个条目不会导致崩溃-这是一个空操作。"><a href="#从一个nil映射中删除一个条目不会导致崩溃-这是一个空操作。" class="header-anchor">#</a> 从一个nil映射中删除一个条目不会导致崩溃，这是一个空操作。</h2> <p>例如，下面这个程序不会因为恐慌而崩溃。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> m <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token comment">// nil</span>
	<span class="token function">delete</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="append-函数调用的结果可能会与原始切片共享一些元素-也可能不共享任何元素。"><a href="#append-函数调用的结果可能会与原始切片共享一些元素-也可能不共享任何元素。" class="header-anchor">#</a> <code>append</code> 函数调用的结果可能会与原始切片共享一些元素，也可能不共享任何元素。</h2> <p>关于细节，请阅读<a href="https://gfw.go101.org/article/container.html#element-addition-deletion" target="_blank" rel="noopener noreferrer">添加和删除容器元素<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这一章节。</p> <h2 id="从一个基础切片派生出的子切片的长度可能大于基础切片的长度。"><a href="#从一个基础切片派生出的子切片的长度可能大于基础切片的长度。" class="header-anchor">#</a> 从一个基础切片派生出的子切片的长度可能大于基础切片的长度。</h2> <p>例如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	s <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
	s2 <span class="token operator">:=</span> s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 5</span>
<span class="token punctuation">}</span>
</code></pre></div><p>关于细节，请阅读<a href="https://gfw.go101.org/article/container.html#subslice" target="_blank" rel="noopener noreferrer">从数组或者切片派生切片<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这一章节。</p> <h2 id="从一个nil切片中派生子切片是允许的-只要子切片表达式中使用的所有索引都为零-则不会有恐慌产生-结果子切片同样是一个nil切片。"><a href="#从一个nil切片中派生子切片是允许的-只要子切片表达式中使用的所有索引都为零-则不会有恐慌产生-结果子切片同样是一个nil切片。" class="header-anchor">#</a> 从一个nil切片中派生子切片是允许的，只要子切片表达式中使用的所有索引都为零，则不会有恐慌产生，结果子切片同样是一个nil切片。</h2> <p>例如，下面的程序在运行时刻不会产生恐慌。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> x <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token comment">// nil</span>
	a <span class="token operator">:=</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
	b <span class="token operator">:=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>
	c <span class="token operator">:=</span> x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>
	<span class="token comment">// 下一行将打印出三个true。</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> b <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> c <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>关于细节，请阅读<a href="https://gfw.go101.org/article/container.html#subslice" target="_blank" rel="noopener noreferrer">从数组或者切片派生切片<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这一章节。</p> <h2 id="用-range-遍历nil映射或者nil切片是没问题的-这属于空操作。"><a href="#用-range-遍历nil映射或者nil切片是没问题的-这属于空操作。" class="header-anchor">#</a> 用 <code>range</code> 遍历nil映射或者nil切片是没问题的，这属于空操作。</h2> <p>例如，下面的程序可以编译是没问题的。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> s <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token comment">// nil</span>
	<span class="token keyword">for</span> <span class="token keyword">range</span> s <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">var</span> m <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token comment">// nil</span>
	<span class="token keyword">for</span> <span class="token keyword">range</span> m <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="用-range-遍历nil数组指针时-如果忽略或省略第二个迭代变量-则此遍历是没问题的。遍历中的循环步数为相应数组类型的长度。"><a href="#用-range-遍历nil数组指针时-如果忽略或省略第二个迭代变量-则此遍历是没问题的。遍历中的循环步数为相应数组类型的长度。" class="header-anchor">#</a> 用 <code>range</code> 遍历nil数组指针时，如果忽略或省略第二个迭代变量，则此遍历是没问题的。遍历中的循环步数为相应数组类型的长度。</h2> <p>例如，下面的程序会输出 <code>01234</code> 。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token operator">*</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token comment">// nil</span>
	<span class="token keyword">for</span> i<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> <span class="token keyword">range</span> a <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="切片的长度和容量可以被单独修改。"><a href="#切片的长度和容量可以被单独修改。" class="header-anchor">#</a> 切片的长度和容量可以被单独修改。</h2> <p>我们可以通过反射途径单独修改一个切片的长度或者容量。 关于细节，请阅读<a href="https://gfw.go101.org/article/container.html#modify-slice-length-and-capacity" target="_blank" rel="noopener noreferrer">单独修改一个切片的长度或者容量<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这一章节。</p> <h2 id="切片和数组组合字面量中的索引必须是非负常量。"><a href="#切片和数组组合字面量中的索引必须是非负常量。" class="header-anchor">#</a> 切片和数组组合字面量中的索引必须是非负常量。</h2> <p>例如，下面的程序将编译失败。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">var</span> k <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span>k<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span> <span class="token comment">// error: 索引必须为一个常量</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span>k<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span>  <span class="token comment">// error: 索引必须为一个常量</span>
</code></pre></div><p>注意，映射组合字面量中的键值不必为常量。</p> <h2 id="切片-数组-映射组合字面量的常量索引和键值不能重复。"><a href="#切片-数组-映射组合字面量的常量索引和键值不能重复。" class="header-anchor">#</a> 切片/数组/映射组合字面量的常量索引和键值不能重复。</h2> <p>例如，下面的程序将编译失败。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// error: 重复的索引：1</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">bool</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span>
<span class="token comment">// error: 重复的索引：0</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">}</span>
<span class="token comment">// error: 重复的键值：&quot;foo&quot;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;foo&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
</code></pre></div><p>这个特性可以用于<a href="https://gfw.go101.org/article/tips.html#assert-at-compile-time" target="_blank" rel="noopener noreferrer">在编译时刻断言某些条件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="不可寻址的数组的元素依旧是不可寻址的-但是不可寻址的切片的元素总是可寻址的。"><a href="#不可寻址的数组的元素依旧是不可寻址的-但是不可寻址的切片的元素总是可寻址的。" class="header-anchor">#</a> 不可寻址的数组的元素依旧是不可寻址的，但是不可寻址的切片的元素总是可寻址的。</h2> <p>原因是一个数组值的元素和此数组存储在同一个内存块中。 但是<a href="https://gfw.go101.org/article/unofficial-faq.html#slice-elements-always-addressable" target="_blank" rel="noopener noreferrer">切片的情况大不相同<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>一个例子：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 组合字面量是不可寻址的。</span>

	<span class="token comment">/* 取容器元素的地址。 */</span>

	<span class="token comment">// 取不可寻址的切片的元素的地址是没问题的</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	<span class="token comment">// error: 不能取不可寻址的数组的元素的地址</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

	<span class="token comment">/* 修改元素值。 */</span>

	<span class="token comment">// 修改不可寻址的切片的元素是没问题的</span>
	<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">9</span>
	<span class="token comment">// error: 不能修改不可寻址的数组的元素</span>
	<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">9</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="可以从不可寻址的切片派生子切片-但是不能从不可寻址的数组派生子切片。"><a href="#可以从不可寻址的切片派生子切片-但是不能从不可寻址的数组派生子切片。" class="header-anchor">#</a> 可以从不可寻址的切片派生子切片，但是不能从不可寻址的数组派生子切片。</h2> <p>原因和上一个细节是一样的。</p> <p>例如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 映射元素是不可寻址的。</span>

	<span class="token comment">// 下面几行编译没问题。</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>
	<span class="token keyword">var</span> ms <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> ms<span class="token punctuation">[</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span>

	<span class="token comment">// 下面几行将编译失败，因为不可从不可寻址的数组派生切片。</span>
	<span class="token comment">/*
	_ = [...]int{6, 7, 8, 9}[1:3] // error
	var ma = map[string][4]int{&quot;abc&quot;: {0, 1, 2, 3}}
	_ = ma[&quot;abc&quot;][1:3]  // error
	*/</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="把以-nan-做为键值的条目放如映射就宛如把条目放入黑洞一样。"><a href="#把以-nan-做为键值的条目放如映射就宛如把条目放入黑洞一样。" class="header-anchor">#</a> 把以 <code>NaN</code> 做为键值的条目放如映射就宛如把条目放入黑洞一样。</h2> <p>原因是<a href="https://gfw.go101.org/article/details.html#nan-inf" target="_blank" rel="noopener noreferrer">下面的另一个细节<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中提到的 <code>NaN != NaN</code> 。 但是，在Go1.12之前，以 <code>NaN</code> 作为键值的元素只能在 <code>for-range</code> 循环中被找到； 从Go1.12开始，以 <code>NaN</code> 作为键值的元素也可以通过类似 <code>fmt. Print</code> 的函数打印出来。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;math&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">NaN</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// NaN</span>

	<span class="token keyword">var</span> m <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">float64</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	m<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">123</span>
	v<span class="token punctuation">,</span> present <span class="token operator">:=</span> m<span class="token punctuation">[</span>a<span class="token punctuation">]</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> present<span class="token punctuation">)</span> <span class="token comment">// 0 false</span>
	m<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">789</span>
	v<span class="token punctuation">,</span> present <span class="token operator">=</span> m<span class="token punctuation">[</span>a<span class="token punctuation">]</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> present<span class="token punctuation">)</span> <span class="token comment">// 0 false</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token comment">// map[NaN:789 NaN:123]</span>
	<span class="token function">delete</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> a<span class="token punctuation">)</span>   <span class="token comment">// no-op</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token comment">// map[NaN:789 NaN:123]</span>

	<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> m <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// the above loop outputs:</span>
	<span class="token comment">// NaN 123</span>
	<span class="token comment">// NaN 789</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意：在Go1.12之前，两个 <code>fmt. Println(m)</code> 调用均打印出 <code>map[NaN:&lt;nil&gt; NaN:&lt;nil&gt;]</code> 。</p> <h2 id="字符串转换为byte切片或rune切片后的结果切片的容量可能会大于长度。"><a href="#字符串转换为byte切片或rune切片后的结果切片的容量可能会大于长度。" class="header-anchor">#</a> 字符串转换为byte切片或rune切片后的结果切片的容量可能会大于长度。</h2> <p>我们不应该假设结果切片的长度和容量总是相等的。</p> <p>在下面的例子中，如果最后一个 <code>fmt. Println</code> 行被删除，在其前面的两行会打印相同的值 <code>32</code> ，否则，一个打印 <code>32</code> ，一个打印 <code>8</code> （对于标准编译器1.16版本来说）。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	s <span class="token operator">:=</span> <span class="token string">&quot;a&quot;</span>
	x <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>              <span class="token comment">// len(s) == 1</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">cap</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 32</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">cap</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token comment">// 8</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果我们假设结果切片的长度和容量总是相等，<a href="https://github.com/go101/go101/wiki/The-capacity-of-the-result-byte-(or-rune)-slice-of-a-conversion-from-a-string-is-undefined" target="_blank" rel="noopener noreferrer">就可能写出一些有bug的代码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="对于切片-s-循环-for-i-range-s-并不等价于循环-for-i-0-i-len-s-i-。"><a href="#对于切片-s-循环-for-i-range-s-并不等价于循环-for-i-0-i-len-s-i-。" class="header-anchor">#</a> 对于切片 <code>s</code> ，循环 <code>for i = range s {...}</code> 并不等价于循环 <code>for i = 0; i &lt; len(s); i++ {...}</code> 。</h2> <p>对于这两个循环，迭代变量 <code>i</code> 的最终值可能是不同的。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">var</span> i <span class="token builtin">int</span>

<span class="token keyword">func</span> <span class="token function">fa</span><span class="token punctuation">(</span>s <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	i <span class="token operator">=</span> n
	<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">return</span> i
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">fb</span><span class="token punctuation">(</span>s <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	i <span class="token operator">=</span> n
	<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token keyword">range</span> s <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">return</span> i
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	s <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">fa</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fb</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 6 5</span>
	s <span class="token operator">=</span> <span class="token boolean">nil</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">fa</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fb</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 0 -1</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="一个映射中的条目的遍历次序在两次遍历中可能并不相同。我们可以认为映射中的条目的遍历次序是随机的。"><a href="#一个映射中的条目的遍历次序在两次遍历中可能并不相同。我们可以认为映射中的条目的遍历次序是随机的。" class="header-anchor">#</a> 一个映射中的条目的遍历次序在两次遍历中可能并不相同。我们可以认为映射中的条目的遍历次序是随机的。</h2> <p>比如下面这个例子不会无穷尽地循环下去（注意每次退出前的循环次数可能不同）：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">f</span><span class="token punctuation">(</span>m <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">byte</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	bs <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span><span class="token function">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> m <span class="token punctuation">{</span>
		bs <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>bs<span class="token punctuation">,</span> k<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token function">string</span><span class="token punctuation">(</span>bs<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	m <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">byte</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span><span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">:</span><span class="token string">'C'</span><span class="token punctuation">}</span>
	s0 <span class="token operator">:=</span> <span class="token function">f</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span> s <span class="token operator">:=</span> <span class="token function">f</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span> s <span class="token operator">!=</span> s0 <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s0<span class="token punctuation">)</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
			<span class="token keyword">return</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意：对映射进行JSON格式化输出中的映射条目是按照它们的键值排序的。 另外，从Go 1.12开始，使用 <code>fmt</code> 标准库包中的打印函数打印映射时，输出的映射条目也是按照它们的键值排序的； 而在Go 1.12之前，这些打印输出时乱序的。</p> <h2 id="在对一个映射进行条目遍历期间-在此映射中创建的新条目可能会在当前遍历中被遍历出来-也可能不会。"><a href="#在对一个映射进行条目遍历期间-在此映射中创建的新条目可能会在当前遍历中被遍历出来-也可能不会。" class="header-anchor">#</a> 在对一个映射进行条目遍历期间，在此映射中创建的新条目可能会在当前遍历中被遍历出来，也可能不会。</h2> <p>有例为证：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	m <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">}</span>
	r<span class="token punctuation">,</span> n<span class="token punctuation">,</span> i<span class="token operator">:=</span> <span class="token function">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span>
	<span class="token keyword">for</span> <span class="token keyword">range</span> m <span class="token punctuation">{</span>
		m<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> n<span class="token operator">*</span><span class="token number">100</span>
		n<span class="token operator">++</span>
		i<span class="token operator">++</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;新增了%d个条目，其中%d个被遍历出来，%d个没有。\n&quot;</span><span class="token punctuation">,</span>
		i<span class="token punctuation">,</span> i <span class="token operator">-</span> r<span class="token punctuation">,</span> n <span class="token operator">-</span> i<span class="token punctuation">,</span>
	<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>感谢Valentin Deleplace提出了上面<a href="https://twitter.com/val_deleplace/status/1358784287399698434" target="_blank" rel="noopener noreferrer">两条细节建议<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="一个多返回值函数调用表达式不能和其它表达式混用在一个赋值语句的右侧或者另一个函数调用的实参列表中。"><a href="#一个多返回值函数调用表达式不能和其它表达式混用在一个赋值语句的右侧或者另一个函数调用的实参列表中。" class="header-anchor">#</a> 一个多返回值函数调用表达式不能和其它表达式混用在一个赋值语句的右侧或者另一个函数调用的实参列表中。</h2> <p>关于细节，请阅读<a href="https://gfw.go101.org/article/function.html#call-as-expression" target="_blank" rel="noopener noreferrer">有返回值的函数的调用是一种表达式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这一章节。</p> <h2 id="某些函数调用是在在编译时刻被估值的。"><a href="#某些函数调用是在在编译时刻被估值的。" class="header-anchor">#</a> 某些函数调用是在在编译时刻被估值的。</h2> <p>关于细节，请阅读<a href="https://gfw.go101.org/article/summaries.html#compile-time-evaluation" target="_blank" rel="noopener noreferrer">哪些函数调用将在编译时刻被估值？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这一总结。</p> <h2 id="每一个方法都对应着一个隐式声明的函数。"><a href="#每一个方法都对应着一个隐式声明的函数。" class="header-anchor">#</a> 每一个方法都对应着一个隐式声明的函数。</h2> <p>关于细节，请阅读<a href="https://gfw.go101.org/article/method.html#method-as-function" target="_blank" rel="noopener noreferrer">每个方法对应着一个隐式声明的函数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这一章节。</p> <h2 id="如果两个接口值具有相同的动态类型并且此动态类型不支持比较-则比较这两个接口值将导致一个恐慌。"><a href="#如果两个接口值具有相同的动态类型并且此动态类型不支持比较-则比较这两个接口值将导致一个恐慌。" class="header-anchor">#</a> 如果两个接口值具有相同的动态类型并且此动态类型不支持比较，则比较这两个接口值将导致一个恐慌。</h2> <p>例如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> x <span class="token operator">==</span> x <span class="token comment">// panic</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="类型断言可以用于将一个接口值转换为另一个接口类型-即使此接口值的类型并未实现另一个接口类型。"><a href="#类型断言可以用于将一个接口值转换为另一个接口类型-即使此接口值的类型并未实现另一个接口类型。" class="header-anchor">#</a> 类型断言可以用于将一个接口值转换为另一个接口类型，即使此接口值的类型并未实现另一个接口类型。</h2> <p>例如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">type</span> Foo <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> T <span class="token builtin">int</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">T</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>
	<span class="token comment">// 下面这两行将编译失败。</span>
	<span class="token comment">/*
	var _ Foo = x   // error: interface{}类型没有实现Foo类型
	var _ = Foo(x)  // error: interface{}类型没有实现Foo类型
	*/</span>
	<span class="token comment">// 但是下面这行可以编译通过。</span>
	<span class="token keyword">var</span> <span class="token boolean">_</span> <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span> <span class="token comment">// okay</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="一个失败的类型断言的可选的第二个结果是否被舍弃将影响此类型断言的行为。"><a href="#一个失败的类型断言的可选的第二个结果是否被舍弃将影响此类型断言的行为。" class="header-anchor">#</a> 一个失败的类型断言的可选的第二个结果是否被舍弃将影响此类型断言的行为。</h2> <p>如果第二个可选结果出现在失败的类型断言中，那么此类型断言不会导致恐慌。否则，恐慌将产生。 例如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token boolean">true</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token comment">// 断言失败，但不会导致恐慌。</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>    <span class="token comment">// 断言失败，并导致一个恐慌。</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="关于在编译时刻即可确定总是失败的目标类型为接口类型的断言。"><a href="#关于在编译时刻即可确定总是失败的目标类型为接口类型的断言。" class="header-anchor">#</a> 关于在编译时刻即可确定总是失败的目标类型为接口类型的断言。</h2> <p>在编译时刻，编译可以发现某些目标类型为接口类型的断言是不可能成功的。比如下面这个程序中的断言：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">type</span> Ia <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Ib <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> T <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>T<span class="token punctuation">)</span> <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> x Ia <span class="token operator">=</span> T<span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> x<span class="token punctuation">.</span><span class="token punctuation">(</span>Ib<span class="token punctuation">)</span> <span class="token comment">// panic: main.T is not main.Ib</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样的断言并不会导致编译失败（但编译后的程序将在运行时刻产生恐慌）。 从官方Go工具链1.15开始， <code>go vet</code> 会对对这样的断言做出警告。</p> <h2 id="以相同实参调用两次-errors-new-函数返回的两个-error-值是不相等的。"><a href="#以相同实参调用两次-errors-new-函数返回的两个-error-值是不相等的。" class="header-anchor">#</a> 以相同实参调用两次 <code>errors. New</code> 函数返回的两个 <code>error</code> 值是不相等的。</h2> <p>原因是 <code>errors. New</code> 函数会复制输入的字符串实参至一个局部变量并取此局部变量的指针作为返回 <code>error</code> 值的动态值。 两次调用会产生两个不同的指针。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;errors&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	notfound <span class="token operator">:=</span> <span class="token string">&quot;not found&quot;</span>
	a<span class="token punctuation">,</span> b <span class="token operator">:=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>notfound<span class="token punctuation">)</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>notfound<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="单向接收通道无法被关闭。"><a href="#单向接收通道无法被关闭。" class="header-anchor">#</a> 单向接收通道无法被关闭。</h2> <p>例如，下面的代码会在编译时候失败。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">foo</span><span class="token punctuation">(</span>c <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">close</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token comment">// error: 不能关闭单向接收通道</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="发送一个值到一个已关闭的通道被视为一个非阻塞操作-该操作会导致恐慌。"><a href="#发送一个值到一个已关闭的通道被视为一个非阻塞操作-该操作会导致恐慌。" class="header-anchor">#</a> 发送一个值到一个已关闭的通道被视为一个非阻塞操作，该操作会导致恐慌。</h2> <p>例如，在下面的程序里，如果第二个 <code>case</code> 分支会被选中，则在运行时刻将产生一个恐慌。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>
	<span class="token function">close</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
	<span class="token keyword">select</span> <span class="token punctuation">{</span>
	<span class="token keyword">case</span> <span class="token operator">&lt;-</span>c<span class="token punctuation">:</span>
	<span class="token keyword">case</span> c <span class="token operator">&lt;-</span> <span class="token boolean">true</span><span class="token punctuation">:</span> <span class="token comment">// panic: 向已关闭的通道发送数据</span>
	<span class="token keyword">default</span><span class="token punctuation">:</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="类型可以在声明函数体内。"><a href="#类型可以在声明函数体内。" class="header-anchor">#</a> 类型可以在声明函数体内。</h2> <p>类型可以声明在函数体内。例如，</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> T <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">type</span> S <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="对于标准编译器-结构体中的某些零尺寸字段的尺寸有可能会被视为一个字节。"><a href="#对于标准编译器-结构体中的某些零尺寸字段的尺寸有可能会被视为一个字节。" class="header-anchor">#</a> 对于标准编译器，结构体中的某些零尺寸字段的尺寸有可能会被视为一个字节。</h2> <p>关于细节，请阅读<a href="https://gfw.go101.org/article/unofficial-faq.html#final-zero-size-field" target="_blank" rel="noopener noreferrer">这个FAQ条目<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="nan-nan-inf-inf。"><a href="#nan-nan-inf-inf。" class="header-anchor">#</a> NaN != NaN，Inf == Inf。</h2> <p>此规则遵循IEEE-754标准，并与大多数其它语言是一致的。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;math&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token operator">=</span> math<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>      <span class="token comment">// NaN</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a <span class="token operator">==</span> a<span class="token punctuation">)</span> <span class="token comment">// false</span>

	<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">0.0</span>
	<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">1.0</span> <span class="token operator">/</span> x
	<span class="token keyword">var</span> z <span class="token operator">=</span> <span class="token number">2.0</span> <span class="token operator">*</span> y
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> y <span class="token operator">==</span> z<span class="token punctuation">)</span> <span class="token comment">// +Inf +Inf true</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="不同代码包中的两个非导出方法名和结构体字段名总是被视为不同的名称。"><a href="#不同代码包中的两个非导出方法名和结构体字段名总是被视为不同的名称。" class="header-anchor">#</a> 不同代码包中的两个非导出方法名和结构体字段名总是被视为不同的名称。</h2> <p>例如，在包 <code>foo</code> 中声明了如下的类型：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> foo

<span class="token keyword">type</span> I <span class="token operator">=</span> <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">about</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> S <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	a <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s S<span class="token punctuation">)</span> <span class="token function">about</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> s<span class="token punctuation">.</span>a
<span class="token punctuation">}</span>
</code></pre></div><p>在包 <code>bar</code> 中声明了如下的类型：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> bar

<span class="token keyword">type</span> I <span class="token operator">=</span> <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">about</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> S <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	a <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s S<span class="token punctuation">)</span> <span class="token function">about</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> s<span class="token punctuation">.</span>a
<span class="token punctuation">}</span>
</code></pre></div><p>那么，</p> <ul><li>两个包中的两个类型<code>S</code>的值不能相互转换。</li> <li>两个包中的两个接口类型指定了两个不同的方法集。</li> <li>类型<code>foo. S</code>没有实现接口类型 <code>bar. I</code>。</li> <li>类型<code>bar. S</code>没有实现接口类型<code>foo. I</code>。</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;包2/foo&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;包2/bar&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> x foo<span class="token punctuation">.</span>S
	<span class="token keyword">var</span> y bar<span class="token punctuation">.</span>S
	<span class="token keyword">var</span> <span class="token boolean">_</span> foo<span class="token punctuation">.</span>I <span class="token operator">=</span> x
	<span class="token keyword">var</span> <span class="token boolean">_</span> bar<span class="token punctuation">.</span>I <span class="token operator">=</span> y

	<span class="token comment">// 下面这些行将编译失败。</span>
	x <span class="token operator">=</span> foo<span class="token punctuation">.</span><span class="token function">S</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
	y <span class="token operator">=</span> bar<span class="token punctuation">.</span><span class="token function">S</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
	<span class="token keyword">var</span> <span class="token boolean">_</span> foo<span class="token punctuation">.</span>I <span class="token operator">=</span> y
	<span class="token keyword">var</span> <span class="token boolean">_</span> bar<span class="token punctuation">.</span>I <span class="token operator">=</span> x
<span class="token punctuation">}</span>
</code></pre></div><h2 id="在结构体值的比较中-名为空标识符的字段将被忽略。"><a href="#在结构体值的比较中-名为空标识符的字段将被忽略。" class="header-anchor">#</a> 在结构体值的比较中，名为空标识符的字段将被忽略。</h2> <p>比如，下面这个程序将打印出 <code>true</code> 。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> T <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token boolean">_</span> <span class="token builtin">int</span>
	<span class="token boolean">_</span> <span class="token builtin">bool</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> t1 <span class="token operator">=</span> T<span class="token punctuation">{</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">}</span>
	<span class="token keyword">var</span> t2 <span class="token operator">=</span> T<span class="token punctuation">{</span><span class="token number">789</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>t1 <span class="token operator">==</span> t2<span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="在某些很少见的场景中-圆括号是必需的。"><a href="#在某些很少见的场景中-圆括号是必需的。" class="header-anchor">#</a> 在某些很少见的场景中，圆括号是必需的。</h2> <p>例如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">type</span> T <span class="token keyword">struct</span><span class="token punctuation">{</span>x<span class="token punctuation">,</span> y <span class="token builtin">int</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 因为{}的烦扰，下面这三行均编译失败。</span>
	<span class="token comment">/*
	if T{} == T{123, 789} {}
	if T{} == (T{123, 789}) {}
	if (T{}) == T{123, 789} {}
	var _ = func()(nil) // nil被认为是一个类型
	*/</span>

	<span class="token comment">// 必须加上一对小括号()才能编译通过。</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">==</span> T<span class="token punctuation">{</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">789</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>T<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span>T<span class="token punctuation">{</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">789</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token keyword">var</span> <span class="token boolean">_</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token boolean">nil</span><span class="token punctuation">)</span> <span class="token comment">// nil被认为是一个值</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="栈溢出不可被挽救-它将使程序崩溃。"><a href="#栈溢出不可被挽救-它将使程序崩溃。" class="header-anchor">#</a> 栈溢出不可被挽救，它将使程序崩溃。</h2> <p>在目前的主流Go编译器实现中，栈溢出是致命错误。一旦栈溢出发生，程序将不可恢复地崩溃。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 无法防止程序崩溃</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>运行结果：</p> <div class="language- extra-class"><pre class="language-text"><code>
runtime: goroutine stack exceeds 1000000000-byte limit
fatal error: stack overflow

runtime stack:
...
</code></pre></div><p>关于更多不可恢复的致命错误，请参考<a href="https://github.com/go101/go101/wiki/Panic-and-crash-cases" target="_blank" rel="noopener noreferrer">此篇维基文章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="某些表达式的估值顺序取决于具体编译器实现。"><a href="#某些表达式的估值顺序取决于具体编译器实现。" class="header-anchor">#</a> 某些表达式的估值顺序取决于具体编译器实现。</h2> <p>关于细节，请阅读<a href="https://gfw.go101.org/article/evaluation-orders.html" target="_blank" rel="noopener noreferrer">表达式估值顺序规则<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>一文。</p> <h2 id="reflect-deepequal-x-y-和-x-y-的结果可能会不同。"><a href="#reflect-deepequal-x-y-和-x-y-的结果可能会不同。" class="header-anchor">#</a> <code>reflect. DeepEqual(x, y)</code> 和 <code>x == y</code> 的结果可能会不同。</h2> <p>如果表达式 <code>x</code> 和 <code>y</code> 的类型不相同，则函数调用 <code>DeepEqual(x, y)</code> 的结果总为 <code>false</code> ，但 <code>x == y</code> 的估值结果有可能为 <code>true</code> 。</p> <p>如果 <code>x</code> 和 <code>y</code> 为（同类型的）两个引用着不同其它值的指针值，则 <code>x == y</code> 的估值结果总为 <code>false</code> ，但函数调用 <code>DeepEqual(x, y)</code> 的结果可能为 <code>true</code> ，因为函数 <code>reflect. DeepEqual</code> 将比较 <code>x</code> 和 <code>y</code> 所引用的两个值。</p> <p>第三个区别是当 <code>x</code> 和 <code>y</code> 处于一个循环引用链中时， <code>DeepEqual</code> 调用的结果可能未必正确。</p> <p>第四个区别是一个 <code>DeepEqual(x, y)</code> 调用无论如何不应该产生一个恐慌，但是如果 <code>x</code> 和 <code>y</code> 是两个动态类型相同的接口值并且它们的动态类型是不可比较类型的时候， <code>x == y</code> 将产生一个恐慌。</p> <p>一个展示了这些不同的例子：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;reflect&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> Book <span class="token keyword">struct</span> <span class="token punctuation">{</span>page <span class="token builtin">int</span><span class="token punctuation">}</span>
	x <span class="token operator">:=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span>page <span class="token builtin">int</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">123</span><span class="token punctuation">}</span>
	y <span class="token operator">:=</span> Book<span class="token punctuation">{</span><span class="token number">123</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>x <span class="token operator">==</span> y<span class="token punctuation">)</span>                  <span class="token comment">// true</span>

	z <span class="token operator">:=</span> Book<span class="token punctuation">{</span><span class="token number">123</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>z<span class="token punctuation">,</span> <span class="token operator">&amp;</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>z <span class="token operator">==</span> <span class="token operator">&amp;</span>y<span class="token punctuation">)</span>                  <span class="token comment">// false</span>

	<span class="token keyword">type</span> T <span class="token keyword">struct</span><span class="token punctuation">{</span>p <span class="token operator">*</span>T<span class="token punctuation">}</span>
	t <span class="token operator">:=</span> <span class="token operator">&amp;</span>T<span class="token punctuation">{</span><span class="token operator">&amp;</span>T<span class="token punctuation">{</span><span class="token boolean">nil</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
	t<span class="token punctuation">.</span>p<span class="token punctuation">.</span>p <span class="token operator">=</span> t <span class="token comment">// form a cyclic reference chain.</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> t<span class="token punctuation">.</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>t <span class="token operator">==</span> t<span class="token punctuation">.</span>p<span class="token punctuation">)</span>                  <span class="token comment">// false</span>

	<span class="token keyword">var</span> f1<span class="token punctuation">,</span> f2 <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> f1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>f2<span class="token punctuation">,</span> f2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>

	<span class="token keyword">var</span> a<span class="token punctuation">,</span> b <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span>                  <span class="token comment">// panic</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意：如果传递给一个 <code>DeepEqual</code> 调用的两个实参均为函数类型值，则此调用只有在这两个实参都为nil并且它们的类型相同的情况下才返回 <code>true</code> 。 比较元素中含有函数值的容器值或者比较字段中含有函数值的结构体值也是类似的。 另外要注意：如果两个同类型切片共享相同的元素序列（即它们的长度相同并且它们的各对相应元素的地址也相同），则使用 <code>DeepEqual</code> 比较它们时返回的结果总是为 <code>true</code> ，即使它们的元素中含有函数值。 一个例子：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;reflect&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
	b <span class="token operator">:=</span> a
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span>       <span class="token comment">// false</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
	a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>reflect<span class="token punctuation">.</span><span class="token function">DeepEqual</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="reflect-value-bytes-方法返回一个-byte-值-它的元素类型-byte-可能并非属主参数代表的go切片值的元素类型。"><a href="#reflect-value-bytes-方法返回一个-byte-值-它的元素类型-byte-可能并非属主参数代表的go切片值的元素类型。" class="header-anchor">#</a> <code>reflect. Value. Bytes()</code> 方法返回一个 <code>[]byte</code> 值，它的元素类型 <code>byte</code> 可能并非属主参数代表的Go切片值的元素类型。</h2> <p>假设一个自定义类型 <code>MyByte</code> 的底层类型为内置类型 <code>byte</code> ，我们知道Go类型系统禁止切片类型 <code>[]MyByte</code> 的值转换为类型 <code>[]byte</code> 。 但是，当前的 <code>reflect. Value</code> 类型的 <code>Bytes</code> 方法的实现可以帮我们绕过这个限制。 此实现应该是违反了Go类型系统的规则。</p> <p>例子：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;bytes&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;reflect&quot;</span>

<span class="token keyword">type</span> MyByte <span class="token builtin">byte</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> mybs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>MyByte<span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">}</span>
	<span class="token keyword">var</span> bs <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>

	<span class="token comment">// bs = []byte(mybs) // this line fails to compile</span>

	v <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span>mybs<span class="token punctuation">)</span>
	bs <span class="token operator">=</span> v<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// okay. Violating Go type system.</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>bytes<span class="token punctuation">.</span><span class="token function">HasPrefix</span><span class="token punctuation">(</span>bs<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>

	bs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'t'</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s \n&quot;</span><span class="token punctuation">,</span> mybs<span class="token punctuation">)</span> <span class="token comment">// art</span>
<span class="token punctuation">}</span>
</code></pre></div><p>虽然这违反了Go类型系统的规则，但是貌似此违反并没有什么害处，相反，它带来了一些好处。 比如，我们可以将 <code>bytes</code> 标准库包中提供的函数（间接）应用到 <code>[]MyByte</code> 值上，如上例所示。</p> <p>注意： <code>reflect. Value. Bytes()</code> 方法<a href="https://github.com/golang/go/issues/27727" target="_blank" rel="noopener noreferrer">以后可能会被移除<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <h2 id="我们应该使用-os-isnotexist-err-而不是-err-os-errnotexist-来检查文件是否存在。"><a href="#我们应该使用-os-isnotexist-err-而不是-err-os-errnotexist-来检查文件是否存在。" class="header-anchor">#</a> 我们应该使用 <code>os. IsNotExist(err)</code> 而不是 <code>err == os. ErrNotExist</code> 来检查文件是否存在。</h2> <p>使用 <code>err == os. ErrNotExist</code> 可能漏掉一些错误。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;os&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Stat</span><span class="token punctuation">(</span><span class="token string">&quot;a-nonexistent-file.abcxyz&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">IsNotExist</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">// true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err <span class="token operator">==</span> os<span class="token punctuation">.</span>ErrNotExist<span class="token punctuation">)</span> <span class="token comment">// false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果你的项目只支持Go 1.13+，则<a href="https://github.com/golang/go/issues/38198" target="_blank" rel="noopener noreferrer">更推荐<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>使用 <code>errors. Is(err, os. ErrNotExist)</code> 来检查文件是否存在。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;errors&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;os&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Stat</span><span class="token punctuation">(</span><span class="token string">&quot;a-nonexistent-file.abcxyz&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>errors<span class="token punctuation">.</span><span class="token function">Is</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> os<span class="token punctuation">.</span>ErrNotExist<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="flag-标准库包对待布尔命令选项不同于数值和字符串选项。"><a href="#flag-标准库包对待布尔命令选项不同于数值和字符串选项。" class="header-anchor">#</a> <code>flag</code> 标准库包对待布尔命令选项不同于数值和字符串选项。</h2> <p>传递程序选项有三种形式。</p> <ol><li><code>-flag</code>：仅适用于布尔选项。</li> <li><code>-flag=x</code>：用于任何类型的选项。.</li> <li><code>-flag x</code>：仅用于非布尔选项。</li></ol> <p>请注意，使用第一种形式的布尔选项将被视为最后一个选项，其后面的所有项都被视为参数。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;flag&quot;</span>

<span class="token keyword">var</span> b <span class="token operator">=</span> flag<span class="token punctuation">.</span><span class="token function">Bool</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">&quot;一个布尔选项&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> i <span class="token operator">=</span> flag<span class="token punctuation">.</span><span class="token function">Int</span><span class="token punctuation">(</span><span class="token string">&quot;i&quot;</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token string">&quot;一个整数选项&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> s <span class="token operator">=</span> flag<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">&quot;s&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;一个字符串选项&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	flag<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;b=&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>b<span class="token punctuation">,</span> <span class="token string">&quot;, i=&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>i<span class="token punctuation">,</span> <span class="token string">&quot;, s=&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;arguments:&quot;</span><span class="token punctuation">,</span> flag<span class="token punctuation">.</span><span class="token function">Args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果我们用下面显示的标志和参数运行此程序</p> <div class="language- extra-class"><pre class="language-text"><code>
./exampleProgram -b false -i 789 -s bye arg0 arg1
</code></pre></div><p>输出结果会是：</p> <div class="language- extra-class"><pre class="language-text"><code>
b=true, i=123, s=hi
arguments: [false -i 789 -s bye arg0 arg1]
</code></pre></div><p>这个输出显然不是我们所期望的。</p> <p>我们应该像这样传递选项和参数：</p> <div class="language- extra-class"><pre class="language-text"><code>
./exampleProgram -b=false -i 789 -s bye arg0 arg1
</code></pre></div><p>或者</p> <div class="language- extra-class"><pre class="language-text"><code>
./exampleProgram -i 789 -s bye -b arg0 arg1
</code></pre></div><p>以获取我们期望的输出：</p> <div class="language- extra-class"><pre class="language-text"><code>
b=true, i=789, s=bye
arguments: [arg0 arg1]
</code></pre></div><h2 id="sp-fp-p-rintf-函数支持位置参数。"><a href="#sp-fp-p-rintf-函数支持位置参数。" class="header-anchor">#</a> <code>[Sp|Fp|P]rintf</code> 函数支持位置参数。</h2> <p>下面的程序会打印 <code>coco</code> 。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// The next line prints: coco</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%[2]v%[1]v%[2]v%[1]v&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;o&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">5/21/2021, 1:25:38 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/开发基础/GO/其他文章/Go技巧.html" class="prev">
        Go技巧
      </a></span> <span class="next"><a href="/blog/开发基础/GO/其他文章/Go问答.html">
        Go问答
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.5a38db11.js" defer></script><script src="/blog/assets/js/3.21e2e031.js" defer></script><script src="/blog/assets/js/106.028ce766.js" defer></script>
  </body>
</html>
