<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>指针 | 一名GO+PHP工程师</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/blog/assets/css/0.styles.b3aba94c.css" as="style"><link rel="preload" href="/blog/assets/js/app.92f490ec.js" as="script"><link rel="preload" href="/blog/assets/js/3.21e2e031.js" as="script"><link rel="preload" href="/blog/assets/js/72.1b632d10.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.414eb148.js"><link rel="prefetch" href="/blog/assets/js/100.318655e6.js"><link rel="prefetch" href="/blog/assets/js/101.f359d9dc.js"><link rel="prefetch" href="/blog/assets/js/102.968ea43c.js"><link rel="prefetch" href="/blog/assets/js/103.c5c5130e.js"><link rel="prefetch" href="/blog/assets/js/104.30b376fe.js"><link rel="prefetch" href="/blog/assets/js/105.d99dabdd.js"><link rel="prefetch" href="/blog/assets/js/106.acdd49d2.js"><link rel="prefetch" href="/blog/assets/js/107.df9ba599.js"><link rel="prefetch" href="/blog/assets/js/108.a5880443.js"><link rel="prefetch" href="/blog/assets/js/109.bab44539.js"><link rel="prefetch" href="/blog/assets/js/11.5abb714c.js"><link rel="prefetch" href="/blog/assets/js/110.975b5aeb.js"><link rel="prefetch" href="/blog/assets/js/111.4db6087d.js"><link rel="prefetch" href="/blog/assets/js/112.bb76db96.js"><link rel="prefetch" href="/blog/assets/js/113.9b314292.js"><link rel="prefetch" href="/blog/assets/js/114.f28a4d47.js"><link rel="prefetch" href="/blog/assets/js/115.6a21a21a.js"><link rel="prefetch" href="/blog/assets/js/116.1fd8cdf3.js"><link rel="prefetch" href="/blog/assets/js/117.193b54e8.js"><link rel="prefetch" href="/blog/assets/js/118.8a3e18a9.js"><link rel="prefetch" href="/blog/assets/js/119.857d484f.js"><link rel="prefetch" href="/blog/assets/js/12.2c548c05.js"><link rel="prefetch" href="/blog/assets/js/120.3db2d63a.js"><link rel="prefetch" href="/blog/assets/js/121.a6adc6ef.js"><link rel="prefetch" href="/blog/assets/js/122.1b17fd59.js"><link rel="prefetch" href="/blog/assets/js/123.ee446c75.js"><link rel="prefetch" href="/blog/assets/js/124.c284df07.js"><link rel="prefetch" href="/blog/assets/js/125.5cbebbd8.js"><link rel="prefetch" href="/blog/assets/js/126.4adc2281.js"><link rel="prefetch" href="/blog/assets/js/127.975465e3.js"><link rel="prefetch" href="/blog/assets/js/128.f0625ed5.js"><link rel="prefetch" href="/blog/assets/js/129.c960281b.js"><link rel="prefetch" href="/blog/assets/js/13.7235498f.js"><link rel="prefetch" href="/blog/assets/js/130.3fa988b7.js"><link rel="prefetch" href="/blog/assets/js/131.ff0058e6.js"><link rel="prefetch" href="/blog/assets/js/132.9fd5bbe5.js"><link rel="prefetch" href="/blog/assets/js/133.37b40d8b.js"><link rel="prefetch" href="/blog/assets/js/134.3ea0a5d6.js"><link rel="prefetch" href="/blog/assets/js/135.243ca016.js"><link rel="prefetch" href="/blog/assets/js/136.12ac5b39.js"><link rel="prefetch" href="/blog/assets/js/137.50106a44.js"><link rel="prefetch" href="/blog/assets/js/138.2f799002.js"><link rel="prefetch" href="/blog/assets/js/139.cb5c4cb6.js"><link rel="prefetch" href="/blog/assets/js/14.8668d3e6.js"><link rel="prefetch" href="/blog/assets/js/140.b68497e2.js"><link rel="prefetch" href="/blog/assets/js/141.cd76190b.js"><link rel="prefetch" href="/blog/assets/js/142.e385a422.js"><link rel="prefetch" href="/blog/assets/js/143.fd923e68.js"><link rel="prefetch" href="/blog/assets/js/144.c91db5db.js"><link rel="prefetch" href="/blog/assets/js/145.95b58ec4.js"><link rel="prefetch" href="/blog/assets/js/146.0ff38d15.js"><link rel="prefetch" href="/blog/assets/js/147.9d236468.js"><link rel="prefetch" href="/blog/assets/js/148.b0a6ba25.js"><link rel="prefetch" href="/blog/assets/js/149.cf51c7a4.js"><link rel="prefetch" href="/blog/assets/js/15.b3be88a6.js"><link rel="prefetch" href="/blog/assets/js/150.6514db42.js"><link rel="prefetch" href="/blog/assets/js/151.544c42cb.js"><link rel="prefetch" href="/blog/assets/js/152.d3e57edd.js"><link rel="prefetch" href="/blog/assets/js/153.422a401e.js"><link rel="prefetch" href="/blog/assets/js/154.553067c9.js"><link rel="prefetch" href="/blog/assets/js/155.9b88d76c.js"><link rel="prefetch" href="/blog/assets/js/156.14a1e6f8.js"><link rel="prefetch" href="/blog/assets/js/157.c01cdccb.js"><link rel="prefetch" href="/blog/assets/js/158.71dda3a8.js"><link rel="prefetch" href="/blog/assets/js/159.33fa138a.js"><link rel="prefetch" href="/blog/assets/js/16.4c61d2b6.js"><link rel="prefetch" href="/blog/assets/js/160.41012461.js"><link rel="prefetch" href="/blog/assets/js/161.b2118a13.js"><link rel="prefetch" href="/blog/assets/js/162.39021ec7.js"><link rel="prefetch" href="/blog/assets/js/163.33c153d8.js"><link rel="prefetch" href="/blog/assets/js/164.80cca623.js"><link rel="prefetch" href="/blog/assets/js/165.d4170a5d.js"><link rel="prefetch" href="/blog/assets/js/166.8eb8df1e.js"><link rel="prefetch" href="/blog/assets/js/167.b4296d08.js"><link rel="prefetch" href="/blog/assets/js/168.e5ed439d.js"><link rel="prefetch" href="/blog/assets/js/169.4614ac4e.js"><link rel="prefetch" href="/blog/assets/js/17.7c194dc5.js"><link rel="prefetch" href="/blog/assets/js/170.4469c187.js"><link rel="prefetch" href="/blog/assets/js/171.58868926.js"><link rel="prefetch" href="/blog/assets/js/172.afe06d5f.js"><link rel="prefetch" href="/blog/assets/js/173.a4aa2efd.js"><link rel="prefetch" href="/blog/assets/js/174.ae15fd8c.js"><link rel="prefetch" href="/blog/assets/js/175.b1a13486.js"><link rel="prefetch" href="/blog/assets/js/176.548adc93.js"><link rel="prefetch" href="/blog/assets/js/177.11fee168.js"><link rel="prefetch" href="/blog/assets/js/178.7f4bf5e6.js"><link rel="prefetch" href="/blog/assets/js/18.8f993f6c.js"><link rel="prefetch" href="/blog/assets/js/19.07ebbe7d.js"><link rel="prefetch" href="/blog/assets/js/2.3b7603f9.js"><link rel="prefetch" href="/blog/assets/js/20.0f6c34c0.js"><link rel="prefetch" href="/blog/assets/js/21.e0c3e1c3.js"><link rel="prefetch" href="/blog/assets/js/22.f6717fe0.js"><link rel="prefetch" href="/blog/assets/js/23.4d536a42.js"><link rel="prefetch" href="/blog/assets/js/24.1249f968.js"><link rel="prefetch" href="/blog/assets/js/25.1d9c0595.js"><link rel="prefetch" href="/blog/assets/js/26.fc0335c7.js"><link rel="prefetch" href="/blog/assets/js/27.95428f76.js"><link rel="prefetch" href="/blog/assets/js/28.cebb0e44.js"><link rel="prefetch" href="/blog/assets/js/29.76ea8050.js"><link rel="prefetch" href="/blog/assets/js/30.e12a0501.js"><link rel="prefetch" href="/blog/assets/js/31.ad16795c.js"><link rel="prefetch" href="/blog/assets/js/32.763b7b98.js"><link rel="prefetch" href="/blog/assets/js/33.8fe12a68.js"><link rel="prefetch" href="/blog/assets/js/34.02b4c519.js"><link rel="prefetch" href="/blog/assets/js/35.86d13f87.js"><link rel="prefetch" href="/blog/assets/js/36.20e014f1.js"><link rel="prefetch" href="/blog/assets/js/37.f94ee385.js"><link rel="prefetch" href="/blog/assets/js/38.b73a2f0c.js"><link rel="prefetch" href="/blog/assets/js/39.3191561f.js"><link rel="prefetch" href="/blog/assets/js/4.b2ea88eb.js"><link rel="prefetch" href="/blog/assets/js/40.2943fb88.js"><link rel="prefetch" href="/blog/assets/js/41.6201f829.js"><link rel="prefetch" href="/blog/assets/js/42.4b6a9c5d.js"><link rel="prefetch" href="/blog/assets/js/43.34c54b98.js"><link rel="prefetch" href="/blog/assets/js/44.c0141c7c.js"><link rel="prefetch" href="/blog/assets/js/45.d4760744.js"><link rel="prefetch" href="/blog/assets/js/46.d684210c.js"><link rel="prefetch" href="/blog/assets/js/47.853f7f02.js"><link rel="prefetch" href="/blog/assets/js/48.2d0ecdc8.js"><link rel="prefetch" href="/blog/assets/js/49.d7c41614.js"><link rel="prefetch" href="/blog/assets/js/5.a583f437.js"><link rel="prefetch" href="/blog/assets/js/50.f1a6e51d.js"><link rel="prefetch" href="/blog/assets/js/51.29fb5c68.js"><link rel="prefetch" href="/blog/assets/js/52.c183fd4d.js"><link rel="prefetch" href="/blog/assets/js/53.efb504ac.js"><link rel="prefetch" href="/blog/assets/js/54.d8f93ce1.js"><link rel="prefetch" href="/blog/assets/js/55.9b091742.js"><link rel="prefetch" href="/blog/assets/js/56.e8f18e21.js"><link rel="prefetch" href="/blog/assets/js/57.45722d8c.js"><link rel="prefetch" href="/blog/assets/js/58.17cd106d.js"><link rel="prefetch" href="/blog/assets/js/59.b848a093.js"><link rel="prefetch" href="/blog/assets/js/6.d3d9c953.js"><link rel="prefetch" href="/blog/assets/js/60.600fc4af.js"><link rel="prefetch" href="/blog/assets/js/61.698c560e.js"><link rel="prefetch" href="/blog/assets/js/62.24bf6999.js"><link rel="prefetch" href="/blog/assets/js/63.2f87f55d.js"><link rel="prefetch" href="/blog/assets/js/64.68cd3b45.js"><link rel="prefetch" href="/blog/assets/js/65.4f8891d2.js"><link rel="prefetch" href="/blog/assets/js/66.bbb3b98c.js"><link rel="prefetch" href="/blog/assets/js/67.8ca8be23.js"><link rel="prefetch" href="/blog/assets/js/68.014163e7.js"><link rel="prefetch" href="/blog/assets/js/69.0748a26b.js"><link rel="prefetch" href="/blog/assets/js/7.2e5addc9.js"><link rel="prefetch" href="/blog/assets/js/70.f8417ad3.js"><link rel="prefetch" href="/blog/assets/js/71.32fb9ba8.js"><link rel="prefetch" href="/blog/assets/js/73.ca28169a.js"><link rel="prefetch" href="/blog/assets/js/74.d1755096.js"><link rel="prefetch" href="/blog/assets/js/75.c342eea5.js"><link rel="prefetch" href="/blog/assets/js/76.7a246e05.js"><link rel="prefetch" href="/blog/assets/js/77.e25b5883.js"><link rel="prefetch" href="/blog/assets/js/78.1e612a37.js"><link rel="prefetch" href="/blog/assets/js/79.f11b0022.js"><link rel="prefetch" href="/blog/assets/js/8.cc8f8655.js"><link rel="prefetch" href="/blog/assets/js/80.11223895.js"><link rel="prefetch" href="/blog/assets/js/81.04f50a1e.js"><link rel="prefetch" href="/blog/assets/js/82.db879ca5.js"><link rel="prefetch" href="/blog/assets/js/83.e89b8863.js"><link rel="prefetch" href="/blog/assets/js/84.07410b58.js"><link rel="prefetch" href="/blog/assets/js/85.d46c8682.js"><link rel="prefetch" href="/blog/assets/js/86.52e5e4c9.js"><link rel="prefetch" href="/blog/assets/js/87.e7860b15.js"><link rel="prefetch" href="/blog/assets/js/88.6ed1a43d.js"><link rel="prefetch" href="/blog/assets/js/89.8b302469.js"><link rel="prefetch" href="/blog/assets/js/9.794a82c5.js"><link rel="prefetch" href="/blog/assets/js/90.391f76ed.js"><link rel="prefetch" href="/blog/assets/js/91.b9d1bb73.js"><link rel="prefetch" href="/blog/assets/js/92.a65aa479.js"><link rel="prefetch" href="/blog/assets/js/93.f09d7ba1.js"><link rel="prefetch" href="/blog/assets/js/94.1e2891fe.js"><link rel="prefetch" href="/blog/assets/js/95.6755e920.js"><link rel="prefetch" href="/blog/assets/js/96.7e3abf55.js"><link rel="prefetch" href="/blog/assets/js/97.64d3b035.js"><link rel="prefetch" href="/blog/assets/js/98.fdb7d67a.js"><link rel="prefetch" href="/blog/assets/js/99.b882a726.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b3aba94c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">一名GO+PHP工程师</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://gitee.com/ColinWWL/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://gitee.com/ColinWWL/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/Go类型系统/1Go类型系统概述" class="sidebar-heading clickable open"><span>Go类型系统</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/Go类型系统/1Go类型系统概述.html" class="sidebar-link">Go类型系统概述</a></li><li><a href="/blog/开发基础/GO/Go类型系统/2指针.html" class="active sidebar-link">指针</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#内存地址" class="sidebar-link">内存地址</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#值的地址" class="sidebar-link">值的地址</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#什么是指针" class="sidebar-link">什么是指针？</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#指针类型和值" class="sidebar-link">指针类型和值</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#关于引用-reference-这个术语" class="sidebar-link">关于引用（reference）这个术语</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#如何获取一个指针值" class="sidebar-link">如何获取一个指针值？</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#指针-地址-解引用" class="sidebar-link">指针（地址）解引用</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#我们为什么需要指针" class="sidebar-link">我们为什么需要指针？</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#在go中返回一个局部变量的地址是安全的" class="sidebar-link">在Go中返回一个局部变量的地址是安全的</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#go指针的一些限制" class="sidebar-link">Go指针的一些限制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#go指针不支持算术运算" class="sidebar-link">Go指针不支持算术运算</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#一个指针类型的值不能被随意转换为另一个指针类型" class="sidebar-link">一个指针类型的值不能被随意转换为另一个指针类型</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#一个指针值不能和其它任一指针类型的值进行比较" class="sidebar-link">一个指针值不能和其它任一指针类型的值进行比较</a></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#一个指针值不能被赋值给其它任意类型的指针值" class="sidebar-link">一个指针值不能被赋值给其它任意类型的指针值</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/开发基础/GO/Go类型系统/2指针.html#上述go指针的限制是可以被打破的" class="sidebar-link">上述Go指针的限制是可以被打破的</a></li></ul></li><li><a href="/blog/开发基础/GO/Go类型系统/3结构体.html" class="sidebar-link">结构体</a></li><li><a href="/blog/开发基础/GO/Go类型系统/4值部.html" class="sidebar-link">值部</a></li><li><a href="/blog/开发基础/GO/Go类型系统/5数组、切片和映射.html" class="sidebar-link">数组、切片和映射</a></li><li><a href="/blog/开发基础/GO/Go类型系统/6通道.html" class="sidebar-link">通道</a></li><li><a href="/blog/开发基础/GO/Go类型系统/7方法.html" class="sidebar-link">方法</a></li><li><a href="/blog/开发基础/GO/Go类型系统/8接口.html" class="sidebar-link">接口</a></li><li><a href="/blog/开发基础/GO/Go类型系统/9类型内嵌.html" class="sidebar-link">类型内嵌</a></li><li><a href="/blog/开发基础/GO/Go类型系统/10非类型安全指针.html" class="sidebar-link">非类型安全指针</a></li><li><a href="/blog/开发基础/GO/Go类型系统/11泛型.html" class="sidebar-link">泛型</a></li><li><a href="/blog/开发基础/GO/Go类型系统/12反射.html" class="sidebar-link">反射</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/Go编程入门/1程序源代码基本元素介绍" class="sidebar-heading clickable"><span>Go编程入门</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/Go编程入门/1程序源代码基本元素介绍.html" class="sidebar-link">程序源代码基本元素介绍</a></li><li><a href="/blog/开发基础/GO/Go编程入门/2关键字和标识符.html" class="sidebar-link">关键字和标识符</a></li><li><a href="/blog/开发基础/GO/Go编程入门/3基本类型和它们的字面量表示.html" class="sidebar-link">基本类型和它们的字面量表示</a></li><li><a href="/blog/开发基础/GO/Go编程入门/4常量和变量.html" class="sidebar-link">常量和变量</a></li><li><a href="/blog/开发基础/GO/Go编程入门/5运算操作符.html" class="sidebar-link">运算操作符</a></li><li><a href="/blog/开发基础/GO/Go编程入门/6函数声明和调用.html" class="sidebar-link">函数声明和调用</a></li><li><a href="/blog/开发基础/GO/Go编程入门/7代码包和包引入.html" class="sidebar-link">代码包和包引入</a></li><li><a href="/blog/开发基础/GO/Go编程入门/8表达式、语句和简单语句.html" class="sidebar-link">表达式、语句和简单语句</a></li><li><a href="/blog/开发基础/GO/Go编程入门/9基本流程控制语法.html" class="sidebar-link">基本流程控制语法</a></li><li><a href="/blog/开发基础/GO/Go编程入门/10协程、延迟函数调用、以及恐慌和恢复.html" class="sidebar-link">协程、延迟函数调用、以及恐慌和恢复</a></li><li><a href="/blog/开发基础/GO/Go编程入门/GO官方链接工具.html" class="sidebar-link">GO官方链接工具</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/其他文章/Go技巧" class="sidebar-heading clickable"><span>其他文章</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/其他文章/Go技巧.html" class="sidebar-link">Go技巧</a></li><li><a href="/blog/开发基础/GO/其他文章/Go细节.html" class="sidebar-link">Go细节</a></li><li><a href="/blog/开发基础/GO/其他文章/Go问答.html" class="sidebar-link">Go问答</a></li><li><a href="/blog/开发基础/GO/其他文章/命令-mod.html" class="sidebar-link">命令-mod</a></li><li><a href="/blog/开发基础/GO/其他文章/基础-Golang的time.NewTimer单次定时器使用案例.html" class="sidebar-link">基础-Golang的time. NewTimer单次定时器使用案例</a></li><li><a href="/blog/开发基础/GO/其他文章/基础-Go中的nil.html" class="sidebar-link">Go中的 nil</a></li><li><a href="/blog/开发基础/GO/其他文章/基础-Go代码断行规则.html" class="sidebar-link">Go代码断行规则</a></li><li><a href="/blog/开发基础/GO/其他文章/基础-表达式估值顺序规则.html" class="sidebar-link">表达式估值顺序规则</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/学习资料" class="sidebar-heading clickable"><span>GO</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/学习资料.html" class="sidebar-link">教学书籍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/并发编程/1并发同步概述" class="sidebar-heading clickable"><span>并发编程</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/并发编程/1并发同步概述.html" class="sidebar-link">并发同步概述</a></li><li><a href="/blog/开发基础/GO/并发编程/2通道用例大全.html" class="sidebar-link">通道用例大全</a></li><li><a href="/blog/开发基础/GO/并发编程/3如何优雅地关闭通道.html" class="sidebar-link">如何优雅地关闭通道</a></li><li><a href="/blog/开发基础/GO/并发编程/4其它并发同步技术.html" class="sidebar-link">sync 标准库包中提供的并发同步技术</a></li><li><a href="/blog/开发基础/GO/并发编程/5原子操作 .html" class="sidebar-link">sync/atomic 标准库包中提供的原子操作</a></li><li><a href="/blog/开发基础/GO/并发编程/6Go中的内存顺序保证.html" class="sidebar-link">Go中的内存顺序保证</a></li><li><a href="/blog/开发基础/GO/并发编程/7一些常见并发编程错误.html" class="sidebar-link">一些常见并发编程错误</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/开发基础/GO/开发环境搭建/Docker和VS Code的Go开发环境" class="sidebar-heading clickable"><span>开发环境搭建</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/开发基础/GO/开发环境搭建/Docker和VS Code的Go开发环境.html" class="sidebar-link">Docker和VS Code的Go开发环境</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="指针"><a href="#指针" class="header-anchor">#</a> 指针</h1> <p>虽然Go吸收融合了很多其语言中的各种特性，但是Go主要被归入C语言家族。其中一个重要的原因就是Go和C一样，也支持指针。 当然Go中的指针相比C指针有很多限制。本篇文章将介绍指针相关的各种概念和Go指针相关的各种细节。</p> <h2 id="内存地址"><a href="#内存地址" class="header-anchor">#</a> 内存地址</h2> <p>一个内存地址表示操作系统管理的整个内存中的一个偏移量（相对于从整个内存的起始，以字节计数）。</p> <p>通常地，一个内存地址用一个操作系统原生字（native word）来存储。 一个原生字在32位操作系统上占4个字节，在64位操作系统上占8个字节。 所以，32位操作系统上的理论最大支持内存容量为4GB（1GB == 230字节），64位操作系统上的理论最大支持内存容量为264Byte，即16EB（EB：艾字节，1EB == 1024PB, 1PB == 1024TB, 1TB == 1024GB）。</p> <p>内存地址的字面形式常用整数的十六进制字面量来表示，比如 <code>0x1234CDEF</code> 。</p> <p>以后我们常简称内存地址为地址。</p> <h2 id="值的地址"><a href="#值的地址" class="header-anchor">#</a> 值的地址</h2> <p>一个值的地址是指此值的直接部分占据的内存的起始地址。在Go中，每个值都包含一个直接部分，但有些值可能还包含一个或多个间接部分，<a href="https://gfw.go101.org/article/type-system-overview.html#value-part" target="_blank" rel="noopener noreferrer">下下篇<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>文章将对此详述。</p> <h2 id="什么是指针"><a href="#什么是指针" class="header-anchor">#</a> 什么是指针？</h2> <p>指针是Go中的一种类型分类（kind）。一个指针是某个指针类型的一个值。一个指针可以存储一个内存地址。 事实上，我们经常称一个指针为一个内存地址，或者称一个内存地址为一个指针。</p> <p>通常地，一个指针中存储的内存地址为另外一个值的地址。和C指针不一样，为了安全起见，Go指针有很多限制，详见下面的章节。</p> <h2 id="指针类型和值"><a href="#指针类型和值" class="header-anchor">#</a> 指针类型和值</h2> <p>在Go中，一个非定义指针类型的字面形式为 <code>*T</code> ，其中 <code>T</code> 为一个任意类型。类型 <code>T</code> 称为指针类型 <code>*T</code> 的基类型（base type）。 如果一个指针类型的基类型为 <code>T</code> ，则我们可以称此指针类型为一个 <code>T</code> 指针类型。</p> <p>虽然我们可以声明定义指针类型，但是一般不推荐这么做。非定义指针类型的可读性更高。</p> <p>如果一个指针类型的<a href="https://gfw.go101.org/article/type-system-overview.html#underlying-type" target="_blank" rel="noopener noreferrer">底层类型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是 <code>*T</code> ，则它的基类型为 <code>T</code> 。</p> <p>如果两个非定义指针类型的基类型为同一类型，则这两个非定义指针类型亦为同一类型。</p> <p>一些指针类型的例子：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token operator">*</span><span class="token builtin">int</span>  <span class="token comment">// 一个基类型为int的非定义指针类型。</span>
<span class="token operator">*</span><span class="token operator">*</span><span class="token builtin">int</span> <span class="token comment">// 一个多级非定义指针类型，它的基类型为*int。</span>

<span class="token keyword">type</span> Ptr <span class="token operator">*</span><span class="token builtin">int</span> <span class="token comment">// Ptr是一个定义的指针类型，它的基类型为int。</span>
<span class="token keyword">type</span> PP <span class="token operator">*</span>Ptr  <span class="token comment">// PP是一个定义的多级指针类型，它的基类型为Ptr。</span>
</code></pre></div><p>指针类型的零值的字面量使用预声明的 <code>nil</code> 来表示。一个nil指针（常称为空指针）中不存储任何地址。</p> <p>如果一个指针类型的基类型为 <code>T</code> ，则此指针类型的值只能存储类型为 <code>T</code> 的值的地址。</p> <h2 id="关于引用-reference-这个术语"><a href="#关于引用-reference-这个术语" class="header-anchor">#</a> 关于引用（reference）这个术语</h2> <p>在《Go语言101》中，术语“引用”暗示着一个关系。比如，如果一个指针中存储着另外一个值的地址，则我们可以说此指针值引用着另外一个值；同时另外一个值当前至少有一个引用。 本书对此术语的使用和Go白皮书是一致的。</p> <p>当一个指针引用着另外一个值，我们也常说此指针指向另外一个值。</p> <h2 id="如何获取一个指针值"><a href="#如何获取一个指针值" class="header-anchor">#</a> 如何获取一个指针值？</h2> <p>有两种方式来得到一个指针值：</p> <ol><li>我们可以用内置函数<code>new</code>来为任何类型的值开辟一块内存并将此内存块的起始地址做为此值的地址返回。 假设<code>T</code>是任一类型，则函数调用<code>new(T)</code>返回一个类型为<code>*T</code>的指针值。 存储在返回指针值所表示的地址处的值（可被看作是一个匿名变量）为<code>T</code>的零值。</li> <li>我们也可以使用前置取地址操作符<code>&amp;</code>来获取一个可寻址的值的地址。 对于一个类型为<code>T</code>的可寻址的值<code>t</code>，我们可以用<code>&amp;t</code>来取得它的地址。<code>&amp;t</code>的类型为<code>*T</code>。</li></ol> <p>一般说来，一个可寻址的值是指被放置在内存中某固定位置处的一个值（但放置在某固定位置处的一个值并非一定是可寻址的）。 目前，我们只需知道所有变量都是可以寻址的；但是所有常量、函数返回值和强制转换结果都是不可寻址的。 当一个变量被声明的时候，Go运行时将为此变量开辟一段内存。此内存的起始地址即为此变量的地址。</p> <p>更多可被（或不可被）寻址的值将在以后的文章中逐渐提及。 如果你已经对Go比较熟悉，你可以阅读<a href="https://gfw.go101.org/article/summaries.html#not-addressable" target="_blank" rel="noopener noreferrer">此条总结<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来了解在Go中哪些值可以或不可以被寻址。</p> <p>下一节中的例子将展示如何获取一些值的地址。</p> <h2 id="指针-地址-解引用"><a href="#指针-地址-解引用" class="header-anchor">#</a> 指针（地址）解引用</h2> <p>我们可以使用前置解引用操作符 <code>*</code> 来访问存储在一个指针所表示的地址处的值（即此指针所引用着的值）。 比如，对于基类型为 <code>T</code> 的指针类型的一个指针值 <code>p</code> ，我们可以用 <code>*p</code> 来表示地址 <code>p</code> 处的值。 此值的类型为 <code>T</code> 。 <code>*p</code> 称为指针 <code>p</code> 的解引用。解引用是取地址的逆过程。</p> <p>解引用一个nil指针将产生一个<a href="https://gfw.go101.org/article/control-flows-more.html#panic-recover" target="_blank" rel="noopener noreferrer">恐慌<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>下面这个例子展示了如何取地址和解引用。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	p0 <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>   <span class="token comment">// p0指向一个int类型的零值</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>p0<span class="token punctuation">)</span>  <span class="token comment">// （打印出一个十六进制形式的地址）</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">*</span>p0<span class="token punctuation">)</span> <span class="token comment">// 0</span>

	x <span class="token operator">:=</span> <span class="token operator">*</span>p0              <span class="token comment">// x是p0所引用的值的一个复制。</span>
	p1<span class="token punctuation">,</span> p2 <span class="token operator">:=</span> <span class="token operator">&amp;</span>x<span class="token punctuation">,</span> <span class="token operator">&amp;</span>x      <span class="token comment">// p1和p2中都存储着x的地址。</span>
	                      <span class="token comment">// x、*p1和*p2表示着同一个int值。</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>p1 <span class="token operator">==</span> p2<span class="token punctuation">)</span> <span class="token comment">// true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>p0 <span class="token operator">==</span> p1<span class="token punctuation">)</span> <span class="token comment">// false</span>
	p3 <span class="token operator">:=</span> <span class="token operator">&amp;</span><span class="token operator">*</span>p0            <span class="token comment">// &lt;=&gt; p3 := &amp;(*p0)</span>
	                      <span class="token comment">// &lt;=&gt; p3 := p0</span>
	                      <span class="token comment">// p3和p0中存储的地址是一样的。</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>p0 <span class="token operator">==</span> p3<span class="token punctuation">)</span> <span class="token comment">// true</span>
	<span class="token operator">*</span>p0<span class="token punctuation">,</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">789</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">*</span>p2<span class="token punctuation">,</span> x<span class="token punctuation">,</span> <span class="token operator">*</span>p3<span class="token punctuation">)</span> <span class="token comment">// 789 789 123</span>

	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%T, %T \n&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>p0<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token comment">// int, int</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%T, %T \n&quot;</span><span class="token punctuation">,</span> p0<span class="token punctuation">,</span> p1<span class="token punctuation">)</span> <span class="token comment">// *int, *int</span>
<span class="token punctuation">}</span>
</code></pre></div><p>下面这张图描绘了上面这个例子中各个值之间的关系。</p> <p><img src="/blog/assets/img/pointer.1da184fc.png" alt="指针值"></p> <h2 id="我们为什么需要指针"><a href="#我们为什么需要指针" class="header-anchor">#</a> 我们为什么需要指针？</h2> <p>让我们先看一个例子：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">double</span><span class="token punctuation">(</span>x <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	x <span class="token operator">+=</span> x
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">3</span>
	<span class="token function">double</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// 3</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们本期望上例中的 <code>double</code> 函数将变量 <code>a</code> 的值放大为原来的两倍，但是事实证明我们的期望没有得到实现。 为什么呢？因为在Go中，所有的赋值（包括函数调用传参）过程都是一个值复制过程。 所以在上面的 <code>double</code> 函数体内修改的是变量 <code>a</code> 的一个副本，而没有修改变量 <code>a</code> 本身。</p> <p>当然我们可以让 <code>double</code> 函数返回输入参数的两倍数，但是此方法并非适用于所有场合。 下面这个例子通过将输入参数的类型改为一个指针类型来达到同样的目的。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">double</span><span class="token punctuation">(</span>x <span class="token operator">*</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token operator">*</span>x <span class="token operator">+=</span> <span class="token operator">*</span>x
	x <span class="token operator">=</span> <span class="token boolean">nil</span> <span class="token comment">// 此行仅为讲解目的</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">3</span>
	<span class="token function">double</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// 6</span>
	p <span class="token operator">:=</span> <span class="token operator">&amp;</span>a
	<span class="token function">double</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> p <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">)</span> <span class="token comment">// 12 false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>从上例可以看出，通过将 <code>double</code> 函数的输入参数的类型改为 <code>*int</code> ，传入的实参 <code>&amp;a</code> 和它在此函数体内的一个副本 <code>x</code> 都引用着变量 <code>a</code> 。 所以对 <code>*x</code> 的修改等价于对 <code>*p</code> （也就是变量 <code>a</code> ）的修改。 换句话说，新版本的 <code>double</code> 函数内的操作可以反映到此函数外了。</p> <p>当然，在此函数体内对传入的指针实参的修改 <code>x = nil</code> 依旧不能反映到函数外，因为此修改发生在此指针的一个副本上。 所以在 <code>double</code> 函数调用之后，局部变量 <code>p</code> 的值并没有被修改为 <code>nil</code> 。</p> <p>简而言之，指针提供了一种间接的途径来访问和修改一些值。 虽然很多语言中没有指针这个概念，但是指针被隐藏其它概念之中。</p> <h2 id="在go中返回一个局部变量的地址是安全的"><a href="#在go中返回一个局部变量的地址是安全的" class="header-anchor">#</a> 在Go中返回一个局部变量的地址是安全的</h2> <p>和C不一样，Go是支持垃圾回收的，所以一个函数返回其内声明的局部变量的地址是绝对安全的。比如：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">newInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span><span class="token builtin">int</span> <span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token number">3</span>
	<span class="token keyword">return</span> <span class="token operator">&amp;</span>a
<span class="token punctuation">}</span>
</code></pre></div><h2 id="go指针的一些限制"><a href="#go指针的一些限制" class="header-anchor">#</a> Go指针的一些限制</h2> <p>为了安全起见，Go指针在使用上相对于C指针有很多限制。 通过施加这些限制，Go指针保留了C指针的好处，同时也避免了C指针的危险性。</p> <h3 id="go指针不支持算术运算"><a href="#go指针不支持算术运算" class="header-anchor">#</a> Go指针不支持算术运算</h3> <p>在Go中，指针是不能参与算术运算的。比如，对于一个指针 <code>p</code> ， 运算 <code>p++</code> 和 <code>p-2</code> 都是非法的。</p> <p>如果 <code>p</code> 为一个指向一个数值类型值的指针， <code>*p++</code> 将被编译器认为是合法的并且等价于 <code>(*p)++</code> 。 换句话说，解引用操作符 <code>*</code> 的优先级都高于自增 <code>++</code> 和自减 <code>--</code> 操作符。</p> <p>例子：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token function">int64</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
	p <span class="token operator">:=</span> <span class="token operator">&amp;</span>a

	<span class="token comment">// 下面这两行编译不通过。</span>
	<span class="token comment">/*
	p++
	p = (&amp;a) + 8
	*/</span>

	<span class="token operator">*</span>p<span class="token operator">++</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">,</span> a<span class="token punctuation">)</span>   <span class="token comment">// 6 6</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span> <span class="token comment">// true</span>

	<span class="token operator">*</span><span class="token operator">&amp;</span>a<span class="token operator">++</span>
	<span class="token operator">*</span><span class="token operator">&amp;</span><span class="token operator">*</span><span class="token operator">&amp;</span>a<span class="token operator">++</span>
	<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">&amp;</span>p<span class="token operator">++</span>
	<span class="token operator">*</span><span class="token operator">&amp;</span><span class="token operator">*</span>p<span class="token operator">++</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token comment">// 10 10</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="一个指针类型的值不能被随意转换为另一个指针类型"><a href="#一个指针类型的值不能被随意转换为另一个指针类型" class="header-anchor">#</a> 一个指针类型的值不能被随意转换为另一个指针类型</h3> <p>在Go中，只有如下某个条件被满足的情况下，一个类型为 <code>T1</code> 的指针值才能被显式转换为另一个指针类型 <code>T2</code> ：</p> <ol><li>类型<code>T1</code>和<code>T2</code>的底层类型必须一致（忽略结构体字段的标签）。 特别地，如果类型<code>T1</code>和<code>T2</code>中只要有一个是<a href="https://gfw.go101.org/article/type-system-overview.html#non-defined-type" target="_blank" rel="noopener noreferrer">非定义类型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>并且它们的底层类型一致（考虑结构体字段的标签），则此转换可以是隐式的。 关于结构体，请参阅<a href="https://gfw.go101.org/article/struct.html" target="_blank" rel="noopener noreferrer">下一篇文章<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li>类型<code>T1</code>和<code>T2</code>都为非定义类型并且它们的基类型的底层类型一致（忽略结构体字段的标签）。</li></ol> <p>比如，</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> MyInt <span class="token builtin">int64</span>
<span class="token keyword">type</span> Ta    <span class="token operator">*</span><span class="token builtin">int64</span>
<span class="token keyword">type</span> Tb    <span class="token operator">*</span>MyInt
</code></pre></div><p>对于上面所示的这些指针类型，下面的事实成立：</p> <ol><li>类型<code>*int64</code>的值可以被隐式转换到类型<code>Ta</code>，反之亦然（因为它们的底层类型均为<code>*int64</code>）。</li> <li>类型 <code>*MyInt</code>的值可以被隐式转换到类型<code>Tb</code>，反之亦然（因为它们的底层类型均为<code>*MyInt</code>）。</li> <li>类型<code>*MyInt</code>的值可以被显式转换为类型<code>*int64</code>，反之亦然（因为它们都是非定义的并且它们的基类型的底层类型均为<code>int64</code>）。</li> <li>类型<code>Ta</code>的值不能直接被转换为类型<code>Tb</code>，即使是显式转换也是不行的。 但是，通过上述三条事实，通过三层显式转换<code>Tb((*MyInt)((*int64)(ta)))</code>，一个类型为<code>Ta</code>的值<code>ta</code>可以被间接地转换为类型<code>Tb</code>。</li></ol> <p>这些指针类型的任何值都无法被转换到类型 <code>*uint64</code> 。</p> <h3 id="一个指针值不能和其它任一指针类型的值进行比较"><a href="#一个指针值不能和其它任一指针类型的值进行比较" class="header-anchor">#</a> 一个指针值不能和其它任一指针类型的值进行比较</h3> <p>Go指针值是支持（使用比较运算符 <code>==</code> 和 <code>!=</code> ）比较的。 但是，两个指针只有在下列任一条件被满足的时候才可以比较：</p> <ol><li>这两个指针的类型相同。</li> <li>其中一个指针可以被隐式转换为另一个指针的类型。换句话说，这两个指针的类型的底层类型必须一致并且其中一个指针类型为非定义的（考虑结构体字段的标签）。</li> <li>其中一个并且只有一个指针用类型不确定的<code>nil</code>标识符表示。</li></ol> <p>例子：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">type</span> MyInt <span class="token builtin">int64</span>
	<span class="token keyword">type</span> Ta    <span class="token operator">*</span><span class="token builtin">int64</span>
	<span class="token keyword">type</span> Tb    <span class="token operator">*</span>MyInt

	<span class="token comment">// 4个不同类型的指针：</span>
	<span class="token keyword">var</span> pa0 Ta
	<span class="token keyword">var</span> pa1 <span class="token operator">*</span><span class="token builtin">int64</span>
	<span class="token keyword">var</span> pb0 Tb
	<span class="token keyword">var</span> pb1 <span class="token operator">*</span>MyInt

	<span class="token comment">// 下面这6行编译没问题。它们的比较结果都为true。</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> pa0 <span class="token operator">==</span> pa1
	<span class="token boolean">_</span> <span class="token operator">=</span> pb0 <span class="token operator">==</span> pb1
	<span class="token boolean">_</span> <span class="token operator">=</span> pa0 <span class="token operator">==</span> <span class="token boolean">nil</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> pa1 <span class="token operator">==</span> <span class="token boolean">nil</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> pb0 <span class="token operator">==</span> <span class="token boolean">nil</span>
	<span class="token boolean">_</span> <span class="token operator">=</span> pb1 <span class="token operator">==</span> <span class="token boolean">nil</span>

	<span class="token comment">// 下面这三行编译不通过。</span>
	<span class="token comment">/*
	_ = pa0 == pb0
	_ = pa1 == pb1
	_ = pa0 == Tb(nil)
	*/</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="一个指针值不能被赋值给其它任意类型的指针值"><a href="#一个指针值不能被赋值给其它任意类型的指针值" class="header-anchor">#</a> 一个指针值不能被赋值给其它任意类型的指针值</h3> <p>一个指针值可以被赋值给另一个指针值的条件和这两个指针值可以比较的条件（见上一小节）是一致的。</p> <h2 id="上述go指针的限制是可以被打破的"><a href="#上述go指针的限制是可以被打破的" class="header-anchor">#</a> 上述Go指针的限制是可以被打破的</h2> <p><a href="https://gfw.go101.org/article/unsafe.html" target="_blank" rel="noopener noreferrer"><code>unsafe</code> 标准库包<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中提供的非类型安全指针（ <code>unsafe. Pointer</code> ）机制可以被用来打破上述Go指针的安全限制。 <code>unsafe. Pointer</code> 类型类似于C语言中的 <code>void*</code> 。 但是，通常地，非类型安全指针机制不推荐在Go日常编程中使用。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">5/21/2021, 1:25:38 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/开发基础/GO/Go类型系统/1Go类型系统概述.html" class="prev">
        Go类型系统概述
      </a></span> <span class="next"><a href="/blog/开发基础/GO/Go类型系统/3结构体.html">
        结构体
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.92f490ec.js" defer></script><script src="/blog/assets/js/3.21e2e031.js" defer></script><script src="/blog/assets/js/72.1b632d10.js" defer></script>
  </body>
</html>
